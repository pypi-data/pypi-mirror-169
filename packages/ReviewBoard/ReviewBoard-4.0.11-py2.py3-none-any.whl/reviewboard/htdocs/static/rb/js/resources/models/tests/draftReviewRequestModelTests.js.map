{"version":3,"file":"draftReviewRequestModelTests.js","names":["suite","draft","callbacks","beforeEach","reviewRequest","RB","ReviewRequest","id","links","href","success","error","spyOn","and","callFake","options","context","ready","call","it","expect","url","toBe","callThrough","$","request","data","public","stat","set","targetGroups","name","summary","description","publish","not","toHaveBeenCalled","apiCall","ajax","parse","branch","bugs_closed","changedescription","changedescription_text_type","description_text_type","target_groups","target_people","testing_done","testing_done_text_type","submitter","undefined","bugsClosed","changeDescription","changeDescriptionRichText","descriptionRichText","targetPeople","testingDone","testingDoneRichText"],"sources":["draftReviewRequestModelTests.es6.js"],"sourcesContent":["suite('rb/resources/models/DraftReviewRequest', function() {\n    let draft;\n    let callbacks;\n\n    beforeEach(function() {\n        const reviewRequest = new RB.ReviewRequest({\n            id: 1,\n            links: {\n                draft: {\n                    href: '/api/review-requests/123/draft/',\n                },\n            },\n        });\n\n        draft = reviewRequest.draft;\n\n        callbacks = {\n            success: function() {},\n            error: function() {},\n        };\n\n        spyOn(callbacks, 'success');\n        spyOn(callbacks, 'error');\n\n        spyOn(reviewRequest, 'ready').and.callFake(\n            (options, context) => options.ready.call(context));\n\n        spyOn(reviewRequest, 'ensureCreated').and.callFake(\n            (options, context) => options.success.call(context));\n\n        spyOn(draft, 'ready').and.callFake(\n            (options, context) => options.ready.call(context));\n    });\n\n    it('url', function() {\n        expect(draft.url()).toBe('/api/review-requests/123/draft/');\n    });\n\n    it('publish', function() {\n        spyOn(RB, 'apiCall').and.callThrough();\n        spyOn($, 'ajax').and.callFake(request => {\n            expect(request.data.public).toBe(1);\n\n            request.success({\n                stat: 'ok',\n                draft: {\n                    id: 1,\n                    links: {},\n                },\n            });\n        });\n\n        /* Set some fields in order to pass validation. */\n        draft.set({\n            targetGroups: [{\n                name: 'mygroup',\n                url: '/groups/mygroup',\n            }],\n            summary: 'My summary',\n            description: 'My description',\n        });\n\n        draft.publish({\n            success: callbacks.success,\n            error: callbacks.error,\n        });\n\n        expect(callbacks.error).not.toHaveBeenCalled();\n        expect(callbacks.success).toHaveBeenCalled();\n        expect(RB.apiCall).toHaveBeenCalled();\n        expect($.ajax).toHaveBeenCalled();\n    });\n\n    it('parse', function() {\n        const data = draft.parse({\n            stat: 'ok',\n            draft: {\n                id: 1,\n                branch: 'branch',\n                bugs_closed: 'bugsClosed',\n                changedescription: 'changeDescription',\n                changedescription_text_type: 'markdown',\n                description: 'description',\n                'public': 'public',\n                description_text_type: 'markdown',\n                summary: 'summary',\n                target_groups: 'targetGroups',\n                target_people: 'targetPeople',\n                testing_done: 'testingDone',\n                testing_done_text_type: 'plain',\n                links: {\n                    submitter: 'submitter',\n                },\n            },\n        });\n\n        expect(data).not.toBe(undefined);\n        expect(data.id).toBe(1);\n        expect(data.branch).toBe('branch');\n        expect(data.bugsClosed).toBe('bugsClosed');\n        expect(data.changeDescription).toBe('changeDescription');\n        expect(data.changeDescriptionRichText).toBe(true);\n        expect(data.description).toBe('description');\n        expect(data.descriptionRichText).toBe(true);\n        expect(data.public).toBe('public');\n        expect(data.summary).toBe('summary');\n        expect(data.submitter).toBe('submitter');\n        expect(data.targetGroups).toBe('targetGroups');\n        expect(data.targetPeople).toBe('targetPeople');\n        expect(data.testingDone).toBe('testingDone');\n        expect(data.testingDoneRichText).toBe(false);\n    });\n});\n"],"mappings":"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"}