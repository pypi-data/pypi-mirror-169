{"version":3,"file":"dashboardPageViewTests.js","names":["suite","pageTemplate","widgetTemplate","_","template","page","pageView","beforeEach","RB","Admin","DashboardPage","DashboardPageView","el","$","appendTo","$testsScratch","model","describe","it","$main","append","domID","name","cssClasses","set","id","viewClass","modelClass","render","$widgets","_$widgets","expect","length","toBe","toHaveClass","items","_masonry","element","$el","css","widgetView","_widgetViews","not","toBeUndefined","spyOn","$widget","width","trigger","layout","toHaveBeenCalled","_widgetWidths"],"sources":["dashboardPageViewTests.es6.js"],"sourcesContent":["suite('rb/admin/views/DashboardPageView', function() {\n    const pageTemplate = dedent`\n        <div>\n         <div id=\"admin-dashboard\" style=\"visibility: hidden\">\n          <div class=\"rb-c-admin-widgets\">\n           <div class=\"rb-c-admin-widgets__sizer-gutter\"></div>\n           <div class=\"rb-c-admin-widgets__sizer-column\"></div>\n           <div class=\"rb-c-admin-widgets__main\"></div>\n          </div>\n         </div>\n        </div>\n    `;\n\n    const widgetTemplate = _.template(dedent`\n        <div class=\"rb-c-admin-widget <%- cssClasses %>\" id=\"<%- domID %>\"\n         <header class=\"rb-c-admin-widget__header\">\n          <h1><%- name %></h1>\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </header>\n         <div class=\"rb-c-admin-widget__content\"></div>\n         <footer class=\"rb-c-admin-widget__footer\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </footer>\n        </div>\n    `);\n\n    let page;\n    let pageView;\n\n    beforeEach(function() {\n        page = new RB.Admin.DashboardPage();\n        pageView = new RB.Admin.DashboardPageView({\n            el: $(pageTemplate).appendTo($testsScratch),\n            model: page,\n        });\n    });\n\n    describe('Widgets', function() {\n        it('Loading', function() {\n            const $main = pageView.$('.rb-c-admin-widgets__main');\n\n            $main.append(\n                widgetTemplate({\n                    domID: 'widget-1',\n                    name: 'Widget 1',\n                    cssClasses: '-is-small',\n                }),\n                widgetTemplate({\n                    domID: 'widget-2',\n                    name: 'Widget 2',\n                    cssClasses: '',\n                }),\n                widgetTemplate({\n                    domID: 'widget-3',\n                    name: 'Widget 3',\n                    cssClasses: '-is-large',\n                }),\n                widgetTemplate({\n                    domID: 'widget-4',\n                    name: 'Widget 4',\n                    cssClasses: '-is-small',\n                }),\n                widgetTemplate({\n                    domID: 'widget-5',\n                    name: 'Widget 5',\n                    cssClasses: '',\n                }),\n                widgetTemplate({\n                    domID: 'widget-6',\n                    name: 'Widget 6',\n                    cssClasses: '-is-full-size',\n                })\n            );\n\n            page.set('widgetsData', [\n                {\n                    id: 'widget-1',\n                    domID: 'widget-1',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-2',\n                    domID: 'widget-2',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-3',\n                    domID: 'widget-3',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-4',\n                    domID: 'widget-4',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-5',\n                    domID: 'widget-5',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-6',\n                    domID: 'widget-6',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n            ]);\n\n            pageView.render();\n\n            const $widgets = pageView._$widgets;\n            expect($widgets.length).toBe(6);\n\n            expect($widgets[0].id).toBe('widget-1');\n            expect($widgets[1].id).toBe('widget-2');\n            expect($widgets[2].id).toBe('widget-3');\n            expect($widgets[3].id).toBe('widget-4');\n            expect($widgets[4].id).toBe('widget-5');\n            expect($widgets[5].id).toBe('widget-6');\n\n            expect($widgets[0]).toHaveClass('js-masonry-item');\n            expect($widgets[1]).toHaveClass('js-masonry-item');\n            expect($widgets[2]).toHaveClass('js-masonry-item');\n            expect($widgets[3]).toHaveClass('js-masonry-item');\n            expect($widgets[4]).toHaveClass('js-masonry-item');\n            expect($widgets[5]).toHaveClass('js-masonry-item');\n\n            const items = pageView._masonry.items;\n            expect(items.length).toBe(6);\n            expect(items[0].element).toBe($widgets[5]);\n            expect(items[1].element).toBe($widgets[2]);\n            expect(items[2].element).toBe($widgets[1]);\n            expect(items[3].element).toBe($widgets[4]);\n            expect(items[4].element).toBe($widgets[0]);\n            expect(items[5].element).toBe($widgets[3]);\n\n            expect(pageView.$el.css('visibility')).toBe('visible');\n        });\n\n        describe('sizeChanged event', function() {\n            let widgetView;\n\n            beforeEach(function() {\n                const $main = pageView.$('.rb-c-admin-widgets__main');\n\n                $main.append(widgetTemplate({\n                    domID: 'widget-1',\n                    name: 'Widget 1',\n                    cssClasses: '',\n                }));\n\n                page.set('widgetsData', [{\n                    id: 'widget-1',\n                    domID: 'widget-1',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                }]);\n\n                pageView.render();\n\n                widgetView = pageView._widgetViews['widget-1'];\n                expect(widgetView).not.toBeUndefined();\n\n                spyOn(pageView._masonry, 'layout');\n            });\n\n            it('Causes re-layout on element size change', function () {\n                const $widget = widgetView.$el;\n\n                $widget.width($widget.width() + 100);\n                widgetView.trigger('sizeChanged');\n\n                expect(pageView._masonry.layout).toHaveBeenCalled();\n            });\n\n            it('Ignored when element size does not change', function () {\n                pageView._widgetWidths['widget-1'] = widgetView.$el.width();\n                widgetView.trigger('sizeChanged');\n\n                expect(pageView._masonry.layout).not.toHaveBeenCalled();\n            });\n        });\n    });\n});\n"],"mappings":"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"}