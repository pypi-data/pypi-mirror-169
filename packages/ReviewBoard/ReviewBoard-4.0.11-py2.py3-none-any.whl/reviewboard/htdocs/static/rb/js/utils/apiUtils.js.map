{"version":3,"file":"apiUtils.js","names":["$","ajaxTransport","options","origOptions","jqXHR","window","FormData","xhr","send","headers","completeCB","addEventListener","result","dataType","response","status","statusText","getAllResponseHeaders","username","open","type","url","async","password","responseType","xhrFields","field","hasOwnProperty","crossDomain","key","setRequestHeader","e","hasContent","data","abort","readyState","RB","setActivityIndicator","enabled","$activityIndicator","ajaxOptions","enableIndicator","noActivityIndicator","children","text","removeClass","show","hasClass","delay","fadeOut","apiCall","prefix","SITE_ROOT","path","showErrorPage","$iframe","width","requestData","param","appendTo","document","body","append","on","height","position","top","modalBox","stretchX","stretchY","title","doc","contentDocument","contentWindow","write","close","doCall","buttons","attr","extend","error","textStatus","errorThrown","responseText","rsp","JSON","parse","stat","_","isFunction","success","addClass","click","complete","funcQueue","next","undefined","Object","Blob","api_format","form","ajaxSubmit","ajax","UserSession","instance","get","console","enableQueuing","add","start","storeAPIError","errorPayload","errorText","err","msg","Backbone"],"sources":["apiUtils.es6.js"],"sourcesContent":["/**\n * jQuery AJAX transport for receiving Blob and ArrayBuffer data.\n *\n * XMLHttpRequest2 supports receiving binary data represented by\n * :js:class:`Blob` and :js:class:`ArrayBuffer`. This transport enabled binary\n * data support through standard :js:func:`jQuery.ajax` calls.\n */\n$.ajaxTransport('arraybuffer blob', function(options, origOptions, jqXHR) {\n    if (!window.FormData) {\n        return null;\n    }\n\n    let xhr;\n\n    return {\n        send(headers, completeCB) {\n            xhr = options.xhr();\n            xhr.addEventListener('load', () => {\n                const result = {};\n                result[options.dataType] = xhr.response;\n\n                completeCB(xhr.status, xhr.statusText, result,\n                           xhr.getAllResponseHeaders());\n            });\n\n            if (options.username) {\n                xhr.open(options.type, options.url, options.async,\n                         options.username, options.password);\n            } else {\n                xhr.open(options.type, options.url, options.async);\n            }\n\n            xhr.responseType = options.dataType;\n\n            /* Apply any custom fields that may be provided. */\n            const xhrFields = options.xhrFields;\n\n            if (xhrFields) {\n                for (let field in xhrFields) {\n                    if (xhrFields.hasOwnProperty(field)) {\n                        xhr[field] = xhrFields[field];\n                    }\n                }\n            }\n\n            if (!options.crossDomain && !headers['X-Requested-With']) {\n                headers['X-Requested-With'] = 'XMLHttpRequest';\n            }\n\n            /*\n             * Catch errors with cross-domain requests, like jQuery does.\n             */\n            try {\n                for (let key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            } catch (e) {}\n\n            xhr.send(options.hasContent ? options.data : null);\n        },\n\n        abort() {\n            if (xhr && xhr.readyState !== 4) {\n                xhr.abort();\n            }\n        },\n    };\n});\n\n\n/**\n * Enable or disable the activity indicator.\n *\n * Args:\n *     enabled (boolean):\n *         Whether the activity indicator should be enabled.\n *\n *     options (object):\n *         Additional options.\n *\n * Option Args:\n *     noActivityIndicator (boolean):\n *         True if the indicator should be suppressed, even if ``enabled`` is\n *         true.\n *\n *     type (string):\n *         The type of HTTP request that the indicator is representing. This\n *         will be either ``GET`` (loading) or ``POST`` (saving).\n */\nRB.setActivityIndicator = function(enabled, options) {\n    const $activityIndicator = $('#activity-indicator');\n\n    if (enabled) {\n        if (RB.ajaxOptions.enableIndicator && !options.noActivityIndicator) {\n            $activityIndicator.children('.indicator-text')\n                .text((options.type && options.type === 'GET')\n                      ? gettext('Loading...') : gettext('Saving...'));\n\n            $activityIndicator\n                .removeClass('error')\n                .show();\n        }\n    } else if (RB.ajaxOptions.enableIndicator &&\n               !options.noActivityIndicator &&\n               !$activityIndicator.hasClass('error')) {\n        $activityIndicator\n            .delay(250)\n            .fadeOut('fast');\n    }\n};\n\n\n/**\n * Make an API request.\n *\n * This will handle any button disabling/enabling, write to the correct path\n * prefix, do form uploading, and display server errors.\n *\n * Args:\n *     options (object):\n *         Options for the API request.\n *\n * Option Args:\n *     buttons (jQuery):\n *         Any buttons to disable while the API request is in flight.\n *\n *     form (jQuery):\n *         A form to submit, if any.\n *\n *     type (string):\n *         The type of HTTP request to make. Defaults to ``POST``.\n *\n *     prefix (string):\n *         The prefix for the API path (after ``SITE_ROOT``, before ``api``).\n *\n *     path (string):\n *         The relative path from the server name to the Review Board API\n *         endpoint.\n *\n *     data (object):\n *         Additional data to send with the request.\n *\n *     success (function):\n *         An optional success callback. If not specified, the default handler\n *         will reload the page.\n *\n *     error (function):\n *         An optional error callback, to be called after the error banner is\n *         displayed.\n *\n *     complete (function):\n *         An optional complete callback, which is called after the success or\n *         error callbacks.\n */\nRB.apiCall = function(options) {\n    const prefix = options.prefix || '';\n    const url = options.url || (SITE_ROOT + prefix + 'api' + options.path);\n\n    function showErrorPage(xhr, data) {\n        const $iframe = $('<iframe/>').width('100%');\n        const requestData = options.data ? $.param(options.data) : '(none)';\n\n        $('<div class=\"server-error-box\"/>')\n            .appendTo(document.body)\n            .append('<p><b>' + gettext('Error Code:') + '</b> ' + xhr.status + '</p>')\n            .append('<p><b>' + gettext('Error Text:') + '</b> ' + xhr.statusText + '</p>')\n            .append('<p><b>' + gettext('Request URL:') + '</b> ' + url + '</p>')\n            .append('<p><b>' + gettext('Request Data:') + '</b> ' + requestData + '</p>')\n            .append('<p class=\"response-data\"><b>' + gettext('Response Data:') + '</b></p>')\n            .append(gettext('<p>There may be useful error details below. The following error page may be useful to your system administrator or when <a href=\"https://www.reviewboard.org/bugs/new/\">reporting a bug</a>. To save the page, right-click the error below and choose \"Save Page As,\" if available, or \"View Source\" and save the result as a <tt>.html</tt> file.</p>'))\n            .append(gettext('<p><b>Warning:</b> Be sure to remove any sensitive material that may exist in the error page before reporting a bug!</p>'))\n            .append($iframe)\n            .on('resize', function() {\n                $iframe.height($(this).height() - $iframe.position().top);\n            })\n            .modalBox({\n                stretchX: true,\n                stretchY: true,\n                title: gettext('Server Error Details')\n            });\n\n        const doc = $iframe[0].contentDocument || $iframe[0].contentWindow.document;\n        doc.open();\n        doc.write(data);\n        doc.close();\n    }\n\n    function doCall() {\n        const $activityIndicator = $('#activity-indicator');\n\n        if (options.buttons) {\n            options.buttons.attr('disabled', true);\n        }\n\n        RB.setActivityIndicator(true, options);\n\n        const data = $.extend(true, {\n            url: url,\n            data: options.data,\n            dataType: options.dataType || 'json',\n            error: function(xhr, textStatus, errorThrown) {\n                const responseText = xhr.responseText;\n\n                let rsp = null;\n                try {\n                    rsp = JSON.parse(responseText);\n                } catch (e) {\n                }\n\n                if ((rsp && rsp.stat) || xhr.status === 204) {\n                    if (_.isFunction(options.success)) {\n                        options.success(rsp, xhr.status);\n                    }\n\n                    return;\n                }\n\n                $activityIndicator\n                    .addClass('error')\n                    .text(gettext('A server error occurred.'))\n                    .append(\n                        $('<a href=\"#\" />')\n                            .text(gettext('Show Details'))\n                            .click(() => showErrorPage(xhr, responseText))\n                    )\n                    .append(\n                        $('<a href=\"#\" />')\n                            .text(gettext('Dismiss'))\n                            .click(function() {\n                                $activityIndicator.fadeOut('fast');\n                                return false;\n                            })\n                    );\n\n                if (_.isFunction(options.error)) {\n                    options.error(xhr, textStatus, errorThrown);\n                }\n            },\n            complete: function(xhr, status) {\n                if (options.buttons) {\n                    options.buttons.attr('disabled', false);\n                }\n\n                RB.setActivityIndicator(false, options);\n\n                if (_.isFunction(options.complete)) {\n                    options.complete(xhr, status);\n                }\n\n                $.funcQueue('rbapicall').next();\n            }\n        }, options);\n\n        if (data.data === null || data.data === undefined ||\n            (data.data instanceof Object &&\n             !(window.Blob && data.data instanceof Blob))) {\n            data.data = $.extend({\n                api_format: 'json'\n            }, data.data || {});\n        }\n\n        if (options.form) {\n            options.form.ajaxSubmit(data);\n        } else {\n            $.ajax(data);\n        }\n    }\n\n    options.type = options.type || 'POST';\n\n    if (options.type !== 'GET' && options.type !== 'HEAD' &&\n        RB.UserSession.instance.get('readOnly')) {\n        console.error('%s request not sent. Site is in read-only mode.',\n                      options.type);\n        return;\n    }\n\n    // We allow disabling the function queue for the sake of unit tests.\n    if (RB.ajaxOptions.enableQueuing && options.type !== 'GET') {\n        $.funcQueue('rbapicall').add(doCall);\n        $.funcQueue('rbapicall').start();\n    } else {\n        doCall();\n    }\n};\n\n/**\n * Parse API error information from a response and stores it.\n *\n * The xhr object provided will be extended with two new attributes:\n * 'errorText' and 'errorPayload'. These represent the response's error\n * message and full error payload, respectively.\n *\n * Args:\n *     xhr (jqXHR):\n *         The XMLHttpRequest object.\n */\nRB.storeAPIError = function(xhr) {\n    try {\n        const rsp = JSON.parse(xhr.responseText);\n        xhr.errorPayload = rsp;\n        xhr.errorText = rsp.err.msg;\n    } catch (e) {\n        xhr.errorPayload = null;\n        xhr.errorText = 'HTTP ' + xhr.status + ' ' + xhr.statusText;\n    }\n};\n\n\nRB.ajaxOptions = {\n    enableQueuing: true,\n    enableIndicator: true\n};\n\n\n/*\n * Call RB.apiCall instead of $.ajax.\n *\n * We wrap instead of assign for now so that we can hook in/override\n * RB.apiCall with unit tests.\n */\nBackbone.ajax = options => RB.apiCall(options);\n\n\n// vim: set et:sw=4:\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,CAAC,CAACC,aAAF,CAAgB,kBAAhB,EAAoC,UAASC,OAAT,EAAkBC,WAAlB,EAA+BC,KAA/B,EAAsC;EACtE,IAAI,CAACC,MAAM,CAACC,QAAZ,EAAsB;IAClB,OAAO,IAAP;EACH;;EAED,IAAIC,GAAJ;EAEA,OAAO;IACHC,IAAI,CAACC,OAAD,EAAUC,UAAV,EAAsB;MACtBH,GAAG,GAAGL,OAAO,CAACK,GAAR,EAAN;MACAA,GAAG,CAACI,gBAAJ,CAAqB,MAArB,EAA6B,MAAM;QAC/B,MAAMC,MAAM,GAAG,EAAf;QACAA,MAAM,CAACV,OAAO,CAACW,QAAT,CAAN,GAA2BN,GAAG,CAACO,QAA/B;QAEAJ,UAAU,CAACH,GAAG,CAACQ,MAAL,EAAaR,GAAG,CAACS,UAAjB,EAA6BJ,MAA7B,EACCL,GAAG,CAACU,qBAAJ,EADD,CAAV;MAEH,CAND;;MAQA,IAAIf,OAAO,CAACgB,QAAZ,EAAsB;QAClBX,GAAG,CAACY,IAAJ,CAASjB,OAAO,CAACkB,IAAjB,EAAuBlB,OAAO,CAACmB,GAA/B,EAAoCnB,OAAO,CAACoB,KAA5C,EACSpB,OAAO,CAACgB,QADjB,EAC2BhB,OAAO,CAACqB,QADnC;MAEH,CAHD,MAGO;QACHhB,GAAG,CAACY,IAAJ,CAASjB,OAAO,CAACkB,IAAjB,EAAuBlB,OAAO,CAACmB,GAA/B,EAAoCnB,OAAO,CAACoB,KAA5C;MACH;;MAEDf,GAAG,CAACiB,YAAJ,GAAmBtB,OAAO,CAACW,QAA3B;MAEA;;MACA,MAAMY,SAAS,GAAGvB,OAAO,CAACuB,SAA1B;;MAEA,IAAIA,SAAJ,EAAe;QACX,KAAK,IAAIC,KAAT,IAAkBD,SAAlB,EAA6B;UACzB,IAAIA,SAAS,CAACE,cAAV,CAAyBD,KAAzB,CAAJ,EAAqC;YACjCnB,GAAG,CAACmB,KAAD,CAAH,GAAaD,SAAS,CAACC,KAAD,CAAtB;UACH;QACJ;MACJ;;MAED,IAAI,CAACxB,OAAO,CAAC0B,WAAT,IAAwB,CAACnB,OAAO,CAAC,kBAAD,CAApC,EAA0D;QACtDA,OAAO,CAAC,kBAAD,CAAP,GAA8B,gBAA9B;MACH;MAED;AACZ;AACA;;;MACY,IAAI;QACA,KAAK,IAAIoB,GAAT,IAAgBpB,OAAhB,EAAyB;UACrB,IAAIA,OAAO,CAACkB,cAAR,CAAuBE,GAAvB,CAAJ,EAAiC;YAC7BtB,GAAG,CAACuB,gBAAJ,CAAqBD,GAArB,EAA0BpB,OAAO,CAACoB,GAAD,CAAjC;UACH;QACJ;MACJ,CAND,CAME,OAAOE,CAAP,EAAU,CAAE;;MAEdxB,GAAG,CAACC,IAAJ,CAASN,OAAO,CAAC8B,UAAR,GAAqB9B,OAAO,CAAC+B,IAA7B,GAAoC,IAA7C;IACH,CA/CE;;IAiDHC,KAAK,GAAG;MACJ,IAAI3B,GAAG,IAAIA,GAAG,CAAC4B,UAAJ,KAAmB,CAA9B,EAAiC;QAC7B5B,GAAG,CAAC2B,KAAJ;MACH;IACJ;;EArDE,CAAP;AAuDH,CA9DD;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAE,EAAE,CAACC,oBAAH,GAA0B,UAASC,OAAT,EAAkBpC,OAAlB,EAA2B;EACjD,MAAMqC,kBAAkB,GAAGvC,CAAC,CAAC,qBAAD,CAA5B;;EAEA,IAAIsC,OAAJ,EAAa;IACT,IAAIF,EAAE,CAACI,WAAH,CAAeC,eAAf,IAAkC,CAACvC,OAAO,CAACwC,mBAA/C,EAAoE;MAChEH,kBAAkB,CAACI,QAAnB,CAA4B,iBAA5B,EACKC,IADL,CACW1C,OAAO,CAACkB,IAAR,IAAgBlB,OAAO,CAACkB,IAAR,KAAiB,KAAlC,+CADV;MAIAmB,kBAAkB,CACbM,WADL,CACiB,OADjB,EAEKC,IAFL;IAGH;EACJ,CAVD,MAUO,IAAIV,EAAE,CAACI,WAAH,CAAeC,eAAf,IACA,CAACvC,OAAO,CAACwC,mBADT,IAEA,CAACH,kBAAkB,CAACQ,QAAnB,CAA4B,OAA5B,CAFL,EAE2C;IAC9CR,kBAAkB,CACbS,KADL,CACW,GADX,EAEKC,OAFL,CAEa,MAFb;EAGH;AACJ,CApBD;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAb,EAAE,CAACc,OAAH,GAAa,UAAShD,OAAT,EAAkB;EAC3B,MAAMiD,MAAM,GAAGjD,OAAO,CAACiD,MAAR,IAAkB,EAAjC;EACA,MAAM9B,GAAG,GAAGnB,OAAO,CAACmB,GAAR,IAAgB+B,SAAS,GAAGD,MAAZ,GAAqB,KAArB,GAA6BjD,OAAO,CAACmD,IAAjE;;EAEA,SAASC,aAAT,CAAuB/C,GAAvB,EAA4B0B,IAA5B,EAAkC;IAC9B,MAAMsB,OAAO,GAAGvD,CAAC,CAAC,WAAD,CAAD,CAAewD,KAAf,CAAqB,MAArB,CAAhB;IACA,MAAMC,WAAW,GAAGvD,OAAO,CAAC+B,IAAR,GAAejC,CAAC,CAAC0D,KAAF,CAAQxD,OAAO,CAAC+B,IAAhB,CAAf,GAAuC,QAA3D;IAEAjC,CAAC,CAAC,iCAAD,CAAD,CACK2D,QADL,CACcC,QAAQ,CAACC,IADvB,EAEKC,MAFL,CAEY,oCAAoC,OAApC,GAA8CvD,GAAG,CAACQ,MAAlD,GAA2D,MAFvE,EAGK+C,MAHL,CAGY,oCAAoC,OAApC,GAA8CvD,GAAG,CAACS,UAAlD,GAA+D,MAH3E,EAIK8C,MAJL,CAIY,qCAAqC,OAArC,GAA+CzC,GAA/C,GAAqD,MAJjE,EAKKyC,MALL,CAKY,sCAAsC,OAAtC,GAAgDL,WAAhD,GAA8D,MAL1E,EAMKK,MANL,CAMY,6DAA6D,UANzE,EAOKA,MAPL,0WAQKA,MARL,sIASKA,MATL,CASYP,OATZ,EAUKQ,EAVL,CAUQ,QAVR,EAUkB,YAAW;MACrBR,OAAO,CAACS,MAAR,CAAehE,CAAC,CAAC,IAAD,CAAD,CAAQgE,MAAR,KAAmBT,OAAO,CAACU,QAAR,GAAmBC,GAArD;IACH,CAZL,EAaKC,QAbL,CAac;MACNC,QAAQ,EAAE,IADJ;MAENC,QAAQ,EAAE,IAFJ;MAGNC,KAAK;IAHC,CAbd;IAmBA,MAAMC,GAAG,GAAGhB,OAAO,CAAC,CAAD,CAAP,CAAWiB,eAAX,IAA8BjB,OAAO,CAAC,CAAD,CAAP,CAAWkB,aAAX,CAAyBb,QAAnE;IACAW,GAAG,CAACpD,IAAJ;IACAoD,GAAG,CAACG,KAAJ,CAAUzC,IAAV;IACAsC,GAAG,CAACI,KAAJ;EACH;;EAED,SAASC,MAAT,GAAkB;IACd,MAAMrC,kBAAkB,GAAGvC,CAAC,CAAC,qBAAD,CAA5B;;IAEA,IAAIE,OAAO,CAAC2E,OAAZ,EAAqB;MACjB3E,OAAO,CAAC2E,OAAR,CAAgBC,IAAhB,CAAqB,UAArB,EAAiC,IAAjC;IACH;;IAED1C,EAAE,CAACC,oBAAH,CAAwB,IAAxB,EAA8BnC,OAA9B;IAEA,MAAM+B,IAAI,GAAGjC,CAAC,CAAC+E,MAAF,CAAS,IAAT,EAAe;MACxB1D,GAAG,EAAEA,GADmB;MAExBY,IAAI,EAAE/B,OAAO,CAAC+B,IAFU;MAGxBpB,QAAQ,EAAEX,OAAO,CAACW,QAAR,IAAoB,MAHN;MAIxBmE,KAAK,EAAE,UAASzE,GAAT,EAAc0E,UAAd,EAA0BC,WAA1B,EAAuC;QAC1C,MAAMC,YAAY,GAAG5E,GAAG,CAAC4E,YAAzB;QAEA,IAAIC,GAAG,GAAG,IAAV;;QACA,IAAI;UACAA,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWH,YAAX,CAAN;QACH,CAFD,CAEE,OAAOpD,CAAP,EAAU,CACX;;QAED,IAAKqD,GAAG,IAAIA,GAAG,CAACG,IAAZ,IAAqBhF,GAAG,CAACQ,MAAJ,KAAe,GAAxC,EAA6C;UACzC,IAAIyE,CAAC,CAACC,UAAF,CAAavF,OAAO,CAACwF,OAArB,CAAJ,EAAmC;YAC/BxF,OAAO,CAACwF,OAAR,CAAgBN,GAAhB,EAAqB7E,GAAG,CAACQ,MAAzB;UACH;;UAED;QACH;;QAEDwB,kBAAkB,CACboD,QADL,CACc,OADd,EAEK/C,IAFL,sCAGKkB,MAHL,CAIQ9D,CAAC,CAAC,gBAAD,CAAD,CACK4C,IADL,0BAEKgD,KAFL,CAEW,MAAMtC,aAAa,CAAC/C,GAAD,EAAM4E,YAAN,CAF9B,CAJR,EAQKrB,MARL,CASQ9D,CAAC,CAAC,gBAAD,CAAD,CACK4C,IADL,qBAEKgD,KAFL,CAEW,YAAW;UACdrD,kBAAkB,CAACU,OAAnB,CAA2B,MAA3B;UACA,OAAO,KAAP;QACH,CALL,CATR;;QAiBA,IAAIuC,CAAC,CAACC,UAAF,CAAavF,OAAO,CAAC8E,KAArB,CAAJ,EAAiC;UAC7B9E,OAAO,CAAC8E,KAAR,CAAczE,GAAd,EAAmB0E,UAAnB,EAA+BC,WAA/B;QACH;MACJ,CAzCuB;MA0CxBW,QAAQ,EAAE,UAAStF,GAAT,EAAcQ,MAAd,EAAsB;QAC5B,IAAIb,OAAO,CAAC2E,OAAZ,EAAqB;UACjB3E,OAAO,CAAC2E,OAAR,CAAgBC,IAAhB,CAAqB,UAArB,EAAiC,KAAjC;QACH;;QAED1C,EAAE,CAACC,oBAAH,CAAwB,KAAxB,EAA+BnC,OAA/B;;QAEA,IAAIsF,CAAC,CAACC,UAAF,CAAavF,OAAO,CAAC2F,QAArB,CAAJ,EAAoC;UAChC3F,OAAO,CAAC2F,QAAR,CAAiBtF,GAAjB,EAAsBQ,MAAtB;QACH;;QAEDf,CAAC,CAAC8F,SAAF,CAAY,WAAZ,EAAyBC,IAAzB;MACH;IAtDuB,CAAf,EAuDV7F,OAvDU,CAAb;;IAyDA,IAAI+B,IAAI,CAACA,IAAL,KAAc,IAAd,IAAsBA,IAAI,CAACA,IAAL,KAAc+D,SAApC,IACC/D,IAAI,CAACA,IAAL,YAAqBgE,MAArB,IACA,EAAE5F,MAAM,CAAC6F,IAAP,IAAejE,IAAI,CAACA,IAAL,YAAqBiE,IAAtC,CAFL,EAEmD;MAC/CjE,IAAI,CAACA,IAAL,GAAYjC,CAAC,CAAC+E,MAAF,CAAS;QACjBoB,UAAU,EAAE;MADK,CAAT,EAETlE,IAAI,CAACA,IAAL,IAAa,EAFJ,CAAZ;IAGH;;IAED,IAAI/B,OAAO,CAACkG,IAAZ,EAAkB;MACdlG,OAAO,CAACkG,IAAR,CAAaC,UAAb,CAAwBpE,IAAxB;IACH,CAFD,MAEO;MACHjC,CAAC,CAACsG,IAAF,CAAOrE,IAAP;IACH;EACJ;;EAED/B,OAAO,CAACkB,IAAR,GAAelB,OAAO,CAACkB,IAAR,IAAgB,MAA/B;;EAEA,IAAIlB,OAAO,CAACkB,IAAR,KAAiB,KAAjB,IAA0BlB,OAAO,CAACkB,IAAR,KAAiB,MAA3C,IACAgB,EAAE,CAACmE,WAAH,CAAeC,QAAf,CAAwBC,GAAxB,CAA4B,UAA5B,CADJ,EAC6C;IACzCC,OAAO,CAAC1B,KAAR,CAAc,iDAAd,EACc9E,OAAO,CAACkB,IADtB;IAEA;EACH,CAzH0B,CA2H3B;;;EACA,IAAIgB,EAAE,CAACI,WAAH,CAAemE,aAAf,IAAgCzG,OAAO,CAACkB,IAAR,KAAiB,KAArD,EAA4D;IACxDpB,CAAC,CAAC8F,SAAF,CAAY,WAAZ,EAAyBc,GAAzB,CAA6BhC,MAA7B;IACA5E,CAAC,CAAC8F,SAAF,CAAY,WAAZ,EAAyBe,KAAzB;EACH,CAHD,MAGO;IACHjC,MAAM;EACT;AACJ,CAlID;AAoIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAxC,EAAE,CAAC0E,aAAH,GAAmB,UAASvG,GAAT,EAAc;EAC7B,IAAI;IACA,MAAM6E,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAW/E,GAAG,CAAC4E,YAAf,CAAZ;IACA5E,GAAG,CAACwG,YAAJ,GAAmB3B,GAAnB;IACA7E,GAAG,CAACyG,SAAJ,GAAgB5B,GAAG,CAAC6B,GAAJ,CAAQC,GAAxB;EACH,CAJD,CAIE,OAAOnF,CAAP,EAAU;IACRxB,GAAG,CAACwG,YAAJ,GAAmB,IAAnB;IACAxG,GAAG,CAACyG,SAAJ,GAAgB,UAAUzG,GAAG,CAACQ,MAAd,GAAuB,GAAvB,GAA6BR,GAAG,CAACS,UAAjD;EACH;AACJ,CATD;;AAYAoB,EAAE,CAACI,WAAH,GAAiB;EACbmE,aAAa,EAAE,IADF;EAEblE,eAAe,EAAE;AAFJ,CAAjB;AAMA;AACA;AACA;AACA;AACA;AACA;;AACA0E,QAAQ,CAACb,IAAT,GAAgBpG,OAAO,IAAIkC,EAAE,CAACc,OAAH,CAAWhD,OAAX,CAA3B,C,CAGA"}