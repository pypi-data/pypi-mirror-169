{"version":3,"file":"reviewReplyModelTests.js","names":["suite","parentObject","model","beforeEach","RB","BaseResource","links","replies","href","ReviewReply","describe","callbacks","ready","error","spyOn","Backbone","Model","prototype","and","callFake","options","_","isFunction","success","callThrough","context","call","expect","isNew","toBe","get","status","it","destroy","toHaveBeenCalled","_retrieveDraft","fetch","set","id","loaded","not","discardIfEmpty","commentsData","self","diff_comments","screenshot_comments","file_attachment_comments","general_comments","data","key","find","COMMENT_LINK_NAMES","name","url","toHaveBeenCalledWith","bodyTop","bodyBottom","_needDraft","undefined","calls","reset","rspNamespace","parse","stat","my_reply","body_top","body_bottom","body_top_text_type","body_bottom_text_type","public","bodyTopRichText","bodyBottomRichText","toJSON","force_text_type","include_text_types"],"sources":["reviewReplyModelTests.es6.js"],"sourcesContent":["suite('rb/resources/models/ReviewReply', function() {\n    let parentObject;\n    let model;\n\n    beforeEach(function() {\n        parentObject = new RB.BaseResource({\n            'public': true,\n            links: {\n                replies: {\n                    href: '/api/foos/replies/',\n                },\n            },\n        });\n\n        model = new RB.ReviewReply({\n            parentObject: parentObject,\n        });\n    });\n\n    describe('destroy', function() {\n        let callbacks;\n\n        beforeEach(function() {\n            callbacks = {\n                ready: function() {},\n                error: function() {},\n            };\n\n            spyOn(Backbone.Model.prototype, 'destroy')\n                .and.callFake(options => {\n                    if (options && _.isFunction(options.success)) {\n                        options.success();\n                    }\n                });\n            spyOn(model, '_retrieveDraft').and.callThrough();\n            spyOn(parentObject, 'ready')\n                .and.callFake((options, context) => {\n                    if (options && _.isFunction(options.ready)) {\n                        options.ready.call(context);\n                    }\n                });\n            spyOn(callbacks, 'ready');\n            spyOn(callbacks, 'error');\n        });\n\n        describe('With isNew=true', function() {\n            beforeEach(function() {\n                expect(model.isNew()).toBe(true);\n                expect(model.get('loaded')).toBe(false);\n\n                spyOn(Backbone.Model.prototype, 'fetch')\n                    .and.callFake(options => {\n                        if (options && _.isFunction(options.success)) {\n                            options.error(model, {\n                                status: 404,\n                            });\n                        }\n                    });\n            });\n\n            it('With callbacks', function() {\n                model.destroy(callbacks);\n\n                expect(model.isNew()).toBe(true);\n                expect(model.get('loaded')).toBe(false);\n\n                expect(parentObject.ready).toHaveBeenCalled();\n                expect(model._retrieveDraft).toHaveBeenCalled();\n                expect(Backbone.Model.prototype.fetch).toHaveBeenCalled();\n                expect(Backbone.Model.prototype.destroy).toHaveBeenCalled();\n            });\n        });\n\n        describe('With isNew=false', function() {\n            beforeEach(function() {\n                model.set({\n                    id: 123,\n                    loaded: true,\n                });\n\n                spyOn(Backbone.Model.prototype, 'fetch');\n            });\n\n            it('With callbacks', function() {\n                model.destroy(callbacks);\n\n                expect(parentObject.ready).toHaveBeenCalled();\n                expect(model._retrieveDraft).not.toHaveBeenCalled();\n                expect(Backbone.Model.prototype.fetch).not.toHaveBeenCalled();\n                expect(Backbone.Model.prototype.destroy).toHaveBeenCalled();\n            });\n        });\n    });\n\n    describe('discardIfEmpty', function() {\n        let callbacks;\n\n        beforeEach(function() {\n            callbacks = {\n                success: function() {},\n                error: function() {},\n            };\n\n            spyOn(model, 'destroy')\n                .and.callFake(options => {\n                    if (options && _.isFunction(options.success)) {\n                        options.success();\n                    }\n                });\n            spyOn(parentObject, 'ready')\n                .and.callFake((options, context) => {\n                    if (options && _.isFunction(options.ready)) {\n                        options.ready.call(context);\n                    }\n                });\n            spyOn(model, 'ready')\n                .and.callFake((options, context) => {\n                    if (options && _.isFunction(options.ready)) {\n                        options.ready.call(context);\n                    }\n                });\n            spyOn(callbacks, 'success');\n            spyOn(callbacks, 'error');\n        });\n\n        it('With isNew=true', function() {\n            expect(model.isNew()).toBe(true);\n            expect(model.get('loaded')).toBe(false);\n\n            model.discardIfEmpty(callbacks);\n\n            expect(model.destroy).not.toHaveBeenCalled();\n        });\n\n        describe('With isNew=false', function() {\n            const commentsData = {};\n\n            beforeEach(function() {\n                model.set({\n                    id: 123,\n                    loaded: true,\n                    links: {\n                        self: {\n                            href: '/api/foos/replies/123/',\n                        },\n                        diff_comments: {\n                            href: '/api/diff-comments/',\n                        },\n                        screenshot_comments: {\n                            href: '/api/screenshot-comments/',\n                        },\n                        file_attachment_comments: {\n                            href: '/api/file-attachment-comments/',\n                        },\n                        general_comments: {\n                            href: '/api/general-comments/',\n                        },\n                    },\n                });\n\n                spyOn(RB, 'apiCall').and.callFake(options => {\n                    const links = model.get('links');\n                    const data = {};\n                    const key = _.find(\n                        RB.ReviewReply.prototype.COMMENT_LINK_NAMES,\n                        name => (options.url === links[name].href));\n\n                    if (key) {\n                        data[key] = commentsData[key] || [];\n                        options.success(data);\n                    } else {\n                        options.error({\n                            status: 404,\n                        });\n                    }\n                });\n                spyOn(Backbone.Model.prototype, 'fetch')\n                    .and.callFake(options => {\n                        if (options && _.isFunction(options.success)) {\n                            options.success();\n                        }\n                    });\n            });\n\n            it('With no comments or body replies', function() {\n                model.discardIfEmpty(callbacks);\n\n                expect(model.destroy).toHaveBeenCalled();\n                expect(callbacks.success).toHaveBeenCalledWith(true);\n            });\n\n            it('With bodyTop', function() {\n                model.set({\n                    bodyTop: 'hi',\n                });\n                model.discardIfEmpty(callbacks);\n\n                expect(model.destroy).not.toHaveBeenCalled();\n                expect(callbacks.success).toHaveBeenCalledWith(false);\n            });\n\n            it('With bodyBottom', function() {\n                model.set({\n                    bodyBottom: 'hi',\n                });\n                model.discardIfEmpty(callbacks);\n\n                expect(model.destroy).not.toHaveBeenCalled();\n                expect(callbacks.success).toHaveBeenCalledWith(false);\n            });\n\n            it('With diff comment', function() {\n                commentsData.diff_comments = [{\n                    id: 1,\n                }];\n\n                model.discardIfEmpty(callbacks);\n\n                expect(model.destroy).not.toHaveBeenCalled();\n                expect(callbacks.success).toHaveBeenCalledWith(false);\n            });\n\n            it('With screenshot comment', function() {\n                commentsData.screenshot_comments = [{\n                    id: 1,\n                }];\n\n                model.discardIfEmpty(callbacks);\n\n                expect(model.destroy).not.toHaveBeenCalled();\n                expect(callbacks.success).toHaveBeenCalledWith(false);\n            });\n\n            it('With file attachment comment', function() {\n                commentsData.file_attachment_comments = [{\n                    id: 1,\n                }];\n\n                model.discardIfEmpty(callbacks);\n\n                expect(model.destroy).not.toHaveBeenCalled();\n                expect(callbacks.success).toHaveBeenCalledWith(false);\n            });\n\n            it('With general comment', function() {\n                commentsData.general_comments = [{\n                    id: 1,\n                }];\n\n                model.discardIfEmpty(callbacks);\n\n                expect(model.destroy).not.toHaveBeenCalled();\n                expect(callbacks.success).toHaveBeenCalledWith(false);\n            });\n        });\n    });\n\n    describe('ready', function() {\n        let callbacks;\n\n        beforeEach(function() {\n            callbacks = {\n                ready: function() {},\n                error: function() {},\n            };\n\n            spyOn(parentObject, 'ready')\n                .and.callFake((options, context) => {\n                    if (options && _.isFunction(options.ready)) {\n                        options.ready.call(context);\n                    }\n                });\n            spyOn(callbacks, 'ready');\n            spyOn(callbacks, 'error');\n        });\n\n        describe('With isNew=true', function() {\n            beforeEach(function() {\n                expect(model.isNew()).toBe(true);\n                expect(model.get('loaded')).toBe(false);\n\n                spyOn(Backbone.Model.prototype, 'fetch')\n                    .and.callFake(options => {\n                        if (options && _.isFunction(options.success)) {\n                            options.success();\n                        }\n                    });\n                spyOn(model, '_retrieveDraft')\n                    .and.callFake((options, context) => {\n                        if (options && _.isFunction(options.ready)) {\n                            options.ready.call(context);\n                        }\n                    });\n            });\n\n            it('With callbacks', function() {\n                model.ready(callbacks);\n\n                expect(parentObject.ready).toHaveBeenCalled();\n                expect(model._retrieveDraft).toHaveBeenCalled();\n                expect(callbacks.ready).toHaveBeenCalled();\n            });\n        });\n\n        describe('With isNew=false', function() {\n            beforeEach(function() {\n                model.set({\n                    id: 123,\n                });\n\n                spyOn(Backbone.Model.prototype, 'fetch')\n                    .and.callFake(options => {\n                        if (options && _.isFunction(options.success)) {\n                            options.success();\n                        }\n                    });\n                spyOn(model, '_retrieveDraft')\n                    .and.callFake((options, context) => {\n                        if (options && _.isFunction(options.ready)) {\n                            options.ready.call(context);\n                        }\n                    });\n            });\n\n            it('With callbacks', function() {\n                model.ready(callbacks);\n\n                expect(parentObject.ready).toHaveBeenCalled();\n                expect(model._retrieveDraft).not.toHaveBeenCalled();\n                expect(callbacks.ready).toHaveBeenCalled();\n            });\n        });\n\n        it('After destruction', function() {\n            spyOn(model, '_retrieveDraft').and.callThrough();\n\n            spyOn(Backbone.Model.prototype, 'fetch').and.callFake(options => {\n                model.set({\n                    id: 123,\n                    links: {\n                        self: {\n                            href: '/api/foos/replies/123/',\n                        },\n                    },\n                    loaded: true,\n                });\n\n                options.success();\n            });\n\n            spyOn(Backbone.Model.prototype, 'destroy').and.callFake(\n                options => options.success());\n\n            expect(model.isNew()).toBe(true);\n            expect(model.get('loaded')).toBe(false);\n            expect(model._needDraft).toBe(undefined);\n\n            /* Make our initial ready call. */\n            model.ready(callbacks);\n\n            expect(parentObject.ready).toHaveBeenCalled();\n            expect(model._retrieveDraft).toHaveBeenCalled();\n            expect(Backbone.Model.prototype.fetch).toHaveBeenCalled();\n            expect(callbacks.ready).toHaveBeenCalled();\n            expect(model.isNew()).toBe(false);\n            expect(model.get('loaded')).toBe(true);\n            expect(model._needDraft).toBe(false);\n\n            /* We have a loaded object. Reset it. */\n            model.destroy(callbacks);\n\n            expect(model.isNew()).toBe(true);\n            expect(model.get('loaded')).toBe(false);\n            expect(model._needDraft).toBe(true);\n\n            parentObject.ready.calls.reset();\n            model._retrieveDraft.calls.reset();\n            callbacks.ready.calls.reset();\n\n            /* Now that it's destroyed, try to fetch it again. */\n            model.ready(callbacks);\n\n            expect(model._retrieveDraft).toHaveBeenCalled();\n            expect(Backbone.Model.prototype.fetch).toHaveBeenCalled();\n            expect(callbacks.ready).toHaveBeenCalled();\n            expect(model._needDraft).toBe(false);\n        });\n    });\n\n    describe('parse', function() {\n        beforeEach(function() {\n            model.rspNamespace = 'my_reply';\n        });\n\n        it('API payloads', function() {\n            var data = model.parse({\n                stat: 'ok',\n                my_reply: {\n                    id: 42,\n                    body_top: 'foo',\n                    body_bottom: 'bar',\n                    'public': false,\n                    body_top_text_type: 'markdown',\n                    body_bottom_text_type: 'plain',\n                },\n            });\n\n            expect(data).not.toBe(undefined);\n            expect(data.id).toBe(42);\n            expect(data.bodyTop).toBe('foo');\n            expect(data.bodyBottom).toBe('bar');\n            expect(data.public).toBe(false);\n            expect(data.bodyTopRichText).toBe(true);\n            expect(data.bodyBottomRichText).toBe(false);\n        });\n    });\n\n    describe('toJSON', function() {\n        describe('bodyTop field', function() {\n            it('With value', function() {\n                model.set('bodyTop', 'foo');\n                const data = model.toJSON();\n                expect(data.body_top).toBe('foo');\n            });\n        });\n\n        describe('bodyBottom field', function() {\n            it('With value', function() {\n                model.set('bodyBottom', 'foo');\n                const data = model.toJSON();\n                expect(data.body_bottom).toBe('foo');\n            });\n        });\n\n        describe('bodyTopRichText field', function() {\n            it('With true', function() {\n                model.set('bodyTopRichText', true);\n                const data = model.toJSON();\n                expect(data.body_top_text_type).toBe('markdown');\n            });\n\n            it('With false', function() {\n                model.set('bodyTopRichText', false);\n                const data = model.toJSON();\n                expect(data.body_top_text_type).toBe('plain');\n            });\n        });\n\n        describe('bodyBottomRichText field', function() {\n            it('With true', function() {\n                model.set('bodyBottomRichText', true);\n                const data = model.toJSON();\n                expect(data.body_bottom_text_type).toBe('markdown');\n            });\n\n            it('With false', function() {\n                model.set('bodyBottomRichText', false);\n                const data = model.toJSON();\n                expect(data.body_bottom_text_type).toBe('plain');\n            });\n        });\n\n        describe('force_text_type field', function() {\n            it('With value', function() {\n                model.set('forceTextType', 'html');\n                const data = model.toJSON();\n                expect(data.force_text_type).toBe('html');\n            });\n\n            it('Without value', function() {\n                const data = model.toJSON();\n                expect(data.force_text_type).toBe(undefined);\n            });\n        });\n\n        describe('include_text_types field', function() {\n            it('With value', function() {\n                model.set('includeTextTypes', 'html');\n                const data = model.toJSON();\n                expect(data.include_text_types).toBe('html');\n            });\n\n            it('Without value', function() {\n                const data = model.toJSON();\n                expect(data.include_text_types).toBe(undefined);\n            });\n        });\n\n        describe('public field', function() {\n            it('With value', function() {\n                model.set('public', true);\n                const data = model.toJSON();\n                expect(data.public).toBe(true);\n            });\n        });\n    });\n});\n"],"mappings":"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"}