(this.webpackJsonpui_v2=this.webpackJsonpui_v2||[]).push([[10],{1442:function(e,t,n){"use strict";n.r(t);var a=n(13),i=n.n(a),r=n(2),c=n(33),o=n(7),s=n(0),u=n(63),l=n(257),d=n(341),f=n(258),b=n(10),m=n(5),x=n(19),v=n(16),j=n(699),g=n(248),h=n(57),R=n(106),O=n(168),p=n(58),y=n(6),_=n(339),S=n(700),N=n(144),A=n(29),C=n(20),w=n(86),T=n(1);function D(e){var t,n=e.batch,a=e.index,i=e.observer,r=e.isPinned,c=e.togglePin,o=s.useRef(null);return s.useEffect((function(){o.current&&i&&i.observe(o.current)}),[i]),Object(T.jsx)(b.a,{children:Object(T.jsxs)("div",{className:"RunDetailMetricsTab__container__chartContainer","data-name":n.name,"data-context":Object(R.a)(n.context),ref:o,children:[Object(T.jsx)(_.a,{title:r?"Unpin":"Pin",children:Object(T.jsx)("div",{className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox__pin",children:Object(T.jsx)(m.c,{color:r?"primary":"default",size:"xSmall",variant:"outlined",withOnlyIcon:!0,onClick:function(){return c({name:n.name,context:n.context},r)},children:Object(T.jsx)(m.f,{name:"pin"})})})}),Object(T.jsx)("div",{className:"RunDetailMetricsTab__container__chartContainer__chartBox",children:n.iters?Object(T.jsx)(b.a,{children:Object(T.jsx)(S.a,{data:[{key:n.key,data:{xValues:Object(y.a)(n.iters),yValues:Object(y.a)(n.values)},color:"#1c2852",dasharray:"none",selectors:[n.key]}],index:a,axesScaleType:{xAxis:C.f.Linear,yAxis:C.f.Linear},ignoreOutliers:!1,highlightMode:N.a.Off,curveInterpolation:C.d.Linear})}):Object(T.jsx)(m.l,{})}),Object(T.jsxs)("div",{className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox",children:[Object(T.jsx)(m.n,{component:"h4",tint:100,size:18,weight:600,className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox__metricName",children:Object(h.a)(null===n||void 0===n?void 0:n.name)?Object(w.a)(null===n||void 0===n?void 0:n.name):null===n||void 0===n?void 0:n.name}),null===(t=Object(R.a)(null===n||void 0===n?void 0:n.context))||void 0===t?void 0:t.split(",").map((function(e,t){return Object(T.jsx)(m.b,{monospace:!0,size:"large",color:A.c[0][(t+a)%A.c[0].length],label:e||"Empty context"},t)}))]})]})})}var M=s.memo(D);function B(e){for(var t=e.runHash,n=e.runTraces,a=e.runBatch,y=e.isSystem,_=e.isRunBatchLoading,S=s.useRef(null),N=s.useRef(),A=s.useState(!1),C=Object(o.a)(A,2),w=C[0],D=C[1],B=s.useState([]),L=Object(o.a)(B,2),k=L[0],z=L[1],E=Object(l.b)(g.a,!1),H=s.useMemo((function(){return n.metric.filter((function(e){return y?Object(h.a)(e.name):!Object(h.a)(e.name)}))}),[n.metric,y]),I=[],P=[],q=function(e){var t,n,a=H[e],i=null!==(t=null===E||void 0===E||null===(n=E.pinnedSequences)||void 0===n?void 0:n.findIndex((function(e){return e.name===a.name&&Object(R.a)(e.context)===Object(R.a)(a.context)})))&&void 0!==t?t:-1;i>-1?I[i]=a:P.push(a)},F=0;F<H.length;F++)q(F);function K(e,t){return V.apply(this,arguments)}function V(){return(V=Object(c.a)(i.a.mark((function e(t,n){var a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n?I.filter((function(e){return!(e.name===t.name&&Object(R.a)(e.context)===Object(R.a)(t.context))})):[].concat(I,[t]),r=g.a.setPinnedSequences({sequences:a},(function(e){g.a.setState({pinnedSequences:I}),Object(p.a)({detail:e,model:j.a})})),g.a.setState({pinnedSequences:a}),r.call();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){return w&&e.length>0&&Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("div",{className:"RunDetailMetricsTab__header",children:Object(T.jsxs)(m.n,{component:"h3",size:16,color:"primary",children:[t?"Pinned ":"","Metrics"]})}),Object(T.jsx)("div",{className:"RunDetailMetricsTab__container",children:(t?e:e.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{sortKey:"".concat(e.name,"_").concat(Object(R.a)(e.context))})})).sort(Object(O.a)({orderBy:"sortKey"}))).map((function(e,n){var i=Object(r.a)(Object(r.a)({},e),null===a||void 0===a?void 0:a.find((function(t){return t.name===e.name&&Object(R.a)(t.context)===Object(R.a)(e.context)})));return Object(T.jsx)(M,{batch:i,index:n,observer:N.current,isPinned:t,togglePin:K},"".concat(i.name,"_").concat(Object(R.a)(i.context)))}))})]})}return I.filter((function(e){return!!e})),s.useEffect((function(){if(S.current){var e,t={root:null===(e=S.current.parentElement)||void 0===e?void 0:e.parentElement,rootMargin:"0px",threshold:0};N.current=new IntersectionObserver((function(e){var t=[];e.forEach((function(e){if(e.isIntersecting){var n=e.target.getAttribute("data-name"),i=e.target.getAttribute("data-context");(null===a||void 0===a?void 0:a.find((function(e){return e.name===n&&Object(R.a)(e.context)===i})))||t.push({name:n,context:i})}})),t.length>0&&z((function(e){return e.concat(t.map((function(e){return H.find((function(t){return t.name===e.name&&Object(R.a)(t.context)===e.context}))})))}))}),t),D(!0)}return v.a(x.a.runDetails.tabs[y?"system":"metrics"].tabView),function(){N.current&&N.current.disconnect()}}),[y,a,w,n.metric,H]),s.useEffect((function(){var e,n;return k.length>0&&(e=window.setTimeout((function(){(n=j.a.getRunMetricsBatch(k,t)).call()}),100)),function(){e&&clearTimeout(e),n&&n.abort()}}),[k,t]),s.useEffect((function(){z((function(e){return e.filter((function(e){return-1===a.findIndex((function(t){return t.name===e.name&&Object(R.a)(t.context)===Object(R.a)(e.context)}))}))}))}),[a]),Object(T.jsx)(b.a,{children:Object(T.jsx)(f.a,{isLoading:_,className:"runDetailParamsTabLoader",height:"100%",children:u.a.isEmpty(H)?Object(T.jsx)(d.a,{size:"xLarge",className:"runDetailParamsTabLoader",title:"No tracked ".concat(y?"system":""," metrics")}):Object(T.jsxs)("div",{className:"RunDetailMetricsTab",ref:S,children:[J(I,!0),J(P,!1)]})})})}t.default=s.memo(B)},675:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=100,i={S:4,M:6,L:12},r=i.S,c=i.M,o={1:[i.L],2:[c,c],3:[r,r,r],4:[c,c,c,c],5:[r,r,r,c,c],6:[r,r,r,r,r,r],7:[r,r,r,c,c,c,c],8:[r,r,r,r,r,r,c,c],9:[r,r,r,r,r,r,r,r,r]}},700:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(17),c=n.n(r),o=n(257),s=n(10),u=n(675),l=n(20),d=(n(701),n(1)),f=i.a.forwardRef((function(e,t){var n=e.data,a=e.index,r=void 0===a?0:a,f=e.nameKey,b=void 0===f?"":f,m=e.aggregatedData,x=e.aggregationConfig,v=e.syncHoverState,j=e.axesScaleType,g=e.axesScaleRange,h=e.ignoreOutliers,R=e.alignmentConfig,O=e.highlightMode,p=e.curveInterpolation,y=e.chartTitle,_=e.zoom,S=e.onZoomChange,N=e.readOnly,A=void 0!==N&&N,C=e.resizeMode,w=i.a.useRef({margin:{top:30,right:20,bottom:30,left:60},height:0,width:0}),T=i.a.useRef({height:0,width:0}),D=i.a.useRef(null),M=i.a.useRef(null),B=i.a.useRef(null),L=i.a.useRef(null),k=i.a.useRef(null),z=i.a.useRef(null),E=i.a.useRef(null),H=i.a.useRef(null),I=i.a.useRef(null),P=i.a.useRef(null),q=i.a.useRef(null),F=i.a.useRef({}),K=i.a.useRef({}),V=i.a.useRef({}),J=i.a.useRef({}),Z=i.a.useRef(),U=[];function G(){Object(l.h)({visAreaRef:M}),function(){Object(l.i)({index:r,nameKey:b,visBoxRef:w,plotBoxRef:T,parentRef:D,visAreaRef:M,svgNodeRef:B,bgRectNodeRef:L,plotNodeRef:k,axesNodeRef:z,linesNodeRef:E,attributesNodeRef:H,chartTitle:y});var e=Object(l.y)({data:n,ignoreOutliers:h,visBoxRef:w,axesScaleType:j,axesScaleRange:g,aggregatedData:m,aggregationConfig:x,unableToDrawConditions:U,attributesRef:V}),t=e.processedData,a=e.processedAggrData,i=e.min,c=e.max;Object(l.j)({svgNodeRef:B,axesNodeRef:z,axesRef:F,plotBoxRef:T,xScale:V.current.xScale,yScale:V.current.yScale,visBoxRef:w,alignmentConfig:R,axesScaleType:j,humanizerConfigRef:J,drawBgTickLines:{y:!0,x:!1}}),Object(l.m)({index:r,processedData:t,nameKey:b,linesNodeRef:E,linesRef:K,curveInterpolation:p,xScale:V.current.xScale,yScale:V.current.yScale,highlightMode:O,aggregationConfig:x,processedAggrData:a,readOnly:A}),!A&&E.current&&E.current.selectChildren().size()>u.c&&E.current.classed("optimizeRendering",!0),A||Object(l.l)({index:r,nameKey:b,data:n,axesScaleType:j,highlightMode:O,syncHoverState:v,visAreaRef:M,attributesRef:V,plotBoxRef:T,visBoxRef:w,svgNodeRef:B,bgRectNodeRef:L,attributesNodeRef:H,xAxisLabelNodeRef:I,yAxisLabelNodeRef:P,linesNodeRef:E,highlightedNodeRef:q,aggregationConfig:x,alignmentConfig:R}),Object(l.k)({index:r,plotBoxRef:T,plotNodeRef:k,visBoxRef:w,axesRef:F,attributesRef:V,linesRef:K,svgNodeRef:B,axesScaleType:j,min:i,max:c,axesScaleRange:g,zoom:_,onZoomChange:S,readOnly:A,unableToDrawConditions:U}),Object(l.u)({renderArr:U,visAreaRef:M,attributesRef:V,readOnly:A,syncHoverState:v})}()}var Q=i.a.useCallback((function(e){(null===e||void 0===e?void 0:e.length)&&(Z.current=window.requestAnimationFrame(G))}),[n,_,h,O,j,g,p,x,A,R,C]),W=i.a.useCallback((function(){Z.current&&window.cancelAnimationFrame(Z.current)}),[]);return Object(o.d)(Q,D,W),i.a.useEffect((function(){return Z.current=window.requestAnimationFrame(G),function(){Z.current&&window.cancelAnimationFrame(Z.current)}}),[n,_,h,O,j,g,p,x,A,R,C]),i.a.useImperativeHandle(t,(function(){return{setActiveLineAndCircle:function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null===(t=(n=V.current).setActiveLineAndCircle)||void 0===t||t.call(n,e,a,i)},updateHoverAttributes:function(e,t){var n,a;null===(n=(a=V.current).updateHoverAttributes)||void 0===n||n.call(a,e,t)},clearHoverAttributes:function(){var e,t;null===(e=(t=V.current).clearHoverAttributes)||void 0===e||e.call(t)},setFocusedState:function(e){V.current.focusedState=e}}})),Object(d.jsx)(s.a,{children:Object(d.jsx)("div",{ref:D,className:c()("LineChart",{zoomMode:!A&&(null===_||void 0===_?void 0:_.active)}),children:Object(d.jsx)("div",{ref:M})})})}));f.displayName="LineChart",t.a=i.a.memo(f)},701:function(e,t,n){}}]);
//# sourceMappingURL=RunDetailMetricsAndSystemTab.js.map?version=2511adf2490328d7dd60