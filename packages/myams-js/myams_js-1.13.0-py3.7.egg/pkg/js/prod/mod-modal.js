!function(a,e){"function"==typeof define&&define.amd?define(["exports"],e):"undefined"!=typeof exports?e(exports):(e(e={}),a.modModal=e)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.modalToggleEventHandler=t,a.modalShownEventHandler=n,a.dynamicModalShowEventHandler=l,a.dynamicModalShownEventHandler=m,a.modalDismissEventHandler=o,a.modalHiddenEventHandler=d,a.dynamicModalHiddenEventHandler=u,a.modal=void 0;var s=MyAMS.$,e=!1;function t(o){return new Promise(function(a,e){var t=s(o.currentTarget),n=t.data("ams-disabled-handlers");!t.attr("disabled")&&!t.hasClass("disabled")&&!0!==n&&"click"!==n&&"all"!==n&&!0!==t.data("ams-context-menu")?(!0===t.data("ams-stop-propagation")&&o.stopPropagation(),o.preventDefault(),t.tooltip("hide"),MyAMS.modal.open(t).then(function(){a(!0)},e)):a(!1)})}function n(a){var a=s(a.target),e=1100+100*s(".modal:visible").length;a.css("z-index",e),setTimeout(function(){s(".modal-backdrop").not(".modal-stack").first().css("z-index",e-10).addClass("modal-stack")},0),s(a).off("click",'[data-dismiss="modal"]').on("click",'[data-dismiss="modal"]',function(a){var e=s(a.currentTarget).data("ams-dismiss-handler")||o;return MyAMS.core.executeFunctionByName(e,document,a)})}function l(a){a=s(a.target);return MyAMS.core.executeFunctionByName(a.data("ams-init-content")||MyAMS.config.initContent,document,a)}function m(t){return new Promise(function(e,a){MyAMS.require("form").then(function(){var a=s(t.target);MyAMS.form.setFocus(a),e(a)},a)})}function o(n){return new Promise(function(a,e){var t=s(n.currentTarget).parents(".modal").first();t.data("modal-result",s(n.currentTarget).data("modal-dismiss-value")),MyAMS.form?MyAMS.form.confirmChangedForm(t).then(function(a){"success"===a&&t.modal("hide")}).then(a,e):(t.modal("hide"),a())})}function d(){0<s(".modal:visible").length&&(s.fn.modal.Constructor.prototype._checkScrollbar(),s.fn.modal.Constructor.prototype._setScrollbar(),s("body").addClass("modal-open"))}function u(a){var e=s(a.target);MyAMS.core.executeFunctionByName(e.data("ams-clear-content")||MyAMS.config.clearContent,document,e).then(function(){!0===e.data("dynamic")&&e.remove()})}var r={init:function(){e||(e=!0,MyAMS.config.ajaxNav&&s(document).off("click",'[data-toggle="modal"]').on("click",'[data-toggle="modal"]',function(a){a.stopPropagation();var e=s(a.currentTarget).data("ams-modal-handler")||t;MyAMS.core.executeFunctionByName(e,document,a)}),s(document).on("shown.bs.modal",".modal",function(a){var e=s(a.currentTarget).data("ams-shown-handler")||n;MyAMS.core.executeFunctionByName(e,document,a)}),s(document).on("hidden.bs.modal",".modal",function(a){var e=s(a.currentTarget).data("ams-hidden-handler")||d;MyAMS.core.executeFunctionByName(e,document,a)}))},open:function(c,n){return new Promise(function(t,a){var r={},i=c;"string"!=typeof c&&(r=c.data(),i=c.attr("href")||r.amsUrl);var e=MyAMS.core.getFunctionByName(i);"function"==typeof e&&(i=e(c)),i||a("No provided URL!"),i.startsWith("#")?(s(i).modal("show"),t()):s.ajax({type:"get",url:i,cache:void 0!==r.amsAllowCache&&r.amsAllowCache,data:n}).then(function(a,e,o){var d=null;MyAMS.require("ajax").then(function(){var a,e=MyAMS.ajax.getResponse(o),t=e.contentType,n=e.data;switch(t){case"json":MyAMS.ajax.handleJSON(n,s(s(c).data("ams-json-target")||"#content"));break;case"script":case"xml":break;case"html":case"text":default:a=s(n),n={backdrop:void 0===(t=(e=s(".modal-dialog",a.wrap("<div></div>").parent())).data()||{}).backdrop?"static":t.backdrop,keyboard:void 0===t.keyboard||t.keyboard},n=s.extend({},n,t.amsOptions),n=MyAMS.core.executeFunctionByName(t.amsInit,e,n)||n,d=s("<div>").addClass("modal fade").attr("tabIndex","-1").data("dynamic",!0).append(a).on("show.bs.modal",l).on("shown.bs.modal",m).on("hidden.bs.modal",u).modal(n),MyAMS.stats&&!1!==r.amsLogEvent&&!1!==t.amsLogEvent&&MyAMS.stats.logPageview(i)}}).then(function(){t(d)})})})},close:function(a){"string"==typeof a?a=s(a):void 0===a&&(a=s(".modal-dialog:last"));a=a.objectOrParentWithClass("modal");0<a.length&&a.modal("hide")}};a.modal=r,MyAMS.env.bundle?MyAMS.config.modules.push("modal"):(MyAMS.modal=r,console.debug("MyAMS: modal module loaded..."))});