{"version":3,"file":"listEditViewTests.js","names":["suite","formTemplate","_","template","makeView","items","attrs","length","$el","$","nonZeroItems","filter","i","appendTo","$testsScratch","view","Djblets","Forms","ListEditView","el","inputAttrs","sep","render","describe","it","$valueField","expect","val","toEqual","blur","$inputs","eq","click","$input","attr","prop","toBe"],"sources":["listEditViewTests.es6.js"],"sourcesContent":["suite('djblets/forms/views/ListEditView', function() {\n    /*\n     * See templates/djblets_forms/list_edit_widget.html.\n     */\n    const formTemplate = _.template(dedent`\n        <div class=\"djblets-c-list-edit-widget\">\n         <ul class=\"djblets-c-list-edit-widget__entries\">\n          <% if (items.length > 0) { %>\n           <% items.forEach(function(item, i) { %>\n            <li class=\"djblets-c-list-edit-widget__entry\"\n                data-list-index=\"<%- i %>\">\n             <input value=\"<%- item %>\" type=\"text\"<%= attrs %>>\n             <a href=\"#\" class=\"djblets-c-list-edit-widget__remove-item\"></a>\n            </li>\n           <% }); %>\n          <% } else { %>\n           <li class=\"djblets-c-list-edit-widget__entry\" data-list-index=\"0\">\n            <input type=\"text\">\n            <a href=\"#\" class=\"djblets-c-list-edit-widget__remove-item\"></a>\n           </li>\n          <% } %>\n         </ul>\n         <button class=\"djblets-c-list-edit-widget__add-item\"></button>\n         <input class=\"djblets-c-list-edit-widget__value\"\n                type=\"hidden\" value=\"<%- nonZeroItems.join(',') %>\">\n        </div>\n    `);\n\n    const makeView = function makeView(items=[], attrs='') {\n        attrs = attrs.length ? ` ${attrs}` : '';\n        attrs = `${attrs} class=\"djblets-c-list-edit-widget__input\"`;\n\n        const $el =\n            $(formTemplate({\n                items: items,\n                nonZeroItems: items.filter(i => (i.length > 0)),\n                attrs: attrs,\n            }))\n            .appendTo($testsScratch);\n\n        const view = new Djblets.Forms.ListEditView({\n            el: $el,\n            inputAttrs: attrs,\n            sep: ',',\n        });\n\n        view.render();\n\n        return [view, view.$('.djblets-c-list-edit-widget__value')];\n    };\n\n    describe('Updating fields', function() {\n        it('With no values', function() {\n            const [, $valueField] = makeView([]);\n            expect($valueField.val()).toEqual('');\n        });\n\n        it('With one value', function() {\n            const [view, $valueField] = makeView(['One']);\n\n            expect($valueField.val()).toEqual('One');\n\n            view.$('.djblets-c-list-edit-widget__input').val('Foo').blur();\n            expect($valueField.val()).toEqual('Foo');\n        });\n\n        it('With multiple values', function() {\n            const [view, $valueField] = makeView(['one', 'two', 'three']);\n            const $inputs = view.$('.djblets-c-list-edit-widget__input');\n\n            expect($valueField.val()).toEqual('one,two,three');\n\n            $inputs.eq(2).val('baz').blur();\n            expect($valueField.val()).toEqual('one,two,baz');\n\n            $inputs.eq(0).val('').blur();\n            expect($valueField.val()).toEqual('two,baz');\n\n            $inputs.eq(1).val('').blur();\n            expect($valueField.val()).toEqual('baz');\n\n            $inputs.eq(2).val('').blur();\n            expect($valueField.val()).toEqual('');\n        });\n    });\n\n    describe('Removal', function() {\n        it('With no values', function() {\n            const [view, $valueField] = makeView([]);\n\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n\n        it ('With one value', function() {\n            const [view, $valueField] = makeView(['One']);\n            expect($valueField.val()).toEqual('One');\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n\n        it('With multiple values', function() {\n            const [view, $valueField] = makeView(['One', 'Two', 'Three']);\n\n            expect($valueField.val()).toEqual('One,Two,Three');\n\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(3);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').eq(1).click();\n            expect($valueField.val()).toEqual('One,Three');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(2);\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(2);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').eq(1).click();\n            expect($valueField.val()).toEqual('One');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(1);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n    });\n\n    describe('Addition', function() {\n        it('With values', function() {\n            const [view, $valueField] = makeView(['one', 'two', 'three']);\n            expect($valueField.val()).toEqual('one,two,three');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            expect($valueField.val()).toEqual('one,two,three');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(4);\n\n            view.$('.djblets-c-list-edit-widget__input').eq(3)\n                .val('four')\n                .blur();\n            expect($valueField.val()).toEqual('one,two,three,four');\n        });\n\n        it('With blank values', function() {\n            const [view, $valueField] = makeView(['', '', '']);\n            expect($valueField.val()).toEqual('');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(4);\n\n            view.$('.djblets-c-list-edit-widget__input').eq(3)\n                .val('four')\n                .blur();\n            expect($valueField.val()).toEqual('four');\n        });\n\n        it('With correct attributes', function() {\n            const [view,] = makeView([], 'size=\"100\" readonly');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            const $input = view.$('input').eq(1);\n            expect($input.attr('size')).toEqual('100');\n            expect($input.prop('readonly')).toBe(true);\n        });\n    });\n});\n"],"mappings":"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"}