# 四、短期和长期游戏攻击策略

Gavin Watson，random storm 有限公司高级安全工程师

拥有大量时间和资源的攻击者使用的技术和方法，与有严格时间限制的渗透测试人员使用的技术和方法有很大的不同。这两种类型的技术识别客户端安全控制中非常不同的漏洞。面临的挑战是，当只能采用短期技术时，如何在严格的时间框架内为客户提供价值，以及如何帮助客户抵御无法实际模拟的长期技术。本章不仅详细讨论了这些问题，还提供了克服这些问题的实用建议。

### 关键词

短期攻击策略；长期攻击策略；虚假的社交媒体资料；信息诱导；扩展的网络钓鱼攻击；瞄准伙伴公司；长期监视

本章中的信息

短期攻击策略

瞄准正确的领域

有效利用分配的时间

常见的短游戏场景

长期攻击策略

扩展初始侦察

虚假的社交媒体资料

信息诱导

扩展网络钓鱼攻击

获得内部帮助

在目标公司工作

瞄准合作伙伴公司

长期监控

## 介绍

在第三章中，读者了解了一些最常见的社会工程技术。

选择使用哪种技术和一般策略通常取决于攻击可用的时间。一般来说，现实世界中的攻击会持续很长时间。攻击者仔细计划他们的方法，在几周、几个月甚至几年内使用各种技术。然而，由安全顾问执行的社会工程评估通常有非常严格的时间框架。这种有限的时间通常会限制方法、可以采用的技术以及可以执行的程度。

当只有有限的时间和资源可用时，将讨论最合适的策略。此外，还涵盖了有关时间管理和确保价值的最有效方法，包括一些最常见的“短期游戏”攻击场景。

本章将讨论“长期博弈”的攻击策略和技术。这将包括假冒社交媒体个人资料、长期网络钓鱼攻击和长期监控等主题。

## 短期攻击策略

“短期游戏”策略围绕着严格的测试参数，通常由预算限制(如果评估是代表客户进行的)或其他关于实用性的一般原因(如目标仅在有限的时间内可用)来定义。这种策略通常与专业的社会工程评估联系在一起，咨询师试图在短短几天内为客户提供尽可能多的价值。这是安全公司面临的最大挑战，为客户提供真正的价值。我们所说的“价值”是指客户的主要交付成果，即报告，可以用来实际提高安全性，并产生真正的、可衡量的影响。如果进行了技术基础设施评估，客户会期望得到一份按严重程度排列的已识别漏洞的全面报告，社会工程评估也不例外。

如果顾问采用真实世界攻击者的方法，但只限于几天，那么报告可能只包含从公共资源收集的证据。原因是现实世界中的攻击者会花好几个月的时间来研究目标。这本身可能会让客户非常感兴趣，因为他们可能不知道他们的公司和员工有哪些潜在的敏感信息。但是，这可能无法解决公司面临的最大风险。因此，通过解决真正的风险并充分利用可用的时间，有机会为客户提供更大的价值。

### 瞄准正确的区域

有限的时间框架的一个不幸的副作用是让没有经验的安全顾问“砸了就抢”他们会忽略威胁建模，因此不会计划任何与公司实际风险无关的事情([第 6 章](06.html)更详细地介绍了威胁建模过程)。在有限的时间内，他们会在进出时以任何可能的方式(通常是通过尾随)违反安全措施来逃避检测，然后认为目标已经达到。由此产生的报告只是一个“快照”，预测他们“如果是真正的攻击者，可能会做些什么”。这导致客户端基于猜测实现对策。类似地，一些安全公司会只锁定一个员工来获取敏感信息。然后，报告详细描述了这个特定的个体是如何容易受到一些基于伪科学的心理脆弱的影响的。偶尔，这种类型的方法可能是有益的，并且可能是客户实际请求的，但是它仅仅强调了一小组漏洞，甚至仅仅是“可能的”单点故障。不幸的现实是，很多测试公司都是这样工作的。由于“闯入”的范围似乎是无限的，所以每次执行测试时，他们将不可避免地暴露一两个新的漏洞。这种类型的动态测试可能会无限期地进行下去，并且永远不会突出客户真正需要了解的问题。这就像渗透测试人员在每次执行测试时识别一台服务器上的一个漏洞。这显然是一种低效的方法，并且最终无法突出企业的真正弱点。

测试公司以这种方式工作的一个原因是，太多的客户对评估应该如何进行缺乏了解。这主要是因为社会工程评估仍然“相对”不为人知。客户对基础设施测试或 web 应用测试等标准测试有一定的期望，但仍然倾向于期待测试公司指导他们完成社会工程测试。因此，可能会进行不合标准的测试，而客户对此一无所知。如果顾问设法轻易地破坏了公司的安全，那么客户往往会认为顾问做得很好。此外，当将这些发现提交给高层管理人员时,“恐惧因素”倾向于转移对测试是否真正揭示了任何有价值的东西或任何实际上可以修复的东西的问题的注意力。

假设一家企业决定雇佣安全顾问来测试他们对社会工程的敏感度。顾问们圆滑地谈论过去的接待，依附于公司网络并提升他们的特权。他们设法带着笔记本电脑上的客户数据库离开了大楼。管理团队的反应是震惊和恐惧。管理团队会提出诸如“如果一个真正的攻击者要这么做呢？对我们声誉的损害可能会使业务瘫痪，更不用说敏感信息的丢失了！”。然后，企业遵循测试公司的所有建议，从实现员工意识培训到改进物理和技术安全控制。就在第二天，社会工程师穿着送货司机的服装，带着所有有效的证件，来到同一栋大楼后面的仓库。他们和仓库工作人员聊天，把货物装上卡车，平安无事地开走了。最初的社会工程测试强调了一系列“可能的”事件，这些事件可能会损害企业，但可能性不大。社会工程师闯入大楼窃取客户数据库的几率相对较低。然而，考虑到该公司存储的货物的价值，该公司被盗的风险相对较高。如果测试公司和企业进行了威胁建模，仓库盗窃的潜在威胁就会被强调出来。社会工程不仅仅是破坏建筑和网络，而是破坏一般的安全。这并不是说最初的社会工程测试完全是浪费时间，只是说这些努力本可以优先用于其他地方。测试的目的应该是识别仓库程序和意识培训中的漏洞。一旦评估了最重要的风险，就可以检查较低的风险。

### 有效利用分配的时间

当给你一个小的测试机会时，你必须尽可能有效地利用时间。亚伯拉罕·林肯曾说过一句非常恰当的话来总结这一点:

如果我有八个小时砍树，我会花六个小时磨利我的斧头。

当涉及到社会工程时，这意味着你要花费绝大部分时间进行侦察，而执行实际攻击的时间要少得多。对于现实世界中的犯罪攻击，这是极其重要的。如果你正在攻击一家企业，你可能只有一次机会，因为重复攻击增加了被抓住的可能性。

关于专业社会工程评估的时间分配有点复杂。如果客户要求您识别一个特定的漏洞，则上述内容适用。然而，评估通常侧重于多个领域，使用不同的场景来识别不同的漏洞，并且可能必须在相同的时间窗口内重复进行。

最初的客户联系、范围界定会议、威胁建模和关于参与规则的讨论在测试窗口之外进行。然而，这些是奠定评估基础的关键阶段。测试期应包括四个基本阶段，即:

1.侦察

2.场景创建

3.场景执行

4.报告写作

基本攻击，如通过电话获取特定信息的攻击，也可能遵循这种结构。然而，更复杂的任务，比如破坏建筑安全，不一定要按这个顺序执行。侦察可能导致最初的攻击，然后将信息反馈给侦察，以帮助设计新的攻击。为了实现有效的时间分配，您需要完全了解您计划执行的项目的流程。此外，如果您的任务是评估多种攻击媒介的安全性，那么理解它们之间的关系就很重要。

一种方法是将攻击媒介串在一起。例如，最初的侦察可能会提供启动基本网络钓鱼和电话攻击所需的信息。这些攻击的结果可能有助于有针对性的攻击，例如鱼叉式网络钓鱼电子邮件。从有针对性的攻击中获得的敏感信息可用于设计针对建筑物的物理攻击场景。通过将每个攻击媒介的结果反馈给下一个，您可以有效地利用时间，同时覆盖多个领域。这种方法的每个阶段都可以用时间来表示一天。因此，一个完整的评估可能只需要 5 天，最后一天留给写报告。然而，尽管这是一种有效的工作方式，但它只能识别出这种顺序攻击策略导致的漏洞。例如，它不能真实地模拟攻击者针对单一攻击媒介的策略。如果攻击者无意破坏建筑物的安全，只想通过电话获取敏感信息，那么他们可能会使用非常不同的技术来达到不同的目的。如果要评估单独的向量，那么应该单独处理它们，为它们分配单独的侦察和场景执行时间。因此，评估所有三个主要媒介可能需要 9 天的评估时间，包括报告撰写时间。

如果客户没有预算限制，并且要求评估时间跨越数周或数月，那么两种方法都可以采用。单个攻击媒介可以通过多个目标进行评估，这些目标旨在单独评估媒介，并作为字符串攻击策略的一部分。

你分配时间的方式最终取决于客户的需求。他们是想模拟真实世界的攻击，还是想专注于单个安全领域？在评估开始之前，需要询问和回答这些问题。

### 常见的短游戏场景

有一些“小游戏”场景经常用于测试常见的安全问题。这些场景只需要少量的规划，如果执行成功，可以识别多个漏洞，确保在有限的时间内为客户带来最大的价值。

这些场景应被视为针对常见社会工程漏洞的“通用”方法，然后可以根据客户的要求进行定制。然而，最好的方法总是根据威胁建模阶段的结果从头开始设计您的场景。

在与客户进行初始范围界定会议时，我们经常使用这些示例。它们有助于解释评估的总体方法，以及场景如何针对特定的安全领域。

**密码重置程序**
联系目标企业的帮助台(或 IT 部门)并冒充员工请求重置密码。根据随后的密码重置程序调整方法以识别其他漏洞。
可能的借口:

首席执行官对自己的密码不再有效感到愤怒，需要尽快重设密码。

一位新用户正在努力登录这项服务，虽然给了他一个密码，但却无法登录。

一名员工解释说，一名同事破解了他们的密码，因为密码太明显了，他们能重新设置一个更复杂的密码吗？

**访客/承包商预约程序**
联系目标企业的主接待，安排承包商参观现场。
可能的借口:

" *一名 IT 工程师要去现场安装一些设备，你能确保他签到并有出入大楼的通行证吗？*

" *另一个工厂的一位同事马上就要到了，我不能见他们，你能让他们去一个空闲的会议室吗？*

" *一位潜在员工要来参加一个工作面试，你能告诉他 IT 部门的方向吗？*

**【电话调查政策(信息披露政策)**
联系声称正在进行调查的目标企业员工。在调查中纳入揭示业务关键信息的问题。
可能的借口:

作为工作满意度研究项目的一部分，一名大学生正在进行一项电话调查。

一项关于工作场所社交媒体的商会调查。

主要公用事业公司正在对该地区的服务表现进行调查。

**网络钓鱼电子邮件意识和培训**
广泛的网络钓鱼电子邮件旨在诱骗用户浏览恶意网站。
可能的借口:

IT 部门收到了电子邮件帐户被锁定的报告，请所有用户确保他们仍然可以使用以下链接访问服务。

公司网站进行了一些重大更改，请所有用户确保他们可以使用以下链接正确查看。

最近的一篇新闻报道中提到了这项业务。请点击下面的链接查看。

新的内部网服务即将推出，为确保您继续获得全面完整的服务，请点击以下链接注册您的详细信息。

**尾随/捎带意识和培训**
试图跟随合法员工进入大楼或限制区域。请记住，这种方法应该在最后尝试，永远不应该成为整个攻击的基础。
可能的场景:

跟随员工进入工作场所之前，在吸烟区与他们聊天。

在电话中模拟一场争论，阻止人们挑战你。拿一个大物件，鼓励员工把门打开。

为了确保您在严格的时间框架内收集尽可能多的有价值的信息，请确保您能够回答以下基本问题。

**程序**

是否有员工需要遵守的程序？

是否可以通过任何方式规避这些程序？如果是，如何做到？

不同的服务台助理遵循不同的程序吗？

为了提高安全性，可以对程序进行哪些改进？

**政策**

公司是否有与评估目标相关的政策？

是否定期让所有员工了解并提醒他们这些政策？

不同的员工对政策内容的理解是否不同？

是否可以通过任何方式规避该政策？如果是，如何做到？

为了提高安全性，可以对策略进行哪些改进？

**员工意识和培训**

企业是否有员工意识和培训计划？

评估目标主题是否包含在认知和培训计划中？

如何改进当前的计划？

**一般信息**

如果攻击者成功利用该漏洞，最坏的情况是什么？

哪些支持性的社会工程技术会显著影响成功率？

## 长期攻击策略

“长期博弈”策略和技术是那些跨越数周、数月甚至数年的策略和技术。这些策略和技术对于专业的安全评估来说并不完全实用，并且通常局限于现实世界的攻击领域。

当你拥有几乎无限的时间和资源时，你可以采用“长期博弈”技术，以最小的风险实现困难的目标。例如，给目标打电话试图获取他们的计算机登录密码会带来一些风险。相比之下，在马路对面用望远镜或双筒望远镜观察受害者的电脑屏幕和键盘可以达到同样的目的，但被抓住的总体风险要小得多。

使用“长期博弈”技术的另一种方式是将“短期博弈”技术分成更小的部分或阶段，以避免被发现。例如，一封旨在获取敏感信息的鱼叉式网络钓鱼电子邮件，如果收件人发现了它的真实面目，就会发出警报。然而，在一段时间内发送一系列看似无害的电子邮件可以获得相同的信息，而不会引起太多的怀疑。

随着时间的推移而扩散的“长期游戏”攻击还有一个额外的特点，即创造熟悉感。例如，如果你有时间在一个地区被保安长时间多次看到，那么过一会儿他们就会认为你是属于他们的，不太可能挑战你。

延长执行攻击的时间开辟了一个全新的技术和策略范围，实现目标通常是不可避免的。

### 扩展初始侦察

良好侦察的重要性是贯穿本书的一个反复出现的主题。侦察力度越大，攻击成功的几率就越大。对于大多数社会工程攻击来说，某些信息是至关重要的，这些信息通常构成了短游戏技术的基础。这些信息包括潜在目标的姓名和联系方式。如果你有无限的时间来执行侦察，还有哪些信息会有用？这个问题的简短答案是:任何被认为有用的信息。然而，一些类型的信息比其他的更有用。如果你能够扩展你的研究，你应该能够收集到对你的攻击有重大支持作用的信息。

最初的侦察应该会发现大量的潜在目标，包括他们的姓名、位置和联系方式。这通常是在短游戏攻击场景中收集的唯一信息。如果攻击者想要向公司发送网络钓鱼电子邮件，他们可能只需要电子邮件地址。但是，每个员工都有一生的有用信息，这些信息可能会被用来专门针对他们或针对他们工作的公司。如果你可以通过社交媒体或与他们建立关系来获取这些信息，那么你就可以用这些信息来对付他们。

如果您想对个人而不是群体进行有针对性的攻击，那么可以考虑获取以下信息:

兴趣和爱好

以前的雇主

教育历史

最近的假期

亲密的朋友

家人

他们所属的团体和俱乐部

他们经常去哪里购物

他们住在哪里

他们有哪些公用事业供应商

他们在谁的银行存款

他们开什么车

下面几节将探讨获取这些信息的方法。在这里，我们只是对如何使用它感兴趣。

上面的列表看起来都是无关痛痒的信息，但是它们都可以作为攻击的基础，或者只是用来获得可信度。让我们来看看其中的一些，以确定如何利用它们。

知道目标上过某所学校可能是成功实现鱼叉式网络钓鱼攻击的全部要求。例如，电子邮件可能会这样写:

你好，

我们正在组织 xyz 高中 1978 届的同学聚会，希望你能参加。

我们在[http://www.fakehighschoolreunionwebsite.com](http://www.fakehighschoolreunionwebsite.com)上设立了一个账户，你可以在那里回复。此外，我们还上传了当时每个人的一些精彩照片。

抱歉，如果你们中的任何人觉得他们尴尬！

希望尽快收到你的来信！

另一种电子邮件网络钓鱼攻击可能仅仅基于他们经常购物的地方。例如，您可以将恶意 PDF 附加到电子邮件中，并发送以下内容:

Xyz 商店现在提供所有产品高达 50%的折扣！打印出随附的凭证，并随身携带到商店。

假设你了解到目标客户最近去过的一个假期，以及他们和谁订了房。考虑冒充旅行社，通过电话联系目标，解释:

我们刚刚推出了一个报价，其中包括您最近接受的一揽子交易。如果你愿意现在就付订金，明年再预订，我们会给你 25%的折扣。

如果受害者同意，攻击者就会通过电话询问他们的卡的详细信息来收取押金。

我们已经讨论过将侦察扩展到企业的员工。业务本身呢？通常的“短游戏”信息收集的是商业地址、建筑布局、外部安全、内部安全、商业目的等。然而，以类似于调查员工个人生活的方式，你可以继续研究业务的其他方面。例如，您可以扩展您的侦察范围，以包括以下内容:

商业历史

过去的成功

过去的失败

商业前景

提议的合并

一般策略

合作公司

招聘流程

商业文化

你收集的信息越多，你的攻击就越有可能成功。

### 虚假的社交媒体资料

上一节讨论了收集目标的个人生活信息，以便攻击他们工作的企业。大量这类信息可以从社交媒体网站上收集，因为它们本质上是我们生活的数据库。如今，从社交媒体网站中提取这种潜在敏感信息通常更加困难，主要是因为安全控制越来越多。为了访问你想要的信息，你首先必须与目标相关联，无论是作为“朋友”还是与社交媒体网站相关联的某种其他类型的符号链接。通常，这需要在建立链接之前进行请求和确认阶段。不幸的是，几乎没有安全措施来防止虚假的社交媒体资料。因此，攻击者可以创建一个假的配置文件来与受害者建立联系。一旦建立了联系，就可以从受害者的账户中搜集有用的信息。

社交媒体只能用作信息来源，应注意不要让社会工程师陷入陷阱。

之所以认为这是一个“长期游戏”策略，是因为它可以花大量的时间来开发一个假账户。该帐户是令人信服的，它需要详细的个人资料信息，职位，照片和与其他帐户的链接。没有长时间生成的基本内容，创建一个令人信服的假账户是一项挑战。此外，目标可能不一定会定期查看他们的社交媒体账户，或者直接回复链接请求。

创建虚假社交媒体账户有许多不同的方法:

**诱饵账户**
这是专业安全顾问可能已经准备好用于评估的最常见的账户类型。他们被设计成一大群目标的诱饵。例如，简档图像可以是年轻漂亮女孩的图像，针对企业的男性目标，反之亦然。快速而简单的最后一分钟的改变可以是到所参加的中学，以匹配链接请求被发送到的受害者。由于这些类型的账户往往是预先准备好的，因此这可以被视为一种“短线游戏”技巧。然而，这些帐户往往非常通用，因此很难使用这些帐户来锁定特定的个人或组织。

**定向账户**
这些账户通常是根据收集到的侦察信息，针对特定个人定制的。例如，你可能在公司网站上读到过最近的一次员工社交活动。可以创建假账户来匹配该企业员工的账户。对目标的链接请求可以附带一条消息，说:“*你好，上周在慈善活动上和你说过话……真不敢相信我们筹到了这么多钱！*”

**个人冒充账户**
假账户不一定完全是“假的”，事实上可以很容易地冒充一个真实的个人，当然前提是他们还没有建立账户。如果您的调查发现某个员工没有创建帐户，那么您就可以为他们创建帐户。企业的其他员工可能会认出这个人并接受任何链接请求。最终，真正的个人我们会意识到这个假账户，但那时你已经从所有其他员工的账户中窃取了所有潜在的敏感信息。从某种意义上说，这是一种非常冒险的方法，但回报有时会让它物有所值。

**组织冒名顶替账号**
创建一个假账号冒名顶替一个组织会有一些好处。一般来说，组织的帐户不会像一般用户的帐户那样引起怀疑。为你知道目标企业使用的第三方公司创建一个假账户可能会很快导致与所有员工建立联系。

请记住，虽然假账户主要用于收集信息，但它们也有其他用途。在其他攻击中，与目标企业有良好关系的已建立帐户也可能被用来获得可信度。例如，你可以在电话中提及你的账户或目标客户提交的帖子，以获得可信度。此外，社交媒体网站是另一个可能的攻击媒介。如果您注意到一名员工正在浏览一个社交媒体网站(可能来自聊天面板),那么您可能会发送一个恶意链接，这可能会导致您访问他们正在使用的工作电脑。毕竟，企业开展意识和培训的可能性有多大，这些意识和培训的内容涵盖了通过这种媒介进行的攻击？

### 信息诱导

信息诱导似乎是社会工程的核心，联邦调查局将其定义为:

有策略地利用谈话从人们那里获取信息，而不给他们被询问的感觉。

这听起来就像是应该在评估中使用的技术。然而，这种技巧通常在非正式的谈话中使用，并且经常从与目标建立的关系中受益匪浅。因此，在持续几天的短期评估中，这些技术并不完全实用。要真正利用信息诱导的力量，你必须与目标多次接触，发展关系，引导对话向揭示你想要的信息的方向发展。当然，一个好的“诱导者”可以从与一个完全陌生的人的一次谈话中收集信息，但当时间非常有限时，这不是一种足够可靠的技术。因此，由于这本书关注的是社会工程评估技术，这种类型的信息获取仅限于“长期博弈”范畴。

这些技术旨在获取信息，尽管这些信息不是非常敏感，但仍然是目标通常不会透露的信息。例如，通过这些技巧，在与雇员的随意交谈中，你可能了解到电话系统坏了。这不是非常敏感的信息，但作为攻击场景的一部分，它可以用来获取可信度。此外，讨论企业设备的当前状态不是你通常会和非员工做的事情。在同一对话中，员工可能会提到同一电话系统的制造商。同样，这些信息可能对社会工程师有用，员工通常不会向陌生人透露。他们之所以披露这些信息，却没有意识到他们已经造成了违规，是因为诱导的技术。我们现在将介绍一些最常用的技术。

**胜人一筹**
这激发了人们想要“胜过”竞争对手的欲望，尤其是男性。例如，你谈论一个虚构的产品，并希望目标客户透露关于他们产品的信息以“胜过”你"*嗯，这听起来不错，但我们的新产品将能够做到这一点*……

**批评和辩护**
当你批评你的目标感兴趣的东西时，他们很可能会想为它辩护。如果你能让你的批评非常有针对性，那么你可能会从目标的防御中获得敏感信息。例如，您可以评论*“我严重怀疑他们会与 xyz 公司合并，他们没有基本的商业意识……”*您可能会遇到"*您大错特错，他们确实有敏锐的商业意识，而且会议已经安排好了！*”

**无知**
这非常类似于社会工程学中的“装傻”，只不过这里你扮演的是学生。你假装对某个特定的主题一无所知，希望目标会想要“教育”你。这可能会让你获得有用的信息，也让你看起来不那么具有威胁性。

**阿谀奉承**
一个非常基本的技巧，让目标觉得自己很重要，提升他们的自信心，让他们想夸耀自己的成就。例如"*"听起来你真的很懂自己的东西。我打赌你管理整个 IT 部门！你一定负责很多事情！*”

**开放式问题**
这是销售人员经常使用的技巧，在第一章的[中有所涉及。基本前提是，问一些不能真正用简单的“是”或“不是”来回答的问题，这样目标才有可能给出更多的信息。例如，如果你想知道正在使用的网络浏览器的版本，而不是问“*你使用 Internet Explorer 8.0 吗？*“你可以反过来问”*你有没有发现最新版本的 Internet Explorer 更稳定？*”。第一个问题可以用简单的是或不是来回答，可能有点可疑。第二个问题需要一些思考来回答，它很可能会透露你想要的信息。](01.html)

**聚焦对话**
这里的概念是围绕广泛的话题展开对话，然后开始关注你感兴趣的领域。这里的想法是让目标感觉好像谈话已经自然和无意地导致了兴趣点。如果目标变得不舒服，或者你没有成功地获得你想要的信息，那么在重新聚焦之前，重新开始拓宽转换话题。

**间接引用**
如果你想获得某个特定领域的信息，那么有时谈论一些间接相关的事情会很有好处。例如，谈论雇用清洁人员的挑战可能会泄露从平面图到内部安全系统的所有敏感信息。

如前所述，信息获取从与目标建立的关系中受益匪浅。下面的技巧着重于创造良好关系所必需的融洽关系。

**倾听**
倾听目标不仅有助于建立良好的关系并巩固关系，还能让你收集更多信息。非常容易把太多精力集中在自己的方法上，结果你说得最多，这与你想要达到的目标相反。

**共同点**
建立良好的共同点是建立融洽关系的最快方式之一。假装对相同的爱好、活动、电影、音乐等感兴趣。然而，注意不要因为不能回答任何关于你声称感兴趣的主题的问题而引起怀疑。最好的方法是建立共同点，然后转移话题。

 **这种技巧利用了回报的力量，这个主题已经作为利用情绪状态的一部分进行了讨论。然而，当用于信息诱导时，那么“提供”通常是敏感信息，希望得到他们的敏感信息作为回报。例如“*我们刚刚安装了这些新的 RFID 设备，它们给我们带来了无尽的麻烦…* ”**

**### 扩展的网络钓鱼攻击

在第 9 章的[中广泛讨论了网络钓鱼电子邮件攻击的创建和执行。然而，值得一提的是，当作为“长期游戏”策略执行时，这种方法会有什么不同。](09.html)

在评估中，电子邮件攻击媒介最初用于收集信息，如业务电子邮件结构、不在办公室时的自动回复和其他员工联系信息。随后，会发送有针对性的网络钓鱼电子邮件来获取凭据或将目标指向恶意网站。然而，这两种方法都是“短期游戏”技术，因为从最初的电子邮件到后门访问的整个过程实际上可以在短短几个小时内完成。如果攻击者不受时间限制，方法会有什么不同？

上述针对网络钓鱼攻击的方法不一定要求与目标建立关系，即使是针对特定的个人。显然，如果仿冒电子邮件被伪装成来自目标的同事，那么您就利用了他们之间的信任关系。然而，如果你能自己建立关系，并最终更好地了解目标，那么你将有更大的成功机会。延伸的鱼叉式网络钓鱼攻击将慢慢地在你和目标之间建立对话，发展关系，并且将不可避免地揭示完美的操纵方法。

常见的“短游戏”攻击场景部分提到了通过冒充大学生获取敏感信息。他们会通过电话联系目标，询问有关企业及其运营方式的问题。冒充学生的社会工程师将选择可能揭示有用信息的问题。这种方法有一些风险。你联系的员工可能会拒绝提供信息，你联系的员工越多，引起怀疑的可能性就越大。

为了降低风险和增加成功的机会，这种情况可以从“短期游戏”电话攻击转化为“长期游戏”扩展鱼叉式网络钓鱼攻击。

在典型的网络钓鱼攻击中，一封电子邮件被发送到从初始侦察中获得的多个目标。在扩展攻击中，方法应该尽可能的现实。因此，最初发送的电子邮件应该是普通的联系人，如 info@或 inquiries@或目标网站上最显眼的任何地址。记住，这个想法是随着时间的推移尽可能令人信服地建立可信度。

你好，

我目前正参与一个项目，作为我学习商业和管理最后一年的一部分。我们的项目主要关注像你们这样的私营企业。

我知道你会很忙，但是如果你能告诉我谁能给我一些信息，我会非常感激！

谢谢你的时间，希望你能帮助

索菲

在上面的电子邮件中，您只要求一个联系人，这甚至可能是一个部门的请求。通常情况下，您会收到员工对此类查询的回复，而不是普通电子邮件地址。这种初步接触应该为你提供你的第一个目标和他们的电子邮件结构。如果你幸运的话，回复将包括员工的更多联系信息，这些信息“*可能会对你*有所帮助”。或者您可能会被告知，您的请求已被转发给其他员工，他们将很快与您联系。希望你的电子邮件会开始在公司内流传，因为每个员工都试图通过将邮件转发给同事来逃避责任。最终，当你与愿意提供信息的人建立对话时，之前的电子邮件链创造了可信度，认证链也同样适用。

考虑问一些无关痛痒的问题，这些问题结合起来会透露出有用的信息。尝试确定有多少部门，有多少员工在那里工作，每个部门由谁负责，员工层级，他们与哪些合作伙伴公司合作，以及一般政策和流程。这听起来像是他们永远不会透露的信息，但是记住信息诱导的概念。你不会直接问你有几个部门？”。相反，你可以说类似于"*的话，我们之前采访的那家公司说他们很有实力，但他们也说他们只有三个部门，我们觉得这有点奇怪？*”。在这里，我们使用社会证据(前一家公司透露了信息)，我们利用“无知”的力量，希望我们会被目标告知。希望得到的回应是“*真的吗？这很奇怪，我不会说我们成立时间特别长，但我们这里有八个部门，每层一个！*”。

一旦您从一名员工那里获得了信息，您就可以通过以下请求继续传播攻击:

嗨，马丁，

你真是帮了大忙了！你的见解对我们的项目产生了真正的影响，我们必须感谢你！:)

有点厚颜无耻，但是在人力资源部谁会像你一样乐于助人呢？

索菲

会有员工和你保持联系。例如，最初的联系人可能会发电子邮件询问您是否收到了您想要的信息，以及他们是否还能提供其他帮助。一旦你相信你已经和某个特定的员工建立了牢固的关系，那么很可能是时候抛出陷阱了。考虑你与他们的对话，利用关键信息。例如，假设您与一名员工讨论了大学项目的难度和范围，他们问您"*我们会看到结果吗？*”。

如果您希望他们浏览恶意网站:

嗨，马丁，

当然可以！我们已经开始建立一个网站，展示我们的结果和你的贡献。

目前这还有点基础，但你会明白的。:)

[www.afakemaliciouswebsite.com/project](http://www.afakemaliciouswebsite.com/project)

苏菲，x

或者您希望他们下载恶意附件:

嗨，马丁，

当然可以！我已经附上了我们迄今为止所做的草案。

目前这还有点基础，但你会明白的。:)

苏菲，x

此时，在来回发送了几天或几周的电子邮件后，目标不太可能会怀疑任何恶意意图。最好的方法是等待目标回复一些几乎是“请求”你发送链接或附件的东西。

以上只是如何执行扩展鱼叉式网络钓鱼攻击的一个示例，当然，您可以通过各种不同的方式来实现。要记住的重要一点是，随着时间的推移，你会建立起可信度，然后等待目标揭示操纵他们的最佳方式。

### 获得内部帮助

上一节谈到了获取有助于攻击的信息。然而，对攻击者有用的信息并不总是那么明显。与其寻找部分敏感的员工或公司信息，不如寻找可能直接帮助你的员工。

人们常说，绝大多数安全漏洞是由内部员工造成的。通常情况下，违规行为不是故意的，但有时却是故意的。“心怀不满的员工”的概念是大多数企业严重关注的问题，尤其是那些刚刚解雇了一名拥有高特权的员工的企业。即使企业遵循了严格彻底的员工解雇程序(例如禁用员工的各种计算机帐户并更改他们可能知道的任何密码)，员工仍有可能拥有他们未能删除的某种级别的访问权限，例如他们不知道的计算机网络后门。如果他们能够远程访问企业的计算机系统并删除当前和备份的数据库，那么企业可能会受到严重损害，甚至无法恢复。

心怀不满的员工不仅仅是那些实际上已经被解雇的员工，因为现在的员工也可能对企业有很大的不满。他们可能不喜欢自己的工作，但出于各种原因，他们别无选择，只能留下来。这种类型的员工可能是最危险的，因为他们肯定仍然拥有可能损害业务的特权。此外，企业不一定意识到任何潜在的风险，例如最近被解雇的员工带来的风险。

一个对企业有严重怨恨的员工，不管他们是否还在那里工作，对攻击者来说都是非常有用的。“内部人员”不仅可以提供有用的信息，还可以代表攻击者从内部完成各种方式的攻击。他们可以建立网络后门，提供合法的通行证或将商业数据直接泄露给攻击者。

攻击者需要做的就是找到它们，这可以通过信息诱导来实现。

第一个挑战是与员工见面，这可以在吸烟区、他们经常去的当地咖啡馆或酒吧，甚至在他们乘坐的公共交通工具上完成。

你可以和员工进行一次相当无伤大雅的谈话，然后把话题集中到一般的工作生活上。你确切地知道他们在哪里工作，但当然表现得好像你不知道。你把话题进一步集中到你在工作中受到的待遇上。如果他们真的对目前的工作不满意，他们可能会说他们受到的待遇有多差，试图改善工作，或者承认他们也非常不喜欢自己的工作，以此建立共识。

一旦你确定了一个员工是否是潜在的共犯，下一个问题就是如何利用他们。你是否试图让他们加入你的事业，导致他们冒着丢掉工作的危险？或者您是否试图从他们那里获取敏感信息，比如远程访问密码？如果你暴露了你的位置，不管他们是否喜欢他们的工作，他们都有可能立即发出警报。这就是为什么这是一个“长期博弈”的技巧，因为完全确立一个真正的无风险“内部人士”的目标确实需要大量的时间。

### 在目标公司工作

这可能是最老套的社会工程技术之一，经常被宣称为企业无法抵御的终极攻击。如果你申请并成功获得了目标公司的工作，那么你至少可以进入那栋大楼。一旦你进入大楼，你的攻击就容易多了。例如，在打扫办公室的时候，你可以安装键盘记录器或者安装投件箱来创建进入网络的后门。

我们利用了哪些漏洞？严格来说，你是在测试企业员工筛选流程的稳健性。他们检查个人的姓名和地址等基本细节吗？他们联系推荐人了吗？如果他们联系了推荐人，他们真的会验证他们吗？他们会正确检查工作历史吗？

攻击者申请的一个经典职位是清洁工，大概有两个原因。首先，一个清洁岗位不应该真的要求任何特定的资格，其次，由于与该职位相关的特权明显较低，企业不太可能对申请人进行彻底的调查。然而，具有讽刺意味的是，清洁工通常比正式员工有更多的进入大楼的权利。一旦攻击者成功获得了工作角色，他们可能利用的漏洞与任何普通员工都没有什么不同。

整个过程可能会花费大量时间。从攻击者的角度来看，这可能是以最低的风险换取最高的回报。从安全评估员的角度来看，这种方法是在测试员工筛选过程，这是一种无需冗长的实际评估就可以显著改进的方法。例如，安全顾问可以用伪造的证书和证明申请一个职位，以测试是否遵循了筛选程序。然而，这确实依赖于当前可用的位置，但情况并非总是如此。

### 瞄准合作伙伴公司

前几章已经讨论了敏感数据如何存储在多个位置。一旦你找到了所有存储数据的地方，你就可以选择攻击最薄弱的地方。然而，即使你的目标数据仅仅存储在一个商业地点，建立与该商业的所有直接和间接的联系也是非常有益的。任何与你的目标公司打交道的公司都是整个安全链中的一环，即使他们不一定存储你想要的数据。有两种利用第三方的方法；您可以模拟它们，也可以直接攻击它们来获取有用的信息。

来自第三方公司的承包商通常会联系并拜访一家企业。这可能是对他们的硬件执行例行维护或对报告的故障做出响应。员工将习惯于看到这些承包商，不太可能完全挑战他们。此外，员工还将习惯于看到不同的工程师，这使得模仿变得更加容易。所有社会工程师需要做的就是令人信服地扮演第三方承包商(可能比印有他们标志的 polo 衫好不了多少)并设计一个体面的借口。这种方法的简单性使得它可能是针对企业的最常见的物理攻击之一。基于承包商访问的场景识别访问者/承包商签到和验证程序中的弱点。可悲的是，简单地到达现场并解释你被叫去看打印机有时就足以获得访问权，尽管作者永远不会推荐这样的方法。见第 7 章对构建目标场景的分解。

第三方公司通常会联系企业以响应支持请求，甚至销售更多的服务和产品。如果你能成功地冒充第三方公司，那么你就能获得非常有用的信息。例如，如果您的侦察发现目标公司使用特定的打印机制造商，您可以冒充销售代表询问他们设备是否符合他们的期望。从这一通电话中，你可能会学到:

他们有什么型号的打印机

他们是否有任何问题

谁负责它们的维护

谁负责他们的采购

这些信息可能看起来完全无关紧要，但是正如前面的章节所显示的，将无关紧要的数据变成敏感数据是一个小步骤的过程。如果你从电话中得知制造商自己会派工程师出去，那么你就有了一个可能情况的开端。

除了冒充之外，还有可能直接攻击第三方公司，以便在您的主要目标上获得立足点。第三方可能不会存储您想要的数据，但他们可能拥有主要目标的网络可见性。

### 长期监视

长期监视是一种古老的信息收集技术。在各种间谍电影中，调查人员在“监视点”透过百叶窗从马路对面观察目标，或者使用变焦镜头从远处抓拍照片。风险相对较低，前提是你隐藏得很好，并且有充足的时间，那么这些方法可以收集大量信息。然而，这些方法与攻击企业有什么关系？在作者给出任何关于这些方法的实用建议之前，我们首先需要消除一些常见的陈词滥调。

如果你试图了解一个高度安全的军事建筑的布局，秘密监视和高倍镜头可能是有利的。然而，在攻击一般的企业时，你只需要带着你的狗走过前门，就可以看到所有的摄像头、保安、出入口。你甚至可以走进接待处，询问方向，看看布局和所有可能的弱点。因此，长期监视对于攻击的初始侦察阶段并没有多大用处。就评估而言，简单的建筑照片和谷歌地图信息可能就足够了。

在监控中经常使用的一个陈词滥调是使用双筒望远镜甚至望远镜透过窗户观察员工的键盘敲击。这个想法是，你将能够看到他们输入自己的密码，并使用这一优势。这有多实用？通常，在企业的所有员工中，只有少数人拥有“域管理员”用户的特权。快速有效地破坏网络(假设它是 Microsoft Windows 域)需要这种级别的权限。因此，您可能会翻遍许多 office 窗口，才发现一个有价值的密码。此外，您没有真正的方法来完全确认该密码是否是高特权用户。但是，如果企业拥有可远程访问的服务，如企业电子邮件或 VPN 门户，那么即使是标准用户的凭据也可能访问它(前提是它没有双重身份验证)。如果您可以访问用户的电子邮件帐户，那么您就可以使用它来发起进一步的网络钓鱼电子邮件攻击。密码有可能会被重复使用，因此你很可能会获得额外的服务，如用户的易贝、亚马逊甚至贝宝账户。如果您获得了进入该建筑的权限，那么至少您应该能够使用标准用户的凭证登录到一个免费的工作站。从工作站发起攻击通常比将笔记本电脑或“dropbox”接入网络更不可疑，当然，除非你可以在不被发现的情况下进行攻击。

与监视员工输入密码类似，监视的另一个常见用途是监视员工在键盘上输入密码(单工锁等)。).在银行等高安全环境中，这些锁通常水平安装，因此很难从远处看到衬垫。然而，奇怪的是，在绝大多数情况下，它们都是垂直安装在墙上，让所有人都能看到。坐在停车场的车里，用一副好的望远镜就可以看到输入的密码。有时，停车场栅栏上也会使用键盘。如果您曾经看到这些锁在使用，那么您必须向客户端强调这个漏洞。然后，他们可以衡量对抗措施(用射频识别(RFID)或水平安装替代)的成本与攻击者使用代码获取访问权限的风险。如果与客户进行 5 分钟的对话就能确定风险并让他们做出好的商业决策，那么不要浪费时间去捕捉输入代码的人。

另一个与键区锁相关的弱点出现在密码没有定期改变的时候。最终按钮会磨损，因此攻击者可以看到按下了哪些数字。这将可能的组合数量减少到很少。

如果时间不是有限的资源，那么最好的方法是将长期监控与将无害信息转化为敏感信息的概念相结合。假设您在马路对面租了一个房间，使用望远镜可以很好地看到目标办公空间。一般来说，你会看到员工在外工作，在办公桌前打字，在饮水机旁聊天，在橱柜里整理文件等等。然而，如果你知道要寻找什么，那么你就可以收集到一些有用的信息。

最起码你应该找:

工作站屏幕上显示的当前使用的操作系统

他们使用的工作站的制造商

他们拥有的 VoIP 电话制造商

员工的身份徽章和挂绳的颜色

哪个部门在几楼

员工的着装，每个部门都不一样吗？

写在白板上的信息，如网络图甚至密码

他们在抽屉和橱柜上使用什么锁？它们只是晶片锁还是更安全的东西？

有什么内部安全措施？员工在大楼内使用 RFID 通行证吗？

一般来说，他们每天都是什么时候到达和离开？

还有一些不太明显的事情你应该注意:

门会开多久？尾随容易吗？

办公室是开放式的吗？如果你走过，你会突出吗？

是否有明确的办公桌政策，或者员工去吃午饭时会把东西放在外面？

员工是否一直使用碎纸机，或者文件是否被扔进垃圾箱？

请记住，你看到的几乎任何东西都有可能被用来获得可信度。假设你注意到员工每周五都会带饼干来，并把它们放在桌子上。当打电话给你的目标并假扮成一名员工时，只要愉快地说一些简单的事情就能赢得信任，比如“那么，你今天吃了多少饼干？”。有时，一些不太明显、完全无害的信息，比如“星期五饼干”，可能比密码更有价值。

** **## 摘要

如果您正在执行社会工程安全评估，那么您很可能会局限于“短期游戏”攻击策略。虽然这些可能不完全现实，但仍然很有可能为客户提供巨大的价值。要做到这一点，你必须瞄准最相关的领域，有效地利用你仅有的一点时间。最终，您的评估需要提供对客户的整体安全状况产生最大影响所需的信息。

如果你是一个现实世界中没有时间限制的攻击者，那么你可以使用的方法是非常有效的。你花的时间越多，跨越几周或几个月，你就越有可能成功。如果作为一个客户，你想探索与“长期游戏”攻击技术相关的风险，那么你基本上有两个选择。你可以投资一大笔钱到一个扩展的社会工程评估中，或者你可以采取一种“风险管理”的方法，把问题当作一个纸上作业来解决。然而，请记住，社会工程专业人员可以提供对可能的“长期博弈”攻击的深刻见解，从而使纸上练习更加准确和相关。

下一章将讨论与聘请第三方公司进行社会工程评估相关的流程和挑战。

** 