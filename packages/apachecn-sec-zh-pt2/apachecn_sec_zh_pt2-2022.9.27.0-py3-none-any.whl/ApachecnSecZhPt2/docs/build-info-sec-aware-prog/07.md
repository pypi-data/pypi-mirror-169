# 七、社会工程

Valerie Thomas<sup>Securicon，美国弗吉尼亚州洛顿</sup>

## 摘要

一个常见的误解是，所有的攻击本质上都是纯技术性的。社会工程是一门获得信任或接受的艺术，目的是说服某人提供信息或执行有利于攻击者的行动。然后，攻击者将新获得的信息(通常是通过研究和多次攻击获得的)与技术攻击相结合，以产生对目标来说是灾难性的结果。

关键词

社会工程

网络钓鱼

鱼叉式网络钓鱼

翻垃圾箱

欺骗

## 什么是社会工程？

“天气真好，”马克笑着说，一边用打火机轻弹着嘴里的香烟，一边挣扎着握住他的雨伞。“是啊，太棒了，”杰瑞同意道，他朝一栋办公楼的窗户吹出一团烟。杰里又吸了一口烟，问道:“你昨晚看比赛了吗？”马克把一些灰烬弹到地上，“不，妻子想检查一些新的小吃的地方。花了 70 块，我还饿着呢。”当这两个人熄灭他们的烟时，杰里傻笑着。"是啊，我知道那是怎么回事，"他点点头说，马克刷了他的门禁卡，并在杰里抖掉夹克上的雨水，然后走进了大楼。这些人在走廊上走向相反的方向。马克回到他的办公桌去接一个来电。杰瑞找了一间空的会议室来安装他的笔记本电脑，然后开始窃取公司的数据。

你看，杰瑞不是雇员；他是个袭击者。

社会工程是一门获得信任或接受的艺术，目的是说服某人提供信息或执行有利于攻击者的行动。尽管大多数社会工程攻击是非技术性的，但当与技术性攻击结合时，其结果对目标来说可能是灾难性的。著名黑客凯文·米特尼克在他的第一本书《欺骗的艺术》中创造了术语社会工程。在 1995 年被捕之前，通过说服和欺骗以及技术攻击，米特尼克得以渗透到太平洋贝尔和北电这样的组织中。2000 年获释后，米特尼克创建了米特尼克安全咨询公司，现在是世界上最受欢迎的计算机专家之一。

## 谁是社会工程师？

并非所有的黑客都符合住在母亲地下室的反社会青少年的刻板印象；这同样适用于社会工程师。大多数社会工程师都非常外向，不会因为和陌生人搭讪而感到不安。为了获得人们的信任，你必须愿意和他们交谈。通常，他们穿着融入环境，但如果情况合适，偶尔也会穿着突出。假设所有的社会工程师和黑客都是男性也是不安全的。女性被认为不如男性具有威胁性，这使她们成为非常有效的攻击者。最重要的是，他们是可爱的人，让他们接触的人对他们感觉良好。

## 为什么会起作用？

从很小的时候起，我们就被教导“黄金法则:以你希望被对待的方式对待别人。”当我们看到有人在挣扎时，我们的第一反应是帮助他或她。如果这个人表示如果目标不帮忙，他或她会有麻烦，那就更是如此。社会工程通过努力从目标那里获得共鸣，利用我们的心理构成来对付我们。同理心是认同另一个人的情绪和/或想法并以适当的情绪回应的动力。最后，这些类型的攻击是有效的，因为许多人不知道什么是社会工程攻击以及它们带来的威胁。

## 它是如何工作的？

并非所有的社会工程攻击都旨在获取敏感信息，如密码。有些人意在获取一条对目标来说似乎无关紧要的信息，比如他们的清洁公司的名称。攻击者使用这些较小的信息创建一个掩护故事或借口来执行攻击。借口的目的是通过古老的“鸭子测试:如果它看起来像鸭子，像鸭子一样游泳，像鸭子一样嘎嘎叫，那么它可能是一只鸭子。”

攻击周期可以分为三个阶段:

■ 信息收集

■ 攻击策划

■ 攻击执行

为了便于讨论，我们将把攻击计划和执行结合起来，因为我们将枚举许多例子，不想混淆它们。

## 信息收集

欺骗是一项非常细致的工作，涉及最小的细节，在某些情况下包括天气。为了让社会工程师成功，他们必须融入目标环境。

融合不仅仅是物理上的；一个人还必须能够说该组织的行话，并知道其关键人物。信息是从大量的互联网资源中收集的。我们将讨论最流行的资源以及社会工程师如何使用它们。

### 公司网站

出于一些显而易见的原因，社会工程师会仔细检查目标网站，例如确定他们的行业和产品/服务。他们寻找的一些不太明显的项目如下:

员工数量——要对一个每个人都直呼其名的组织进行社会化改造更加困难，虽然困难，但并非不可能。

■ 地点——了解目标公司的办公地点至关重要。如果攻击者要冒充工程部门的员工，他们希望确保他们的目标不是坐在隔壁的隔间里。

■ 职位空缺——详细的招聘信息提供了对目标可能使用的特定技术的洞察，如防病毒和入侵检测系统(IDS)。职位公告还提供了公司部门所在位置的详细信息。例如，发布了三个地点为达拉斯的会计职位。

高管和经理的名字——这些信息可以用来绘制组织结构图。

■ 电子邮件地址格式——一旦攻击者知道了目标的电子邮件方案，例如[john.smith@abc.com](mailto:john.smith@abc.com)，他们就可以用从其他来源发现的名字创建电子邮件列表。用户在其电子邮件地址中的命名方案有时可能与其登录用户名的格式相同。

■ 时事——目标公司最近是否与另一家公司合并了？伪装成新收购公司的员工可能是一个潜在的攻击媒介。他们有对公众开放的活动吗？这些活动可以成为学习公司行话和观察他们安全感知水平的机会。

最终，攻击者需要对目标有一个细致的了解，以便伪装成一名员工或可信任的内部人员。公司网站是一个有价值的情报来源，但不是唯一的。

### 社交媒体

虽然社交媒体网站非常适合与朋友和同事保持联系，但它们也是攻击者的沃土。脸书和推特提供了对潜在目标的个人生活的深入观察。除了人的活动的接近实时的更新之外，通常还包括其他有用的信息。一些例子包括

■ 家人姓名

■T2】高中就读

■T2】生日

■ 宠物名称

■ 喜欢的颜色

■ 爱好或兴趣

上面列出的所有项目都提供了密码重置或其他安全相关问题的潜在答案。这些个人信息也为攻击者提供了感染受害者计算机的潜在攻击媒介，稍后将对此进行详细介绍。

对于一个社会工程师来说，LinkedIn 是一个目标购物清单。精细搜索选项允许使用过滤器，如当前雇主、前雇主、实际位置、行业等。想知道你的目标公司工程部都有哪些人？没问题。通过一个高级 LinkedIn 账户和一些定制的搜索，你可以在几分钟内得到一个列表。更好的是，大多数简介都包括详细描述工作职责和技术技能的部分简历，这些简历提供了目标组织现有防御技术的概述。

### 搜索引擎

使用你选择的搜索引擎，有可能获得“有趣”的文档。他们可能会获得内部信息，如常见的缩写、财务细节、网络图和其他感兴趣的项目。有人称之为“谷歌黑客”，但任何搜索引擎都足够了。下面的例子是为谷歌搜索而写的:

■ 【公司名称】内部文件类型:doc

■ 【公司名称】敏感文件类型:xls

■ 【公司名称】私有文件类型:ppt

■ 【公司名称】【请勿传播】文件类型:pdf

### 垃圾箱

翻垃圾箱是一种古老而流行的信息收集方法。虽然它不是很令人愉快，但它通常会产生很好的结果。在红队评估期间，我的团队发现了所有东西，从标有“敏感-请勿打印”的文件到打开工厂大门的身份证。你会惊讶于垃圾箱能容纳多少信息…只是别忘了戴手套。

### 受欢迎的午餐地点

听说过“信口开河会沉船”这句话吗？很多时候，如果攻击者(或任何其他人)想知道组织中发生了什么，他们需要做的就是去吃午饭。袭击目标位置周围受欢迎的餐馆和咖啡馆是一种无风险的数据收集方法。如果两个或更多的同事在一起一段时间，他们几乎不可避免地会“谈论工作”团体越大，谈话越详细。当我以社会工程学的方式培训安全专业人员时，他们的任务之一是出去吃午饭，除了听他们周围的对话和做笔记，什么也不做。通常会有奖品等着带回最有趣的故事的人。下次你在餐馆或咖啡店时，自己尝试一下，看看通过简单的倾听能获得什么知识。目标公司的员工通常很容易被认出来，因为他们忘记了挂在脖子上或公司衬衫和夹克上的身份证。这也是学习公司行话的绝佳机会。

## 攻击的策划和执行

### 袭击者杰瑞

让我们从这一章的开始重温一下我们的角色。在到达现场之前，Jerry 已经收集了多个目标位置的航空地图，试图定位潜在的吸烟区。一般来说，吸烟区在建筑物的侧面或后面，远离主入口，远离大多数保安。Jerry 一到现场，就早早地在街对面的一家咖啡馆吃了午饭，并从远处观察了这座建筑。当服务生端来汉堡和薯条时，杰瑞发现马克和另外两个男人在吸烟区。杰里从他的 LinkedIn 个人资料照片中认出了马克，这再次证实了目标位置是正确的。他往嘴里塞了几根薯条，看着这些人交谈，然后微笑着看着马克为每个人开门，因为雨开始下了。

虽然上面的例子看起来简单明了，但是我们投入了大量的时间来研究目标公司的潜在攻击媒介。杰瑞不仅需要一个进入大楼的计划，他还需要计划一旦进入大楼后的目标，以及一旦被发现后的撤退策略。

### 鱼叉式钓鱼邮件

在信息收集阶段，攻击者发现他们的目标公司正在使用 Cisco VPN 客户端。员工能够在他们的工作笔记本电脑上安装客户端，通过适当的身份验证连接到公司网络。然后，攻击者创建了一个恶意版本的 VPN 客户端软件，使他们能够访问受害者的计算机，但仍然可以作为正常的 VPN 客户端运行。一旦恶意 VPN 客户端完全正常工作，攻击者就会执行以下操作来实现攻击:

■ 购买了与目标公司相似的域名。

■ 通过查看收集到的姓名和职位选择目标员工。他们选择了经常出差(因此非常依赖 VPN)的市场部的“Dan”。丹被选中也是因为他在公司的非技术职位。当被告知安装软件时，非技术员工不太可能向公司网络团队的同事提问。

■ 选择了一名员工，他们将用这名员工的名字来发送攻击邮件。根据他在 LinkedIn 上的资料，Joey 是这家公司的首席网络工程师。选择有资历的人是首选，因为人们更有可能遵从权威人士的要求，而不是中低层员工。

■ 在他们新购买的域名中为乔伊配置了一个电子邮件地址。

然后，他们等待着。记住，在社会工程攻击中，时机就是一切。他们一直等到乔伊在 Twitter 上宣布，他将在本周余下的时间里在外州参加一个会议。

周五上午晚些时候，攻击者用乔伊的虚构账户给丹发了一封电子邮件，内容是:
“为了提高连接速度和可用性，我们升级了 VPN 基础设施。使用时需要客户端软件更新。今天不通过 COB 更新的用户将不再拥有 VPN 访问权限。
所有 VPN 用户必须通过运行附带的安装程序来更新其客户端软件。
不需要系统重启。如果需要额外帮助，请联系用户支持。
恭敬地，
乔伊史密斯
网络运营
分机。1402

团队监控虚构的电子邮件帐户的活动。几分钟后，丹回复说他已经安装了软件。攻击者随后获得了对 Dan 系统和公司网络的完全访问权。

攻击者仅仅为了发送一封电子邮件而花费数周时间来研究和准备攻击，这似乎不太现实，但这是现实社会工程攻击的一个主要例子。从多个来源获取小块数据，创造一个可信的故事，这就是社会工程的全部。对此的另一种观点是，短短几周的情报收集、一封电子邮件和一个软件就挫败了一家公司价值数十万美元的安全基础设施。

### 你好，服务台吗？

Sarah 的目标是一家大型保险公司，其办事处遍布美国。用一些定制的搜索词来定位他们基于网络的电子邮件和 VPN 网站是很容易的。这些网站不需要基于证书的身份验证，而且据 Sarah 所知，如果没有有效的登录凭证，双因素身份验证就不存在。这意味着她只需要一个有效的用户名和密码来访问公司的资源。使用 FOCA 工具，Sarah 检查了公司网站上各种文档和演示文稿中的元数据。元数据搜索产生了 10 个用户名，使用的是名首字母和姓的方案。既然 Sarah 理解了用户名的格式，她可以很容易地推断出仅包含员工姓名的用户名。然后莎拉在脸书搜索目标公司的员工，发现了 43 名。在这 43 份简介中，有 20 份完全向公众开放。开放档案显示所有已输入脸书的数据，包括用户的状态更新。莎拉用公开的脸书档案编制了一份女性员工名单，并开始搜索其他信息，如签名栏和办公室电话号码。

这是圣诞节的一周，假期正如火如荼地进行着。莎拉用公开的脸书档案监控着女员工的名单，直到娜塔莉·格林更新了正确的状态。"前往夏威夷，享受远离冰雪的十天快乐时光！"这对莎拉来说是个好消息！现在，莎拉可以尝试控制娜塔莉的账户，而没有被发现的风险。莎拉整理了她关于娜塔莉的笔记清单，包括生日、家乡、办公室和手机号码、家庭住址、部门名称、工作头衔和主管姓名。

在平安夜，晚上 7:00，Sarah 使用来电显示欺骗程序联系服务台，使她的号码显示为 Natalie 的手机。一个声音悦耳的年轻人回答道。“服务台，我是保罗。我能为您做些什么？”莎拉用她最好的“抱怨的声音”回答道。“你好，保罗。我是丹佛办公室的娜塔莉·格林。这周早些时候改了密码，现在不记得了。如果我这周不值班，也没什么大不了的。”她叹了口气说。保罗会意地笑了笑:“这我太明白了。娜塔莉，让我帮你重新上线。我只需要你办公室的电话号码来验证你的身份。”萨拉惊讶地眨了眨眼。真的有这么简单吗？她咬着舌头抑制住激动。“没问题，保罗。”她回答说，并继续从她的笔记中读取电话号码。线路变得安静了，但莎拉可以听到打字声和背景中圣诞音乐低沉的旋律。“你都准备好了，娜塔丽。我将您的密码设置为 2013Denver $，’，但您必须在登录后更改密码。”萨拉笑了笑，发出一声如释重负的叹息。“多谢保罗。我非常感谢你今晚的帮助。我希望你明天也不会被困在那里。”保罗回答说:“谢天谢地，没有，但如果你遇到任何问题，我会在这里过夜。”莎拉开始输入娜塔莉的用户名和新密码，以验证它们是否正常工作。“看来我可以走了。再次感谢保罗。圣诞快乐！”莎拉现在可以不受限制地使用娜塔莉的账户整整一周。在娜塔莉预定返回之前，莎拉安装了一个后门程序，允许她进入娜塔莉的账户，即使她的密码已经被更改。

帮助台是攻击者的主要目标，因为它们的全部目的是帮助人们。袭击发生在假日的晚上，因为很有可能是一名经验不足的员工在值班。这是一个万无一失的方法，以防莎拉丢失了一条验证她身份的关键信息。新员工更有可能为了帮助某人远离麻烦而违反程序。

## 社会工程防御框架(SEDF)

作为一名安全顾问，我已经为众多客户进行了社会工程评估，从电子商务到政府以及介于两者之间的一切。每个项目都是独一无二的，但几乎总是导致来自管理层的同一个问题:“我们如何阻止社会工程攻击？”我发现我没有一个明确的参考资源，甚至没有一个高层次的指导方针来帮助他们开始。

简单的道理是，社会工程攻击不是单靠技术就能阻止的，也不是单靠训练就能阻止的。我创建了社会工程防御框架(SEDF)来帮助组织在企业层面防止社会工程攻击。SEDF 概述了攻击预防的基本阶段:

■ 确定曝光

■ 评估防御

■ 教育劳动力

■ 精简现有技术和政策

SEDF 阶段相互独立，可以按照适合组织优先级的顺序执行。如果你刚刚完成了一次大型的训练活动，那么也许评估防守是你的下一步。

### 确定曝光

这个阶段的重点是通过社会工程师的眼睛来查看网站和其他可用资源。网络暴露评估是一种收集客户信息的非侵入性方法，目的是清楚地了解哪些数据暴露在互联网上。

重点关注的一个主要领域是公司网站。你提供的信息太多了吗？在线员工名录虽然对客户有帮助，但对社会工程师来说却是一座金矿。在大多数情况下，列出以客户为中心的关键员工可以为客户提供联系点，而不必列出公司的所有员工。多余的职位发布会提供关于您环境中部署的软件的详细信息。向全世界宣布你的反病毒品牌和其他部署的安全技术就像是为攻击者准备了欢迎的垫子。元数据分析是评估的关键部分，用于确定用户名、密码和操作系统详细信息是否暴露在您网站上发布的文档中。

评估的另一部分是搜寻泄露的文件。并非所有这些文件都是通过谷歌发现的。点对点网络、社交媒体和其他信息共享网站都是很好的资源。每当我执行这些评估并附上发现的文档时，客户总是问，“你从哪里得到这个的！?"

其他几个重点领域如下:

■ 技术支持论坛——你会惊讶有多少人使用他们公司的电子邮件地址注册这些论坛。在计划技术攻击时，代码片段和文件路径非常有用。

社交媒体——这些资源提供了对员工生活的洞察，也是攻击者的沃土。个人详细信息，如他们上了哪所高中或宠物的名字，通常被用作密码重置问题。此外，知道某人是否将休假一周为攻击者提供了伪装成该员工的机会，而被发现的风险最小。

■ 热门黑客网站——类似于[http://pastebin.com](http://pastebin.com)的网站是攻击者的热门垃圾场，可能包含从账户数据到知识产权的一切内容。

一旦研究完成，就会生成一份报告，总结发现的信息和最可能的攻击媒介。除了列出攻击媒介之外，还包括关于如何减少发现数据的暴露的建议。

### 评估防御措施

此阶段可用于评估员工对模拟攻击的抵抗和反应。组织也可以选择评估检测技术和适当响应组的有效性。模拟攻击的类型包括网络钓鱼、电话和物理攻击。通常的做法是将这些评估外包给专业供应商，但这不是必需的。

网络钓鱼评估评估组织对恶意电子邮件内容的抵御能力。内容可以从超链接、附件到 HTML 表单，以获取员工信息或访问他们的计算机。网络钓鱼攻击很受攻击者的欢迎，应该在您组织的网络威胁列表中名列前茅。如果您的组织尚未执行此类评估，模拟网络钓鱼攻击应该是此流程中首先评估的防御手段。创建模拟网络钓鱼攻击的详细过程可以在第 10 章中找到。

电话攻击，也称为视觉攻击，通过电话或短信欺骗个人泄露信息。攻击者执行呼叫者 ID 欺骗，这使得他们的呼叫看起来像是来自已知的电话号码。来电显示欺骗在美国并不违法，可以通过商业服务或个人设备进行。虽然 vishing 可能看起来过时了，但它仍然是攻击者非常有用的工具，因为他们的目标在向攻击者提供信息之前没有时间仔细考虑情况。将你最初的模拟电话攻击集中在主要与公众打交道的雇员身上。初步评估应包括帮助台人员、销售人员、公共关系人员和人力资源人员。

在宣传计划中，物理安全教育经常被忽视。虽然物理安全和网络安全通常向不同的部门报告，但他们都在努力保护相同的资产。完成物理安全评估对于物理和网络安全来说都是一次大开眼界的经历。物理渗透测试通过访问特定的设施或房间来评估安全控制。团队成员经常利用电子控制和社会工程来获得访问权。通常，物理安全评估与网络渗透测试一起执行。第 8 章中详细介绍了物理安全基础知识和评估。

此阶段的结果应回答以下问题:

雇员

■ 是否被访问或获取信息？

■ 工作站

■T2】服务器

■ 物理

■ 有多少员工提供了信息或访问权限？

利用了哪些弱点或漏洞来获取信息或进行访问？

■ 技术

■T2】人类

■ 物理障碍，如栅栏

■ 有多少员工报告了可疑活动？

■ 没错

■ 错误地

后卫

■ 检测到多少攻击？

平均检测时间是多少？

■ 攻击是如何被发现的？

■T3】员工举报可疑活动

■ 来自 IDS/antivirus/proxy 的技术警报

■ 来自安全摄像头或门禁系统的警报

■ 巡逻时被警卫部队发现

针对攻击，适当的响应程序到位了吗？

是否遵循了响应程序？

■ 事件升级是否得当？

门禁警报被调查了吗？

以上问题的答案可用于评估您当前认知计划的有效性。评估结果还可用于更新现有策略和修改物理和网络机制的检测设备配置。为了获得最大的有效性，应该定期对防御措施进行评估。至少应每半年进行一次网络钓鱼和电话评估。如果你的预算允许，身体评估应该每年进行一次。

### 教育员工

描述攻击可以提供信息，但是展示攻击具有更大的影响。我参加过的最好的培训课程是为一个政府机构举办的，以一个机构雇员告诉对手一个关键国防项目的敏感细节的视频开始。除了“对手”是一个试图从他那里获取社会工程信息的秘密特工；而且成功了。视频一结束，礼堂里一片死寂。这个自制的短片让观众大开眼界。它清楚地表达了“这些威胁是真实的，你可能是下一个目标”的信息会议的其余部分继续详细说明了这些攻击是如何进行的，以及如果您怀疑自己成为了攻击目标，应该做些什么。

分解攻击场景是社会工程教育中的一个重要步骤。向观众展示每条信息是如何获得的，以及在攻击中是如何使用的，有助于他们真正理解攻击过程。接下来，您需要讨论防止数据泄露和其他攻击的策略。要讨论的几个方面如下:

■ 元数据——确保你的受众理解元数据以及如何利用元数据来对付他们。提供有关如何在发布前从文档中移除元数据的教程。许多 Microsoft Office 程序都内置了此功能，但没有启用。

■ 网络钓鱼——员工必须知道如何识别和报告网络钓鱼信息。证明链接可以被伪装，电子邮件地址可以被欺骗，是传递信息的一种方式。

■ 社交媒体安全——教育你的受众关于社交媒体隐私的设置。让他们一步步了解如何限制脸书个人资料、禁用定位服务，以及使这些资料不针对特定公司，以便员工可以与家人分享。

你公司的电子邮件地址——永远不要低估你公司电子邮件地址的重要性。它不应该用于订阅论坛、邮件列表或其他特殊兴趣小组。它不仅暴露了公司的技术，而且还可用于伪装成邮件列表更新的鱼叉式网络钓鱼攻击。

■ 电话攻击——演示来电显示欺骗，强调电话号码是多么容易伪造。讨论员工在接到可疑电话时应该怎么做。他们是如何报道的？

物理攻击——正如我们在本章前面所讨论的，有时候，进入目标环境最简单的方法就是直接进门。强调尾随攻击的影响和访问者的程序。

防止社会工程攻击的最重要的一步是教育你的员工可以提问。如果有人试图尾随进门，员工可以问:“你能扫描一下你的徽章吗？”在您联系他们的经理进行核实时，可以让来电者等待。每个意识计划的目标都应该是教育员工如何向安全团队报告可疑行为，而不是让他们自己成为安全专业人员。对于许多组织来说，这将需要文化变革。如果管理层了解威胁，他们更有可能批准这种模式转变，因此要准备好就这些类型的攻击对您的管理层进行培训。

### 简化现有技术和政策

虽然单靠技术无法阻止社会工程攻击，但它可以将成功攻击的影响降至最低。有效的防御技术可能存在于您的环境中，但可以随着配置的变化而改进。与其逐行审查配置，不如通过头脑风暴会议关注全局，从涉及网络安全团队关键技术成员的高级场景开始。这种战术在国防工业中广泛使用，称为桌面演习，通常涉及多个军事分支和民事机构。桌面练习是一种非正式环境中基于讨论的脚本情景活动。这些练习通常由主持人引导，使安全团队能够一步一步地回顾攻击场景

■ 当前事件响应策略

■ 持续经营(COOP)计划

■ 预防技术

■ 探测能力

■ 开采发生后最大限度减少影响的方法

这些情景旨在鼓励建设性的讨论，并强调在无威胁的环境中需要改进的地方。桌面练习的范围可以很广，包括许多审查领域，也可以很窄，以突出特定领域，如所部署技术的检测和预防能力。桌面练习进行起来并不昂贵，也可以作为新员工的在职培训。不要忘记从一些真正做这些工作的员工那里获取信息。由于一些任务在纸面上看起来不错，因此可能需要并依赖其他团队的一些其他相关任务来全面支持他们的工作职能。

#### 计划桌面练习

桌面练习的三个阶段是设计、执行和行动后。设计阶段对演习的成功至关重要，根据演习的规模和复杂程度，可能需要几天到几周的时间才能完成。

##### 设计阶段

如果您的组织没有进行桌面演习，最好从包括网络安全团队在内的小范围集中演习开始。对 SEDF 来说，主要关注领域包括确定

■ 整个网络和主机操作系统中基于网络钓鱼攻击的潜在检测点

■ 利用当前部署的技术将成功攻击的影响降至最低的方法

■ 社会工程攻击和事件响应的响应策略

建议每个桌面练习都有一个重点领域。这使参与者能够更有效地集中精力。一旦确定了焦点，就可以创建场景了。场景是对一个假设事件的连续叙述性描述，它为演习提供了催化剂，旨在引入能够激发反应的情景[[1](#bb0010)。每个场景应包含一个讨论主题和讨论点，以使小组专注于期望的讨论。一些示例场景包括:

■ 网络钓鱼攻击——一群攻击者利用看似来自人力资源部门的网络钓鱼电子邮件来攻击您的组织。该电子邮件指出，该员工必须完成隐私政策确认，才能获得当年的保险福利。电子邮件中显示的链接似乎将员工引向公司网站；但是，一旦点击，员工就会被定向到恶意网站，该网站会尝试捕获输入到网站中的信息。

■ 关于检测的讨论—目前有哪些机制可以在主机和网络级别检测可疑电子邮件和/或可疑链接？可以将它们配置为阻止包含伪装链接的电子邮件吗？

■ 讨论将影响降至最低—一旦网络安全团队收到恶意电子邮件的通知，是否有可能确定哪些员工收到了该电子邮件？可以从收件人的邮箱中删除电子邮件以防止其他攻击吗？是否有可能使用网络上的代理或其他设备来阻止恶意网站(URL 和 IP 地址)？

■ 政策讨论——当员工向网络安全团队报告可疑消息时，应采取什么措施？阻止访问恶意网站的流程是什么？此次攻击中的哪些信息可用于进一步教育员工？

■ 恶意文档—在网络上发现受感染的 PDF。一旦 PDF 被打开，后门软件就会安装在机器上，使攻击者能够访问机器和公司网络。公司防病毒不检测后门软件或恶意 PDF。PDF 的来源尚未确定，网络上受感染机器的数量未知。

■ 关于检测的讨论——如何识别被入侵的机器？是否有可能检测到后门软件与其命令和控制地址的通信？

■ 关于最小化影响的讨论——代理或其他网络设备能否阻止命令并控制流量？有哪些选项可以删除受感染的 PDF 和后门软件？是否有可能确定数据是否已从受感染的机器上删除？

■ 政策讨论—当发现可疑文件时，执行哪些分析步骤？修改端点和/或代理策略中的检测签名需要哪些授权？此次攻击中的哪些信息可用于进一步教育员工？应该将攻击通知给哪些部门？

桌面练习需要以下角色:

■ 辅导员——辅导员的角色是创造一个鼓励对话和引导讨论的环境，以实现练习的目标[ [2](#bb0015) ]。考虑聘请一位经验丰富的顾问来协助这项工作，因为协助是一项专业技能。顾问将对参与者持中立的观点，能够不带偏见地进行建设性的练习。最后，局外人对公司网络的看法可以激发新的讨论思路。

■ 数据收集器——数据收集器的目的是记录每个场景的主要讨论点以及桌面练习中达成的任何决策。数据收集器还将生成总结演习的事后报告。

■ 参与者——选择其工作职责与练习重点相关的参与者，而不仅仅是经理。对于检测和最小化影响练习，除了网络安全团队之外，让参与网络和端点实现的关键员工也参与进来可能会很有用。基于策略的练习应包括在当前策略中担任指定角色的每个部门的代表。

物流、设备和文档也应包括在设计阶段。一些组织选择在会议场所或酒店会议室之外进行他们的练习，通过消除他们在办公室中典型的一天的干扰来集中参与者的注意力。锻炼场所应该有足够大的空间来舒适地容纳锻炼参与者的数量，并包括一个高射投影仪、白板和用于参与者笔记本电脑的充足电源。到达后，每位与会者都将收到一份与会者指南。参与者指南应包括

■ 演习目的

■ 范围和目标

■ 演习场景

■ 支持材料(网络图或政策)

辅导员指南应包括与学员指南相同的材料，以及在每个情景中要问的辅导员问题。数据收集表应包括以下栏目:

■ 问题或客观

■ 部门受影响

■ 当前响应行动或技术

■ 决议或建议

##### 执行阶段

在介绍主持人之前，练习应从网络安全管理人员的评论开始。主持人应要求每位参与者介绍自己以及他们在组织中的角色。尽管大多数员工都熟悉各自的角色和职责，但辅导员并不熟悉。然后，主持人提供练习时间表和基本规则的高级概述。基本规则旨在为思想交流营造一个中立的环境。一些基本规则示例如下:

■ 答案没有对错。我们欢迎所有的想法，并将酌情采纳和实现。

■ 保持一个无故障、无压力的环境。非常重要的一点是，讨论是由群体决策和解决问题驱动的，因此环境必须保持开放、积极和鼓励。

■ 利用场景提供背景，激发创意。所有的想法和想法都应该基于场景提供的信息，但这不应该限制你的思考。

■ 不要把讨论局限于官方立场或政策。当你思考呈现的情况时，不要害怕超越你的头衔/职位。

主持人应该介绍第一个场景。如果学员对情景事件没有任何疑问，主持人应提出情景中列出的第一个问题，然后退后一步，让学员讨论。如果小组开始关注与练习范围无关的主题，主持人将引导讨论回到场景。在每个场景结束时，小组应该进行一次热洗。热洗是场景、讨论点和结论的高级概述。热洗不仅确保参与者同意结论，而且还验证数据收集器保留了正确的信息。

重要的是在锻炼时间表中加入休息时间，让参与者补充咖啡因和呼吸新鲜空气。如果场景被拖得太长，注意力范围会开始缩小，导致讨论减少。典型的时间表由 90 分钟的会议组成，中间有 20 分钟的休息时间。如果可能的话，午餐应该在户外进行，为参与者提供一个环境变化的机会。

参与者完成最后一个场景后，对整个练习进行热水清洗。要问的一些示例问题如下:

■ 今天的练习有哪些要点？

■ 关于有没有提高这个练习质量的建议

来了

■ 参与者

■ 支持文件

下一次练习应该包括哪些目标？

##### 行动后阶段

对来自数据收集器的信息进行分析和编译，以产生详细描述锻炼事件的报告。接下来是练习中最关键的部分，从练习报告中创建和分配行动项。从演习中获得的信息只有在被付诸实现的情况下才会对组织有用。因此，分配和跟踪行动项目对于练习过程的成功至关重要。演习组织者应召开演习后会议，讨论以下内容:

■ 演习成功吗？

适当的人员是否包括在内？

主持人足够了吗？

场馆是否提供了足够的空间和电力资源？

■ 可以采取哪些行动来改善以后的练习？

锻炼计划有许多资源。联邦紧急事务管理局(FEMA)在 http://www.fema.gov/media-library/assets/documents/26845 有一个完整的网络演习包。

### 预防贴士

除了头脑风暴会议和桌面练习的结果之外，以下是一些针对社交工程攻击强化您的环境的建议:

■ 用户名改头换面——攻击者可以使用本章前面讨论的策略轻松枚举用户名，例如通过社交媒体收集用户名。不基于姓名或任何其他可识别特征的用户名使社交工程攻击变得复杂，因为攻击者无法快速确定与他们希望作为目标的员工相关联的用户名。不使用 vthomas 作为用户名，而是考虑一个唯一的标识符，如 HN90346283。这一变化不仅会使攻击者的行动更加困难，而且会使网络安全团队更容易进行威胁检测和日志分析。偏离唯一标识符的用户名的登录尝试将是明显的攻击尝试，使网络安全团队能够正确调查所涉及的机器。因为这种类型的更改会影响组织中的每个人，所以部署的初始阶段可能会产生负面影响，例如忘记新用户名的员工打电话求助服务台的次数会增加。用户名改头换面还需要高级管理层的支持，因为这需要组织改变文化以利用新的格式。

■ 域名购买——社会工程师利用受害者无法发现攻击中的小细节。网络钓鱼攻击的一个流行策略是购买与目标主域相似的域。例如，如果你的主域名是[www.myorganization.com](http://www.myorganization.com)，攻击者会购买[www.myogranization.com](http://www.myogranization.com)或[www.my-organization.com](http://www.my-organization.com)，这样恶意链接乍一看就像是合法的。如果您组织的客户错误地输入了您的网站地址，并且无意中访问了攻击者的网站，这些恶意域也可能被用来攻击您组织的客户。从恶意域创建电子邮件帐户增加了网络钓鱼邮件的可信度，因为电子邮件地址似乎来自您的组织内部。购买与您的组织相似的域将降低攻击者使用虚构的网站和电子邮件地址引诱其目标的风险。包括流行的域扩展，如。org 和。为了最大程度的预防，你应该在购物时购买蚊帐。

■ 网络邮件地址——注册网络邮件地址，例如[myorganizationadmin@yahoo.com](mailto:myorganizationadmin@yahoo.com)，可以降低攻击者利用网络邮件提供商发起网络钓鱼攻击的可能性。如果攻击者无法购买令人信服的域名或创建令人信服的网络邮件帐户，他们的攻击被垃圾邮件过滤器检测到的机会就会增加。

### 把所有这些放在一起

SEDF 为组织提供了一个高级路线图，以确定需要改进的领域，从而预防、检测或响应社会工程攻击([图 7.1](#f0010) )。这些阶段没有先决条件，可以按您选择的任何顺序执行。

<figure class="fig">![f07-01-9780124199675](img/f07-01-9780124199675.jpg)

<figcaption id="ca0010">Figure 7.1 Phases of the social engineering defensive framework.</figcaption>

</figure>

成功实现框架的关键是根据每个阶段的结果创建环境变化。环境变化可能包括技术、政策、员工教育、组织文化或对物理安全控制的修改。防止社会工程攻击是一个持续的过程，需要定期重复每个 SEDF 阶段。

## 我在哪里可以了解更多关于社会工程的知识？

在这短短的一章中，我仅仅触及了社会工程的皮毛以及它是如何工作的。我强烈推荐以下几本书:

■

弗兰克·w·阿巴内尔如果你能抓住我

■ 没有科技黑客约翰尼·龙

<footer>

## 笔记

[1] 事故响应计划桌面演习[https://ics-cert . us-cert . gov/sites/default/files/ICSJWG-Archive/f 2010/Simon % 20-% 20 Tabletop % 20 exercise % 20 webinar . pdf](https://ics-cert.us-cert.gov/sites/default/files/ICSJWG-Archive/F2010/Simon%20-%20Tabletop%20Exercise%20Webinar.pdf)【2014 年 2 月 5 日访问】。

[2] 网络安全桌面演练[http://www . FEMA . gov/media-library-data/2013 07 26-1834-25045-1623/nle _ 12 _ TTX _ _ _ facilitator _ s _ notes _ 5 . 10 . 12 _ final _ _ 508 . pdf](http://www.fema.gov/media-library-data/20130726-1834-25045-1623/nle_12_ttx___facilitator_s_notes_5.10.12_final__508.pdf)。

</footer>

