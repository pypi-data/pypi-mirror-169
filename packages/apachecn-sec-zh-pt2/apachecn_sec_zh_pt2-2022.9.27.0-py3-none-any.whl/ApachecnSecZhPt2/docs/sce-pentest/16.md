# 十六、内部社会工程评估

安德鲁·梅森，random storm 有限公司技术总监

本章着眼于内部社会工程评估作为一种防御策略的作用。内部社会工程评估是一种针对您自己的员工进行的评估，旨在突出安全弱点并提高企业内部的安全意识。这一章着眼于你为什么要运行这样一个测试，并且推荐了一些执行这样一个评估的框架。

### 关键词

内部测试；Hacktober 漏洞扫描；密码审计

本章中的信息

内部测试的需要

Facebook Hacktober

设计内部测试

测试基础设施

漏洞扫描

密码审计

测试他们所遵循的人员和流程

## 介绍

[第 15 章](15.html)讨论了围绕安全意识和培训计划的优势和挑战。

本章着眼于内部社会工程评估作为一种防御策略的作用。内部社会工程评估是一种针对组织人员的评估，作为一种强调安全弱点和提高企业内部安全意识的方法。本章探讨了为什么要进行这样的测试，并推荐了一些进行这种评估的框架。

## 内部测试的需要

著名的美国管理顾问彼得·德鲁克曾经说过，一个人无法管理没有被衡量的东西。当考虑衡量组织内部关于信息安全的政策和程序的有效性时，这种说法非常有意义。

第 14 章和[第 15 章](15.html)涵盖了强化政策和程序的防御策略以及员工意识培训。创建考虑到安全性的强化策略和过程有助于创建安全实践的构建块，从而提供安全业务流程的框架。这些过程，无论多么强大和设计得多么好，都只能由执行它们的人来决定。员工意识培训试图通过培训教育员工了解风险并相应地调整他们的行为。员工必须参与到安全工作实践的需求中，以使任何员工意识培训项目被认为是成功的。

对于规模较大的组织来说，这项工作可能很大，需要组织内的高级管理层在财务和时间方面进行大量投资，以便以正确的方式实现。

假设一个组织已经着手调查现有的政策和程序，以便创建更安全的政策和程序，并且还着手进行全面的员工意识培训计划，那么问题是如何衡量这些政策的实现，以便进行管理？如果没有对这样的干预进行充分的度量，企业的涉众就不会真正知道变更的实现是否成功。

内部社会工程评估的创建和执行是衡量组织内政策和程序的有效性以及员工如何实现和遵循这些程序的一种方式。

一个常见的问题是，进行内部测试的必要性是什么，特别是如果已经通过聘请外部专业测试公司进行了基础设施渗透测试和社会工程评估。可以说，如果一家外部公司进行非常定期的测试，那么就不需要利用内部员工进行定期的内部评估。但是，通常会发现，外部公司通常会签约执行年度测试，尤其是在需要每年进行合规性测试的情况下。外部评估可能非常昂贵，因为它们需要高技能的顾问进行劳动密集型评估，并且通常根据需求或合规性要求检查整个基础架构。

由于时间和预算限制，内部评估将由内部资源执行，通常比外部公司能够提供的评估更有针对性。运行冗长的内部评估并不罕见，这将被证明是昂贵的，并且不是对外部顾问收费时间的最有效利用。内部评估的创建和执行有三个作用:

1.主要作用是衡量组织的安全状况，以及通过传统的基于网络的方式或通过对用户进行社交工程来获得对企业资源的未授权访问的难易程度。

2.第二个角色是评估最近提供的员工安全意识培训或其他旨在提高安全性的干预措施的有效性。

3.第三个角色是提高内部设计和执行评估的 IT 人员的技能。

除非定期测试，否则公司的安全状况只是假设。经常听到 It 经理声称他们有防病毒软件，并定期打补丁，因此他们有一个安全的网络。这是客户在专业服务项目之前的常见陈述，只是为了在评估过程中证明网络有许多安全漏洞，而公司隐藏的安全流程和程序没有解决这些漏洞。这可能会让客户大吃一惊，让他们意识到进入单个入口点是多么容易，然后从这个入口点完全掌控基础架构。内部测试提供了一种定期测试的方法和途径，并且非常有针对性。尝试选择一个区域，例如用户密码，然后设计并执行用户密码评估，这将在本章稍后介绍。这种持续的测量为企业提供了关于真实安全状况的反馈，并可用于利用预算资源与外部公司签订合同，以提供进一步的安全意识培训或更深入的安全测试，从而全面调查企业内部的问题。

如果已经提供了安全意识培训或其他一些旨在改善企业安全状况的干预措施，那么运行内部测试是衡量进展的一个很好的工具。显然，第一次执行任何内部评估时，都会设定基线，然后未来的评估可以提供一种方法来衡量安全状况的改善或退步。这些评估必须仔细设计，以考虑到可能会扭曲评估结果的新员工或新政策和程序。同样，这是一个很好的方法，有望证明对改善企业安全状况的投资产生了积极的效果。

内部 It 员工身兼数职是很常见的，在当前的金融经济中，裁员似乎已经影响到了各个 it 部门的人员配备水平，使得员工在 IT 部门中扮演着多重角色。我希望我们能够达成一致，基础架构的安全性是一个关键角色，不能仅仅外包给外部咨询公司。有鉴于此，投资于内部 it 团队在安全方面的技能非常重要。我们并不假设内部团队将获得专业知识或经验，成为完全成熟的渗透测试人员，能够对第三方网络进行评估，但我们希望对培训团队的投资水平足以让他们理解概念，并针对自己的网络和用户设计和实现有效的内部评估，以强调其内部安全状况所需的改进。除了向员工提供企业可以利用的宝贵技能之外，这种形式的最新培训还有助于提高员工的参与度，因为他们会感到更有时代感，而且员工的参与度与公司生产率之间有许多积极的联系。

当员工知道他们正在接受测试时，心理上也会受到影响。当人们知道自己可能会被发现，并在同龄人面前成为一个典型时，他们往往会表现出不同的行为。假设知道进行内部测试的员工不太可能进行不安全的活动，并且通常以更安全的方式工作是合理的。当用户离开他们的工作区时，要求用户锁定他们的工作站的一个简单行为可以通过抓住那些没有锁定他们的工作站的人来实现，因此产生了一种安全偏执感，其中员工将离开他们的工作场所，然后当他们意识到他们没有锁定他们的工作站时返回。

这方面的一个例子可以是在许多零售环境中使用的个人提包抽查。如果有一个随机抽查政策，每天都检查某人的私人包，零售环境中的员工就不太可能偷商品。

一个著名公司进行内部测试的例子是脸书的 Hacktober 事件。

### Facebook Hacktober

如前所述，脸书公司是一家执行这种内部安全测试的知名公司。自 2011 年以来，每年 10 月，脸书都会举办他们称之为 Hacktober 的活动。这是一个为期一个月的活动，以一系列攻击脸书员工电脑的模拟安全威胁为特色，看看谁会上当，谁会报告这些问题。该事件是一个特殊事件，它补充了一个持续的内部安全测试计划，以提高脸书员工的意识([图 16.1](#F0010) )。

<figure class="fig">![image](img/F000168f16-01-9780124201248.jpg)

<figcaption class="figleg">Figure 16.1 Facebook Hacktober.</figcaption>

</figure>

针对脸书雇员的各种攻击都是企图以社会工程的方式诱骗雇员屈服于这些攻击。这些攻击非常狡猾，通常符合员工的工作职责，以免引起太多怀疑。如果员工识别并报告了企图实现的网络钓鱼欺诈或安全威胁，他们将从同事那里获得奖励和荣誉。如果他们屈服于攻击，他们将接受进一步的安全意识培训，了解发生了什么，哪里出错了，以及如何发现和报告未来的潜在问题。

脸书采取的方法有利于企业内部的文化。脸书安全团队的一名主管报告说，“*网络研讨会不太适合这里，所以我们想做一些符合我们黑客文化的独特事情，向员工传授网络安全知识，所以我们以十月、恐惧和恶作剧为主题，创造了一些既有趣又有教育意义的东西*”

脸书发现这种方法非常吸引员工，同事之间的内在竞争真的让员工意识到发生了什么。这就像进行社会工程评估，当客户意识到顾问来了，他们只是不知道他们是谁，他们什么时候来，或者他们要做什么。它将整个企业置于一种高度的意识中，这使得员工对活动产生更多的质疑。

除了提高员工的意识和改进应对社会工程攻击的变化之外，这种类型的练习还为衡量任何改进的策略或程序的成功以及衡量任何最近实现的安全意识培训的有效性提供了很好的基准。通过每年运行一次，它提供了根据记录的基准来衡量有希望的改进的能力。

月底，为了配合万圣节，脸书请员工们参加 Hacktober 主题的欢乐时光和南瓜雕刻。

## 设计内部测试

既然已经研究了内部测试的需要以及这样做的原因和好处。议程上的下一件事是你如何计划和设计内部测试？每个企业都是不同的，每个企业都有自己的需求与它所执行的业务流程相关联，因此每个设计都是不同的，但这里有一些建议，可以通过内部测试来查看。

内部测试有两个方面。第一个是测试基础设施，第二个是测试他们所遵循的人员和流程。基础设施测试更符合传统的渗透测试，人员和流程测试更符合社会工程测试。提供了两者的摘要以及一些要采取的行动的建议。

### 测试基础设施

这本书涵盖了社会工程，但没有涵盖基础设施测试领域。这种类型的测试是大多数人在谈论渗透测试时想到的，并且涵盖了客户基础设施的测试。该基础设施由具有可到达的 IP 地址(或其他适当的网络层协议)的项目组成，并且通常由网络设备组成，例如路由器、交换机、防火墙以及用户工作站和服务器。基础设施不仅限于这些设备，本书的作者已经对从联网冰箱到基于网络的卷帘门控制器的任何设备进行了基础设施测试。

可以针对基础设施运行的两个测试是漏洞扫描和密码审计，这两个测试可以为内部评估提供有效的结果。

#### 漏洞扫描

漏洞扫描是大多数渗透测试的初始步骤之一，其中包括多台主机，因为它是检查多台主机的快速方法，并提供顾问可以进一步测试的漏洞的初始列表。为了执行漏洞扫描，需要漏洞扫描工具。幸运的是，大多数平台都有许多商业和开源扫描仪，谷歌搜索会返回许多结果。在位于 http://sectools.org/tag/vuln-scanners/[的](http://sectools.org/tag/vuln-scanners/)[SecTools.org](http://SecTools.org)网站上有一份可用扫描仪的列表。

一个可以使用的免费开源扫描仪是 OpenVAS，可从 http://www.openvas.org 获得。

弱点扫描器被提供有 IP 地址或可解析主机名的列表，并且它们通过在经由各种端口扫描技术执行服务发现之前首先确定主机的可用性来执行扫描过程。一旦主机和服务得到确认，扫描器就开始对主机进行分析，寻找软件漏洞和配置漏洞。大多数漏洞扫描器允许执行所谓的凭证扫描。这是一种漏洞扫描，可以授予扫描程序管理权限，以便它可以将驱动器映射到目标主机，还可以查询主机注册表等项目，从而提供更详细的评估级别。

软件漏洞是已安装软件(无论是商业软件还是开源软件)中已识别的缺陷。软件漏洞的一个例子可能是微软在其安全公告 MS08-067 中公布的 Conficker 漏洞。这是一个众所周知的 Windows 服务器漏洞(令人惊讶的是，作者仍然在商业网络中发现)，微软在一个安全补丁中修复了它。漏洞扫描程序知道如何从其插件数据库中识别该漏洞，并将在扫描管理界面中报告该漏洞以及相应的风险详细信息。所有供应商每年都会发现数千个漏洞，其中大部分由 http://nvd.nist.gov 的 NIST 国家漏洞数据库记录。这些都被分配了一个被称为 CVE 的参照物。上面的示例软件漏洞发布的 CVE 号为 CVE-2008-4250，可在 http://web.nvd.nist.gov/view/vuln/detail?[找到 vulnId=CVE-2008-4250](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2008-4250) 。这个数字指的是它被识别的年份和从 0001 开始的时间顺序。因此，2014 年发布的第一个 CVE 漏洞将是 CVE-2014-0001。

配置漏洞与软件的配置方式有关，或者更恰当地说，是配置错误。各种软件应用需要配置。人们希望今天的软件供应商发布具有默认安全配置的软件，但是对于许多发布不安全软件的历史供应商来说，情况并不总是如此，而是依赖于用户来保护它。这可以被称为打开或关闭配置。优选的是从封闭的结构开始，并打开所需的部件。然而，最简单的解决方案是从一个开放的配置开始，关闭不需要的部分，但是这些部分经常不会关闭，这导致了一个配置漏洞，该漏洞总是被严重的渗透测试者或者更糟的潜在攻击者利用。配置漏洞的一个例子可能是网络设备，如路由器或交换机，启用了 Telnet 的不安全连接方法，而不是 SSH 的安全方法。如果不需要密码就能访问设备，这种情况还会进一步恶化。这两种都是配置漏洞，可以通过正确配置设备来补救。

漏洞扫描可用于内部测试，以检查软件和配置漏洞。这有助于确认服务器的补丁级别，这在 Windows 环境中非常有用，可以确保应用了所有关键的安全补丁。这种类型的扫描对于查找组织内设备上可能存在的任何配置错误也很有用。跟踪漏洞扫描的结果并确保任何主机都没有高级别的漏洞，这是提高安全态势并大大降低潜在攻击者获得任何公司资源访问权限的能力的一个好方法。

#### 密码审计

在现代数字生活中，无论是在工作中还是在家里，都使用各种密码来认证许多服务。在内部执行的一个非常好的测试是组织内核心服务的用户密码强度。本书的作者定期执行基础架构评估，其中网络和服务器不会产生可利用的漏洞，但弱用户或管理密码允许他们访问网络，然后他们可以提升其权限，最终接管基础架构。密码似乎仍然是大多数组织的安全状况中的薄弱环节，这些组织长期以来都存在这样的问题，要么密码太复杂以至于很难记住，要么密码很容易记住但又太弱。

假设作为策略强化的一部分，已经实现了安全密码策略，并且相关的控制措施已经到位，以确保基础架构内的所有核心服务都实现了足够长度和复杂性的强密码，以及需要更高级别的身份认证的双因素身份认证。对于网络上所有主机的服务和管理帐户，也必须强制执行此操作。作者已经看到在组织中为他们的用户强制执行非常复杂的密码策略，但是在没有链接到密码策略的服务帐户和网络设备上却发现非常弱的密码。这几乎就像一些 It 团队对用户有一个规则，对他们自己有一个单独的规则，当发现在测试中利用的弱密码属于服务帐户或 IT 团队成员时，这是相当尴尬的。

有许多工具可以用来检查各种服务的用户密码。windows 登录密码是从用户列表开始的好地方。密码审计工具使用所谓的单词表。这些单词表是用户密码的文本文件。有许多公开可用的单词表，其中一些带有大量生成的密码。也可以用 http://www.randomstorm.com/rsmangler-security-tool.php 的 RSMangler 等工具创建自己的密码。RSMangler 获取客户通用的小型单词列表，然后将它们分解成每个单词数千个变体，从而提供特定于某个组织的大型单词列表。

一个推荐的密码工具是 http://www.thc.org/thc-hydra/的 Hydra。Hydra 既可以作为命令行工具，也可以作为 GUI 工具，对以下服务执行密码审计:

星号、AFP、思科 AAA、思科 auth、思科 enable、CVS、火鸟、FTP、HTTP-FORM-GET、HTTP-FORM-POST、HTTP-GET、HTTP-HEAD、HTTP-Proxy、HTTPS-FORM-GET、HTTPS-FORM-POST、HTTPS-GET、HTTPS-HEAD、HTTP-PROXY、ICQ、IMAP、IRC、LDAP、MS-SQL、MYSQL、NCP、NNTP、Oracle 监听器、Oracle SID、Oracle、PC-Anywhere、PCNFS、POP

密码审核可用于内部测试，以检查用户密码的强度，并确保服务帐户和网络设备也应用了强密码。执行内部密码审计可以在被外部公司测试或之前被潜在攻击者发现之前，概述任何可以补救的问题。

### 测试他们遵循的人员和流程

测试人员和流程是本书的主要焦点。这是一种社会工程参与，其中人员和流程通过他们的速度来尝试获得对特权资源的访问。执行内部社会工程风格的约定比基础设施的测试更进一步，并且还需要更多的规划，因为这些是为每个组织定制的场景。

这提供了利用本书不同章节中解释的一些项目的机会，以便在内部组织中设计、筹备和执行社会工程评估。

[第 8 章](08.html)讲述了评估的侦察和基础建设。本章演示了如何查找和操作可用的数据。这包括收集电子邮件地址、文档元数据、公司网站和社交媒体。为了创建有效的场景，接下来的两章介绍了威胁建模的过程。提供了三种攻击媒介作为示例，它们构成了社会工程师工作的主干。这些是:

1.邮件攻击媒介

2.电话攻击载体

3.物理攻击向量。

[第 9 章](09.html)介绍了电子邮件攻击媒介以及非常有效的网络钓鱼和鱼叉式网络钓鱼方法。这提供了创建一个成功的网络钓鱼攻击所涉及的流程和工具，以用作内部社会工程评估的一部分，从而提高对此类攻击的防御能力。

[第十章](10.html)涵盖电话攻击媒介。电话是一种用于社会工程的伟大远程工具，可用于收集目标公司的信息或欺骗用户执行导致内部安全完全破坏的操作。由于电话的远程特性以及众多允许匿名的服务，很明显，这对于远程工程师来说是一个很好的选择，因为这是一种获取有关组织信息的非常安全的方法。

第 11 章讲述了物理攻击媒介，这是可以在现场运用特殊技能渗透组织的地方。如果该顾问在整个组织中为人所知，这可能会很难做到，尽管如果有远程办公室，其身份是未知的。这仍然是一个有效的攻击媒介，本章解释了如何开发评估的物理方面。

利用这些章节中的信息将有助于开发内部评估，该评估可用于确定内部组织的安全状况。

## 摘要

本章解释了对组织进行内部评估的必要性。本章首先解释了这种评估的必要性，然后展示了脸书的例子，以及他们如何利用他们的 Hacktober 计划来提高员工的安全意识。接下来是如何开发评估，并涵盖内部基础设施的测试，以及组织内的人员和流程。漏洞扫描和密码审计被确定和概括为两种方法，可以在查看人员和流程之前使用，并涵盖本书大部分内容所涉及的三种攻击媒介:电子邮件攻击媒介、电话攻击媒介和物理攻击媒介。

回到开头的一句话，管理未测量的内容是不可能的，正如已经提到的，运行内部测试是在进一步测试之前建立初始基准的好方法，以证明组织内员工的安全意识有望得到提高。

下一章是本书的最后一章，将提供一份社会工程师备忘单。本章将把整本书整合成一个简单易用的备忘单和流程图，帮助安全工程师规划和执行社会工程评估。该流程图将引用本书的章节，在这些章节中，读者可以进一步深入了解所需的工具和技术，其目的是提供一个基于贯穿本书的方法论的易于使用的系统。

