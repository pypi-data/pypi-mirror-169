import{a8 as i,B as D,aF as p,aG as H,aH as U,_ as n,aI as Y,f as j,aJ as X,C as q,aK as z,aD as J,aL as Q,as as Z,e as ee,g as S,h as k,j as $,t as te,x as _,aM as se,aN as oe,aO as ae,aP as ne,S as re,l as R,n as L,o as B,q as m,W as I,U as ie,ay as le,ag as y,X as C,Y as ce,aQ as ue,aR as de,aS as _e,aT as pe}from"./button.2d739dc7.js";import{m as F,g as me,T as ge,o as d,a2 as a,h as l,a3 as h,a0 as he,u as G,l as u,n as r,p as f,i as w,X as fe,K as ve,_ as be}from"./main.b94c07c8.js";import{a as N,b as A}from"./metadata-dialog.e9b5c052.js";import{_ as we,a as Se}from"./VWindowItem.bb0669e5.js";const ke=F(D,i),P=ke.extend({name:"v-radio-group",provide(){return{radioGroup:this}},props:{column:{type:Boolean,default:!0},height:{type:[Number,String],default:"auto"},name:String,row:Boolean,value:null},computed:{classes(){return{...i.options.computed.classes.call(this),"v-input--selection-controls v-input--radio-group":!0,"v-input--radio-group--column":this.column&&!this.row,"v-input--radio-group--row":this.row}}},methods:{genDefaultSlot(){return this.$createElement("div",{staticClass:"v-input--radio-group__input",attrs:{id:this.id,role:"radiogroup","aria-labelledby":this.computedId}},i.options.methods.genDefaultSlot.call(this))},genInputSlot(){const t=i.options.methods.genInputSlot.call(this);return delete t.data.on.click,t},genLabel(){const t=i.options.methods.genLabel.call(this);return t?(t.data.attrs.id=this.computedId,delete t.data.attrs.for,t.tag="legend",t):null},onClick:D.options.methods.onClick},render(t){const e=i.options.render.call(this,t);return this._b(e.data,"div",this.attrs$),e}});const $e=F(z,q,X,j("radioGroup"),ge),g=$e.extend().extend({name:"v-radio",inheritAttrs:!1,props:{disabled:Boolean,id:String,label:String,name:String,offIcon:{type:String,default:"$radioOff"},onIcon:{type:String,default:"$radioOn"},readonly:Boolean,value:{default:null}},data:()=>({isFocused:!1}),computed:{classes(){return{"v-radio--is-disabled":this.isDisabled,"v-radio--is-focused":this.isFocused,...this.themeClasses,...this.groupClasses}},computedColor(){if(!this.isDisabled)return p.options.computed.computedColor.call(this)},computedIcon(){return this.isActive?this.onIcon:this.offIcon},computedId(){return i.options.computed.computedId.call(this)},hasLabel:i.options.computed.hasLabel,hasState(){return(this.radioGroup||{}).hasState},isDisabled(){return this.disabled||!!this.radioGroup&&this.radioGroup.isDisabled},isReadonly(){return this.readonly||!!this.radioGroup&&this.radioGroup.isReadonly},computedName(){return this.name||!this.radioGroup?this.name:this.radioGroup.name||`radio-${this.radioGroup._uid}`},rippleState(){return p.options.computed.rippleState.call(this)},validationState(){return(this.radioGroup||{}).validationState||this.computedColor}},methods:{genInput(t){return p.options.methods.genInput.call(this,"radio",t)},genLabel(){return this.hasLabel?this.$createElement(H,{on:{click:U},attrs:{for:this.computedId},props:{color:this.validationState,focused:this.hasState}},me(this,"label")||this.label):null},genRadio(){const{title:t,...e}=this.attrs$;return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(n,this.setTextColor(this.validationState,{props:{dense:this.radioGroup&&this.radioGroup.dense}}),this.computedIcon),this.genInput({name:this.computedName,value:this.value,...e}),this.genRipple(this.setTextColor(this.rippleState))])},onFocus(t){this.isFocused=!0,this.$emit("focus",t)},onBlur(t){this.isFocused=!1,this.$emit("blur",t)},onChange(){this.isDisabled||this.isReadonly||this.isActive||this.toggle()},onKeydown:()=>{}},render(t){const e={staticClass:"v-radio",class:this.classes,on:Y({click:this.onChange},this.listeners$),attrs:{title:this.attrs$.title}};return t("div",e,[this.genRadio(),this.genLabel()])}}),ye={name:"DownloadPanel",data(){return{mdiDownload:J,mdiFileImage:Q}},computed:{...d(a,["title"]),...l(G,{downloadFileName:t=>t.title+".cbz",timestamp:t=>t.timestamp,pageSrc:function(t){return h(this.$route.params,t.timestamp)},pageName:function(t){const e=this.$route.params.page;return`${t.title} - page ${e}.jpg`},downloadURL:function(t){return he(this.$route.params.pk,t.timestamp)}})},methods:{...u(Z,["downloadIOSPWAFix"]),downloadPage(){this.downloadIOSPWAFix(this.pageSrc,this.pageName)},downloadBook(){this.downloadIOSPWAFix(this.downloadURL,this.downloadFileName)}}};var Ce=function(){var e=this,s=e._self._c;return s(ee,[s(S,{attrs:{ripple:""},on:{click:e.downloadPage}},[s(k,[s($,[s(n,[e._v(e._s(e.mdiFileImage))]),e._v(" Download Page "+e._s(e.$route.params.page)+" ")],1)],1)],1),s(S,{attrs:{ripple:""},on:{click:e.downloadBook}},[s(k,[s($,[s(n,[e._v(e._s(e.mdiDownload))]),e._v(" Download Book ")],1)],1)],1)],1)},Pe=[],xe=r(ye,Ce,Pe,!1,null,null,null,null);const E=xe.exports;const Te=["fitTo","twoPages"],De={name:"ReaderSettingsPanel",data(){return{isGlobalScope:!1}},computed:{...l(a,{fitToChoices:t=>t.choices.fitTo,settingsScope:function(t){const e=this.isGlobalScope?"globl":"local";return t.settings[e]},nullValues:t=>t.nullValues,isClearSettingsButtonDisabled:function(t){if(this.isGlobalScope)return!0;for(const e of Te)if(!t.nullValues.has(t.settings.local[e]))return!1;return!0}})},mounted(){window.addEventListener("keyup",this._keyListener),this.$emit("panelMounted")},beforeDestroy:function(){window.removeEventListener("keyup",this._keyListener)},methods:{...u(a,["clearSettingsLocal","setSettingsGlobal","setSettingsLocal"]),settingsDialogChanged:function(t){this.isGlobalScope?this.setSettingsGlobal(t):this.setSettingsLocal(t)},_keyListener:function(t){switch(t.stopPropagation(),t.key){case"w":this.setSettingsLocal({fitTo:"WIDTH"});break;case"h":this.setSettingsLocal({fitTo:"HEIGHT"});break;case"s":this.setSettingsLocal({fitTo:"SCREEN"});break;case"o":this.setSettingsLocal({fitTo:"ORIG"});break;case"2":this.setSettingsLocal({twoPages:!this.settingsScope.twoPages});break}}}};var Re=function(){var e=this,s=e._self._c;return s("div",{attrs:{id:"readerSettings"}},[s("h3",[e._v("Reader Settings")]),s(P,{attrs:{label:"Scope"},model:{value:e.isGlobalScope,callback:function(o){e.isGlobalScope=o},expression:"isGlobalScope"}},[s(g,{attrs:{label:"Only this comic",value:!1}}),s(g,{attrs:{label:"Default for all comics",value:!0}})],1),s(P,{staticClass:"displayRadioGroup",attrs:{label:"Display",value:e.settingsScope.fitTo},on:{change:function(o){return e.settingsDialogChanged({fitTo:o})}}},e._l(e.fitToChoices,function(o){return s(g,{key:o.value,attrs:{label:o.text,value:o.value}})}),1),s(te,{staticClass:"displayTwoPages",attrs:{label:"Two pages","input-value":e.settingsScope.twoPages,indeterminate:e.settingsScope.twoPages===null||e.settingsScope.twoPages===void 0,ripple:""},on:{change:function(o){return e.settingsDialogChanged({twoPages:o===!0})}}}),s(_,{class:{invisible:e.isGlobalScope},attrs:{id:"clearSettingsButton",disabled:e.isClearSettingsButtonDisabled,title:"Use the default settings for all comics for this comic"},on:{click:e.clearSettingsLocal}},[e._v(" Clear Comic Settings ")])],1)},Le=[],Be=r(De,Re,Le,!1,null,"b9bf1071",null,null);const V=Be.exports;const Ie={data(){return{mdiMenuLeft:se,mdiMenuRight:oe,mdiKeyboardSpace:ae,mdiAppleKeyboardShift:ne}},methods:{isMobile:function(){return typeof window.orientation<"u"||navigator.userAgent.includes("IEMobile")}}};var Fe=function(){var e=this,s=e._self._c;return e.isMobile()?e._e():s("div",{attrs:{id:"readerKeyboardShortcutsDialog"}},[s("h3",[e._v("Keyboard Shortcuts")]),s("table",{staticClass:"highlight-table",attrs:{id:"readerKeyboardShortcutsTable"}},[s("tbody",[s("tr",[s("td",[s(n,{attrs:{color:"grey"}},[e._v(" "+e._s(e.mdiMenuLeft)+" ")]),e._v(" j"),s("br"),s(n,{attrs:{color:"grey",dense:""}},[e._v(" "+e._s(e.mdiAppleKeyboardShift)+" ")]),s(n,{attrs:{color:"grey",dense:""}},[e._v(" "+e._s(e.mdiKeyboardSpace)+" ")])],1),s("td",[e._v("Previous page")])]),s("tr",[s("td",[s(n,{attrs:{color:"grey"}},[e._v(" "+e._s(e.mdiMenuRight)+" ")]),e._v("k"),s("br"),s(n,{attrs:{color:"grey",dense:""}},[e._v(" "+e._s(e.mdiKeyboardSpace)+" ")])],1),s("td",[e._v("Next page")])]),e._m(0),e._m(1),e._m(2),e._m(3),e._m(4),e._m(5),e._m(6)])])])},Ge=[function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("h")]),e("td",[t._v("Fit page to screen height")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("w")]),e("td",[t._v("Fit page to screen width")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("s")]),e("td",[t._v("Fit page to screen")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("o")]),e("td",[t._v("Show page at original size")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("2")]),e("td",[t._v("Toggle two page view")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("m")]),e("td",[t._v("Show comic's metadata")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("c")]),e("td",[t._v("Close book")])])}],Ne=r(Ie,Fe,Ge,!1,null,"c7794298",null,null);const Ae=Ne.exports;const Ee={name:"ReaderSettingsPanel",components:{ReaderKeyboardShortcutsPanel:Ae,ReaderSettingsPanel:V,SettingsCommonPanel:re,DownloadPanel:E,SettingsFooter:R,VersionFooter:L},computed:{...d(f,["isCodexViewable"]),...w(a,["isSettingsDrawerOpen"])}};var Ve=function(){var e=this,s=e._self._c;return s(B,{staticClass:"settingsDrawer",attrs:{id:"readerSettingsDrawer",app:"",right:"",temporary:"",touchless:""},scopedSlots:e._u([{key:"append",fn:function(){return[s(L)]},proxy:!0}]),model:{value:e.isSettingsDrawerOpen,callback:function(o){e.isSettingsDrawerOpen=o},expression:"isSettingsDrawerOpen"}},[e.isCodexViewable?s("div",{attrs:{id:"settingsDrawerContainer"}},[s("div",{attrs:{id:"topBlock"}},[s(V),s(m),s("ReaderKeyboardShortcutsPanel"),s(m),s(E),s(m),s("SettingsCommonPanel")],1),s(R)],1):e._e()])},Oe=[],We=r(Ee,Ve,Oe,!1,null,"e3b8716f",null,null);const O=We.exports;const Me={name:"ReaderNavButton",props:{value:{type:Number,required:!0}},computed:{toRoute:function(){const t={...this.$route.params};return t.page=this.value,{name:this.$route.name,params:t}},disabled:function(){return this.$route.params.page===this.value}}};var Ke=function(){var e=this,s=e._self._c;return s(_,{staticClass:"readerNavButton",attrs:{disabled:e.disabled,to:e.toRoute,ripple:"",large:""}},[e._v(" "+e._s(e.value)+" ")])},He=[],Ue=r(Me,Ke,He,!1,null,"62214495",null,null);const v=Ue.exports;const Ye={name:"ReaderNavToolbar",components:{PaginationSlider:N,ReaderNavButton:v},computed:{...l(a,{maxPage:t=>t.comic?t.comic.maxPage:0,comicLoaded:t=>t.comicLoaded})},methods:{...u(a,["routeToPage"])}};var je=function(){var e=this,s=e._self._c;return e.maxPage?s(I,{staticClass:"readerNavToolbar",attrs:{dense:"",transform:"center bottom"}},[s(v,{attrs:{value:0}}),s(N,{key:e.comicLoaded,attrs:{value:+e.$route.params.page,min:0,max:e.maxPage},on:{change:function(o){return e.routeToPage(o)}}}),s(v,{attrs:{value:e.maxPage}})],1):e._e()},Xe=[],qe=r(Ye,je,Xe,!1,null,"73e3cfb5",null,null);const W=qe.exports;const x="prev",T="next",ze={name:"ReaderTitleToolbar",components:{MetadataDialog:A,SettingsDrawerButton:ie},data(){return{mdiClose:le}},head(){const t=this.$route.params.page,e=`read ${this.title} page ${t}`;return{meta:[{hid:"description",name:"description",content:e}]}},computed:{...d(a,["computedSettings","title"]),...l(a,{routes:t=>t.routes,timestamp:t=>t.timestamp,seriesPosition:function(t){const e=t.routes;if(e.seriesCount>1)return`${e.seriesIndex}/${e.seriesCount}`}}),...l(G,{lastRoute:t=>t.page.routes.last}),...w(a,["isSettingsDrawerOpen"]),closeBookRoute:function(){const t={name:"browser",params:this.lastRoute};return t.params?t.hash=`#card-${this.$route.params.pk}`:t.params=window.CODEX.LAST_ROUTE||fe.browser.route,t}},mounted(){window.addEventListener("keyup",this._keyListener)},beforeDestroy:function(){window.removeEventListener("keyup",this._keyListener)},methods:{...u(a,["routeToDirection"]),openMetadata:function(){this.$refs.metadataDialog.dialog=!0},_keyListener:function(t){switch(t.stopPropagation(),t.key){case" ":!t.shiftKey&&window.innerHeight+window.scrollY>=document.body.scrollHeight&&this.routes.next?this.routeToDirection(T):!!t.shiftKey&&window.scrollY===0&&this.routes.prev&&this.routeToDirection(x);break;case"j":case"ArrowRight":this.routeToDirection(T);break;case"k":case"ArrowLeft":this.routeToDirection(x);break;case"c":this.$refs.closeBook.$el.click();break;case"m":this.openMetadata();break}}}};var Je=function(){var e=this,s=e._self._c;return s(I,{attrs:{id:"readerTopToolbar",dense:""}},[s(y,[s(_,{ref:"closeBook",attrs:{id:"closeBook",to:e.closeBookRoute,large:"",ripple:""}},[e.$vuetify.breakpoint.mobile?s(n,{attrs:{title:"Close Book"}},[e._v(" "+e._s(e.mdiClose)+" ")]):s("span",[e._v("close book")])],1)],1),s(C),s(ce,{attrs:{id:"toolbarTitle"}},[e._v(" "+e._s(e.title)+" ")]),s(C),e.seriesPosition?s("span",{attrs:{id:"seriesPosition",title:"Series Position"}},[e._v(e._s(e.seriesPosition))]):e._e(),s(y,[s(_,{attrs:{id:"tagButton"},on:{click:function(o){return o.stopPropagation(),e.openMetadata.apply(null,arguments)}}},[s(A,{ref:"metadataDialog",attrs:{group:"c",pk:Number(e.$route.params.pk)}})],1),s("SettingsDrawerButton",{attrs:{id:"settingsButton"},on:{click:function(o){o.stopPropagation(),e.isSettingsDrawerOpen=!0}}})],1)],1)},Qe=[],Ze=r(ze,Je,Qe,!1,null,"12fac185",null,null);const M=Ze.exports;const et={name:"ChangeBookDrawer",props:{direction:{type:String,required:!0}},data(){return{icon:this.direction==="next"?ue:de,classes:{[this.direction]:!0}}},computed:{...l(a,{routes:t=>t.routes,isDrawerOpen(t){return t.bookChange===this.direction}}),display(){return!this.routes[this.direction]&&this.routes[this.direction+"Book"]},route(){const t=this.direction+"Book",e=this.routes[t];return e?{params:e}:!1},label(){return(this.direction==="prev"?"Previous":"Next")+" Book"}}};var tt=function(){var e=this,s=e._self._c;return e.display?s(B,{staticClass:"changeBookDrawer",class:e.classes,attrs:{absolute:"",left:e.direction==="prev",right:e.direction==="next",temporarary:"",value:e.isDrawerOpen,width:"33%"}},[s("router-link",{staticClass:"navLink",attrs:{to:e.route,"aria-label":e.label,title:e.label}},[s(n,{staticClass:"bookChangeIcon"},[e._v(" "+e._s(e.icon)+" ")])],1)],1):e._e()},st=[],ot=r(et,tt,st,!1,null,"0e32d032",null,null);const b=ot.exports;const at=()=>ve(()=>import("./pdf.9dc987b2.js"),["assets/pdf.9dc987b2.js","assets/pdf.da21d229.css","assets/button.2d739dc7.js","assets/button.62a7e35d.css","assets/main.b94c07c8.js","assets/main.62851e65.css","assets/placeholder-loading.7596538d.js"]),nt={name:"PagesWindow",components:{PDFPage:at},data(){return{windowPage:0}},head(){if(this.prefetchHref)return{lnk:[{rel:"prefetch",as:"image",href:this.prefetchHref}]}},computed:{...d(a,["computedSettings","fitToClass"]),...l(a,{numWindowItems:t=>t.comic?(t.comic.maxPage||0)+1:0,isPDF:t=>t.comic?t.comic.fileFormat==="pdf":!1,routes:t=>t.routes,timestamp:t=>t.timestamp,secondPage(t){return t.computedSettings.twoPages&&+this.windowPage+1<=t.comic.maxPage},vertical:t=>t.bookChange!==void 0,prefetchHref(t){if(!!t.routes.next)return h(t.routes.next,t.timestamp)}}),...w(a,["comicLoaded"]),pk(){return this.$route.params.pk}},watch:{$route(t,e){!e.params||Number(t.params.pk)!==Number(e.params.pk)?this.loadBook():(this.setRoutesAndBookmarkPage(),this.setPage(t.params.page))},comicLoaded(t){t&&this.setPage(this.$route.params.page||0)}},mounted(){this.$refs.pagesWindow.$el.children[0].addEventListener("click",this.click)},unmounted(){this.$refs.pagesWindow.$el.children[0].removeEventListener("click",this.click)},methods:{...u(a,["loadBook","routeToDirection","setBookChangeFlag","setRoutesAndBookmarkPage"]),getSrc(t){const e={...this.$route.params,page:t};return h(e,this.timestamp)},async setPage(t){!this.comicLoaded||(t===void 0&&(t=+this.$route.params.page),this.windowPage=t,window.scrollTo(0,0))},pageChange(t){this.routeToDirection(t)},bookChange(t){this.setBookChangeFlag(t)},click(){this.$emit("click")}}};var rt=function(){var e=this,s=e._self._c;return s(we,{ref:"pagesWindow",attrs:{id:"pagesWindow","show-arrows":"",value:e.windowPage,vertical:e.vertical},scopedSlots:e._u([{key:"prev",fn:function(){return[s("div",{staticClass:"pageChangeColumn",attrs:{"aria-label":"previous page"},on:{click:function(o){return o.stopPropagation(),e.pageChange("prev")}}})]},proxy:!0},{key:"next",fn:function(){return[s("div",{staticClass:"pageChangeColumn",attrs:{"aria-label":"next page"},on:{click:function(o){return o.stopPropagation(),e.pageChange("next")}}})]},proxy:!0}])},[s("div",{staticClass:"bookChangeColumn",attrs:{id:"bookChangePrev"},on:{click:function(o){return o.stopPropagation(),e.bookChange("prev")}}}),s("div",{staticClass:"bookChangeColumn",attrs:{id:"bookChangeNext"},on:{click:function(o){return o.stopPropagation(),e.bookChange("next")}}}),e._l(e.numWindowItems,function(o,c){return s(Se,{key:`c/${e.pk}/${c}`,staticClass:"windowItem",attrs:{disabled:"",eager:""}},[e.isPDF?s("PDFPage",{attrs:{source:e.getSrc(c)}}):s("img",{staticClass:"page",class:e.fitToClass,attrs:{src:e.getSrc(c),alt:`Page ${c}`}}),e.secondPage&&e.isPDF?s("PDFPage",{attrs:{source:e.getSrc(c+1),classes:e.fitToClass}}):e.secondPage?s("img",{staticClass:"page",class:e.fitToClass,attrs:{src:e.getSrc(c+1),alt:`Page ${c+1}`}}):e._e()],1)})],2)},it=[],lt=r(nt,rt,it,!1,null,"d2d568cb",null,null);const K=lt.exports;const ct={name:"MainReader",components:{ChangeBookDrawer:b,PagesWindow:K,ReaderNavToolbar:W,ReaderTitleToolbar:M,ReaderSettingsDrawer:O},data(){return{showToolbars:!1}},computed:{...d(f,["isCodexViewable"]),...l(f,{user:t=>t.user})},watch:{user:function(){this.loadReaderSettings()},isCodexViewable:function(){this.loadReaderSettings()}},created(){this.loadReaderSettings(),this.loadBook()},methods:{...u(a,["loadReaderSettings","loadBook"]),toggleToolbars:function(){this.showToolbars=!this.showToolbars}}};var ut=function(){var e=this,s=e._self._c;return s("div",[s(be,{attrs:{id:"readerWrapper"}},[e.isCodexViewable?s("div",{attrs:{id:"readerContainer"}},[s(b,{attrs:{direction:"prev"}}),s(K,{on:{click:e.toggleToolbars}}),s(b,{attrs:{direction:"next"}}),s(_e,[s(M,{directives:[{name:"show",rawName:"v-show",value:e.showToolbars,expression:"showToolbars"}]})],1),s(pe,[s(W,{directives:[{name:"show",rawName:"v-show",value:e.showToolbars,expression:"showToolbars"}]})],1)],1):s("div",{attrs:{id:"announcement"}},[s("h1",[s("router-link",{attrs:{to:{name:"home"}}},[e._v(" Log in ")]),e._v(" to read comics ")],1)])]),s(O)],1)},dt=[],_t=r(ct,ut,dt,!1,null,"7ab32b72",null,null);const ft=_t.exports;export{ft as default};
