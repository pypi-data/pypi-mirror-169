import{m as L,s as D,U as O,d as z,G as Y,C as W,W as M,k as U,V as j,n as y,X as q,Y as G,h as $,u as T,Z as H,J as K,$ as X,o as J,p as Q,Q as Z,a0 as tt,a1 as et,l as V}from"./main.133f6caf.js";import{aw as N,a8 as R,a1 as st,ax as at,f as it,ay as nt,x as S,_ as k,az as rt,aA as A,m as ot,aB as lt,aC as ut,a7 as ct,u as dt,s as ht,aD as mt,aE as ft,at as pt,au as vt,as as _t,O as gt,w as bt,am as yt}from"./button.da6feeb7.js";const Ct=L(R,N).extend({name:"v-slider",directives:{ClickOutside:st},mixins:[N],props:{disabled:Boolean,inverseLabel:Boolean,max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:1},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:32},tickLabels:{type:Array,default:()=>[]},ticks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},tickSize:{type:[Number,String],default:2},trackColor:String,trackFillColor:String,value:[Number,String],vertical:Boolean},data:()=>({app:null,oldValue:null,thumbPressed:!1,mouseTimeout:-1,isFocused:!1,isActive:!1,noClick:!1,startOffset:0}),computed:{classes(){return{...R.options.computed.classes.call(this),"v-input__slider":!0,"v-input__slider--vertical":this.vertical,"v-input__slider--inverse-label":this.inverseLabel}},internalValue:{get(){return this.lazyValue},set(e){e=isNaN(e)?this.minValue:e;const t=this.roundValue(Math.min(Math.max(e,this.minValue),this.maxValue));t!==this.lazyValue&&(this.lazyValue=t,this.$emit("input",t))}},trackTransition(){return this.thumbPressed?this.showTicks||this.stepNumeric?"0.1s cubic-bezier(0.25, 0.8, 0.5, 1)":"none":""},minValue(){return parseFloat(this.min)},maxValue(){return parseFloat(this.max)},stepNumeric(){return this.step>0?parseFloat(this.step):0},inputWidth(){const e=(this.roundValue(this.internalValue)-this.minValue)/(this.maxValue-this.minValue)*100;return isNaN(e)?0:e},trackFillStyles(){const e=this.vertical?"bottom":"left",t=this.vertical?"top":"right",s=this.vertical?"height":"width",o=this.$vuetify.rtl?"auto":"0",n=this.$vuetify.rtl?"0":"auto",m=this.isDisabled?`calc(${this.inputWidth}% - 10px)`:`${this.inputWidth}%`;return{transition:this.trackTransition,[e]:o,[t]:n,[s]:m}},trackStyles(){const e=this.vertical?this.$vuetify.rtl?"bottom":"top":this.$vuetify.rtl?"left":"right",t=this.vertical?"height":"width",s="0px",o=this.isDisabled?`calc(${100-this.inputWidth}% - 10px)`:`calc(${100-this.inputWidth}%)`;return{transition:this.trackTransition,[e]:s,[t]:o}},showTicks(){return this.tickLabels.length>0||!!(!this.isDisabled&&this.stepNumeric&&this.ticks)},numTicks(){return Math.ceil((this.maxValue-this.minValue)/this.stepNumeric)},showThumbLabel(){return!this.isDisabled&&!!(this.thumbLabel||this.$scopedSlots["thumb-label"])},computedTrackColor(){if(!this.isDisabled)return this.trackColor?this.trackColor:this.isDark?this.validationState:this.validationState||"primary lighten-3"},computedTrackFillColor(){if(!this.isDisabled)return this.trackFillColor?this.trackFillColor:this.validationState||this.computedColor},computedThumbColor(){return this.thumbColor?this.thumbColor:this.validationState||this.computedColor}},watch:{min(e){const t=parseFloat(e);t>this.internalValue&&this.$emit("input",t)},max(e){const t=parseFloat(e);t<this.internalValue&&this.$emit("input",t)},value:{handler(e){this.internalValue=e},immediate:!0}},mounted(){this.app=document.querySelector("[data-app]")||D("Missing v-app or a non-body wrapping element with the [data-app] attribute",this)},methods:{genDefaultSlot(){const e=[this.genLabel()],t=this.genSlider();return this.inverseLabel?e.unshift(t):e.push(t),e.push(this.genProgress()),e},genSlider(){return this.$createElement("div",{class:{"v-slider":!0,"v-slider--horizontal":!this.vertical,"v-slider--vertical":this.vertical,"v-slider--focused":this.isFocused,"v-slider--active":this.isActive,"v-slider--disabled":this.isDisabled,"v-slider--readonly":this.isReadonly,...this.themeClasses},directives:[{name:"click-outside",value:this.onBlur}],on:{click:this.onSliderClick,mousedown:this.onSliderMouseDown,touchstart:this.onSliderMouseDown}},this.genChildren())},genChildren(){return[this.genInput(),this.genTrackContainer(),this.genSteps(),this.genThumbContainer(this.internalValue,this.inputWidth,this.isActive,this.isFocused,this.onFocus,this.onBlur)]},genInput(){return this.$createElement("input",{attrs:{value:this.internalValue,id:this.computedId,disabled:!0,readonly:!0,tabindex:-1,...this.$attrs}})},genTrackContainer(){const e=[this.$createElement("div",this.setBackgroundColor(this.computedTrackColor,{staticClass:"v-slider__track-background",style:this.trackStyles})),this.$createElement("div",this.setBackgroundColor(this.computedTrackFillColor,{staticClass:"v-slider__track-fill",style:this.trackFillStyles}))];return this.$createElement("div",{staticClass:"v-slider__track-container",ref:"track"},e)},genSteps(){if(!this.step||!this.showTicks)return null;const e=parseFloat(this.tickSize),t=O(this.numTicks+1),s=this.vertical?"bottom":this.$vuetify.rtl?"right":"left",o=this.vertical?this.$vuetify.rtl?"left":"right":"top";this.vertical&&t.reverse();const n=t.map(m=>{const p=[];this.tickLabels[m]&&p.push(this.$createElement("div",{staticClass:"v-slider__tick-label"},this.tickLabels[m]));const a=m*(100/this.numTicks),r=this.$vuetify.rtl?100-this.inputWidth<a:a<this.inputWidth;return this.$createElement("span",{key:m,staticClass:"v-slider__tick",class:{"v-slider__tick--filled":r},style:{width:`${e}px`,height:`${e}px`,[s]:`calc(${a}% - ${e/2}px)`,[o]:`calc(50% - ${e/2}px)`}},p)});return this.$createElement("div",{staticClass:"v-slider__ticks-container",class:{"v-slider__ticks-container--always-show":this.ticks==="always"||this.tickLabels.length>0}},n)},genThumbContainer(e,t,s,o,n,m,p="thumb"){const a=[this.genThumb()],r=this.genThumbLabelContent(e);return this.showThumbLabel&&a.push(this.genThumbLabel(r)),this.$createElement("div",this.setTextColor(this.computedThumbColor,{ref:p,key:p,staticClass:"v-slider__thumb-container",class:{"v-slider__thumb-container--active":s,"v-slider__thumb-container--focused":o,"v-slider__thumb-container--show-label":this.showThumbLabel},style:this.getThumbContainerStyles(t),attrs:{role:"slider",tabindex:this.isDisabled?-1:this.$attrs.tabindex?this.$attrs.tabindex:0,"aria-label":this.$attrs["aria-label"]||this.label,"aria-valuemin":this.min,"aria-valuemax":this.max,"aria-valuenow":this.internalValue,"aria-readonly":String(this.isReadonly),"aria-orientation":this.vertical?"vertical":"horizontal"},on:{focus:n,blur:m,keydown:this.onKeyDown}}),a)},genThumbLabelContent(e){return this.$scopedSlots["thumb-label"]?this.$scopedSlots["thumb-label"]({value:e}):[this.$createElement("span",[String(e)])]},genThumbLabel(e){const t=z(this.thumbSize),s=this.vertical?`translateY(20%) translateY(${Number(this.thumbSize)/3-1}px) translateX(55%) rotate(135deg)`:"translateY(-20%) translateY(-12px) translateX(-50%) rotate(45deg)";return this.$createElement(at,{props:{origin:"bottom center"}},[this.$createElement("div",{staticClass:"v-slider__thumb-label-container",directives:[{name:"show",value:this.isFocused||this.isActive||this.thumbLabel==="always"}]},[this.$createElement("div",this.setBackgroundColor(this.computedThumbColor,{staticClass:"v-slider__thumb-label",style:{height:t,width:t,transform:s}}),[this.$createElement("div",e)])])])},genThumb(){return this.$createElement("div",this.setBackgroundColor(this.computedThumbColor,{staticClass:"v-slider__thumb"}))},getThumbContainerStyles(e){const t=this.vertical?"top":"left";let s=this.$vuetify.rtl?100-e:e;return s=this.vertical?100-s:s,{transition:this.trackTransition,[t]:`${s}%`}},onSliderMouseDown(e){var t;if(e.preventDefault(),this.oldValue=this.internalValue,this.isActive=!0,!((t=e.target)===null||t===void 0)&&t.matches(".v-slider__thumb-container, .v-slider__thumb-container *")){this.thumbPressed=!0;const m=e.target.getBoundingClientRect(),p="touches"in e?e.touches[0]:e;this.startOffset=this.vertical?p.clientY-(m.top+m.height/2):p.clientX-(m.left+m.width/2)}else this.startOffset=0,window.clearTimeout(this.mouseTimeout),this.mouseTimeout=window.setTimeout(()=>{this.thumbPressed=!0},300);const s=M?{passive:!0,capture:!0}:!0,o=M?{passive:!0}:!1,n="touches"in e;this.onMouseMove(e),this.app.addEventListener(n?"touchmove":"mousemove",this.onMouseMove,o),Y(this.app,n?"touchend":"mouseup",this.onSliderMouseUp,s),this.$emit("start",this.internalValue)},onSliderMouseUp(e){e.stopPropagation(),window.clearTimeout(this.mouseTimeout),this.thumbPressed=!1;const t=M?{passive:!0}:!1;this.app.removeEventListener("touchmove",this.onMouseMove,t),this.app.removeEventListener("mousemove",this.onMouseMove,t),this.$emit("mouseup",e),this.$emit("end",this.internalValue),W(this.oldValue,this.internalValue)||(this.$emit("change",this.internalValue),this.noClick=!0),this.isActive=!1},onMouseMove(e){e.type==="mousemove"&&(this.thumbPressed=!0),this.internalValue=this.parseMouseMove(e)},onKeyDown(e){if(!this.isInteractive)return;const t=this.parseKeyDown(e,this.internalValue);t==null||t<this.minValue||t>this.maxValue||(this.internalValue=t,this.$emit("change",t))},onSliderClick(e){if(this.noClick){this.noClick=!1;return}this.$refs.thumb.focus(),this.onMouseMove(e),this.$emit("change",this.internalValue)},onBlur(e){this.isFocused=!1,this.$emit("blur",e)},onFocus(e){this.isFocused=!0,this.$emit("focus",e)},parseMouseMove(e){const t=this.vertical?"top":"left",s=this.vertical?"height":"width",o=this.vertical?"clientY":"clientX",{[t]:n,[s]:m}=this.$refs.track.getBoundingClientRect(),p="touches"in e?e.touches[0][o]:e[o];let a=Math.min(Math.max((p-n-this.startOffset)/m,0),1)||0;return this.vertical&&(a=1-a),this.$vuetify.rtl&&(a=1-a),parseFloat(this.min)+a*(this.maxValue-this.minValue)},parseKeyDown(e,t){if(!this.isInteractive)return;const{pageup:s,pagedown:o,end:n,home:m,left:p,right:a,down:r,up:i}=U;if(![s,o,n,m,p,a,r,i].includes(e.keyCode))return;e.preventDefault();const c=this.stepNumeric||1,h=(this.maxValue-this.minValue)/c;if([p,a,r,i].includes(e.keyCode)){const _=(this.$vuetify.rtl?[p,i]:[a,i]).includes(e.keyCode)?1:-1,l=e.shiftKey?3:e.ctrlKey?2:1;t=t+_*c*l}else if(e.keyCode===m)t=this.minValue;else if(e.keyCode===n)t=this.maxValue;else{const f=e.keyCode===o?1:-1;t=t-f*c*(h>100?h/10:10)}return t},roundValue(e){if(!this.stepNumeric)return e;const t=this.step.toString().trim(),s=t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0,o=this.minValue%this.stepNumeric,n=Math.round((e-o)/this.stepNumeric)*this.stepNumeric+o;return parseFloat(Math.min(n,this.maxValue).toFixed(s))}}}),kt=j.extend({props:{activeClass:String,value:{required:!1}},data:()=>({isActive:!1}),methods:{toggle(){this.isActive=!this.isActive}},render(){if(!this.$scopedSlots.default)return D("v-item is missing a default scopedSlot",this),null;let e;return this.$scopedSlots.default&&(e=this.$scopedSlots.default({active:this.isActive,toggle:this.toggle})),Array.isArray(e)&&e.length===1&&(e=e[0]),!e||Array.isArray(e)||!e.tag?(D("v-item should only contain a single element",this),e):(e.data=this._b(e.data||{},e.tag,{class:{[this.activeClass]:this.isActive}}),e)}}),St=L(kt,it("itemGroup","v-item","v-item-group")).extend({name:"v-item"}),wt={name:"CloseButton",data(){return{mdiClose:nt}}};var $t=function(){var t=this,s=t._self._c;return s(S,t._g(t._b({attrs:{icon:"",ripple:""}},"v-btn",t.$attrs,!1),t.$listeners),[s(k,[t._v(t._s(t.mdiClose))])],1)},Tt=[],Mt=y(wt,$t,Tt,!1,null,null,null,null);const w=Mt.exports;const xt={name:"PaginationSlider"};var Dt=function(){var t=this,s=t._self._c;return s(Ct,t._g(t._b({staticClass:"paginationSlider",attrs:{ticks:"always","thumb-label":"always","hide-details":"auto",dense:""}},"v-slider",t.$attrs,!1),t.$listeners))},Ft=[],Vt=y(xt,Dt,Ft,!1,null,null,null,null);const he=Vt.exports,I=q.browser.vuetifyNullCode,E="None",Nt={pk:I,name:E},Rt=function(e,t){let s;return e===void 0?s=e:e instanceof Object?(s=e,s.pk===null||s.pk===void 0?s.pk=I:t||(s.pk=+s.pk),(s.name===null||s.pk===void 0)&&(s.name=E)):e===null?s=Nt:s={pk:e,name:e.toString()},s},Bt=function(e,t){return e.name<t.name?-1:e.name>t.name?1:0},Lt=function(e,t){return Number.parseFloat(e.name)-Number.parseFloat(t.name)},At=function(e,t,s=!1,o=!1){const n=e||[],m=t&&t.toLowerCase();let p=[];for(const r of n){const i=Rt(r,o);i&&(!m||i.name.toLowerCase().includes(m))&&p.push(i)}const a=s?Lt:Bt;return p.sort(a)},It=(e,t)=>e?`${G(e)}/cover.webp?${t}`:window.CODEX.MISSING_COVER;const Et={name:"BookCover",props:{group:{type:String,required:!0},childCount:{type:Number,default:1},finished:{type:Boolean},coverPk:{type:Number,required:!0}},data(){return{showPlaceholder:!1}},computed:{...$(T,{coverSrc:function(e){return It(this.coverPk,e.page.coversTimestamp)}})},mounted:function(){this.delayPlaceholder()},methods:{delayPlaceholder:function(){setTimeout(()=>{this.showPlaceholder=!0},2e3)}}};var Pt=function(){var t=this,s=t._self._c;return s("div",{staticClass:"bookCoverWrapper"},[s("div",{staticClass:"bookCover"},[s("div",{staticClass:"coverImgWrapper"},[s(rt,{key:t.coverSrc,staticClass:"coverImg",attrs:{src:t.coverSrc,contain:""},scopedSlots:t._u([{key:"placeholder",fn:function(){return[t.showPlaceholder?s(A,{staticClass:"coverPlaceholder",attrs:{indeterminate:"",size:"109",color:"#cc7b19","aria-label":"loading"}}):t._e()]},proxy:!0}])})],1),s("div",{staticClass:"bookCoverOverlayTopRow"},[t.finished!==!0?s("div",{class:{unreadFlag:!0,mixedreadFlag:t.finished===null}}):t._e(),t.group!=="c"?s("span",{staticClass:"childCount"},[t._v(" "+t._s(t.childCount)+" ")]):t._e()])])])},Ot=[],zt=y(Et,Pt,Ot,!1,null,"d5167ee7",null,null);const P=zt.exports;const Yt={name:"MetadataTextBox",props:{label:{type:String,required:!0},value:{type:[Object,String,Number,Boolean],default:void 0},link:{type:Boolean,default:!1},highlight:{type:Boolean,default:!1}},data(){return{mdiOpenInNew:ot}},computed:{computedValue:function(){return this.value!=null&&this.value instanceof Object?this.value.name:this.value}}};var Wt=function(){var t=this,s=t._self._c;return t.computedValue?s("div",{staticClass:"text background-soft-highlight",class:{highlight:t.highlight}},[s("div",{staticClass:"textLabel"},[t._v(" "+t._s(t.label)+" ")]),t.link?s("a",{attrs:{href:t.computedValue,target:"_blank"}},[t._v(" "+t._s(t.computedValue)+" "),s(k,{attrs:{small:""}},[t._v(" "+t._s(t.mdiOpenInNew)+" ")])],1):s("div",{staticClass:"textContent"},[t._v(" "+t._s(t.computedValue)+" ")])]):t._e()},Ut=[],jt=y(Yt,Wt,Ut,!1,null,"924e496d",null,null);const u=jt.exports;const qt={name:"MetadataTags",props:{label:{type:String,required:!0},items:{type:Array,default(){return[]}},values:{type:Array,default(){return[]}}},data(){return{mdiFilter:lt,model:void 0}},computed:{...$(T,{filterValues:function(e){return e.settings.filters[this.label.toLowerCase()]}})},created:function(){this.model=At(this.values)},methods:{chipColor:function(e){return this.filterValues&&this.filterValues.includes(e)?"rgba(204, 123, 25, 0.75)":"#202020"}}};var Gt=function(){var t=this,s=t._self._c;return t.model&&t.model.length>0?s(ut,{staticClass:"tags",class:{"background-soft-highlight":!0},attrs:{multiple:""},model:{value:t.model,callback:function(o){t.model=o},expression:"model"}},[s(ct,{staticClass:"subheader"},[t._v(" "+t._s(t.label)+" ")]),t._l(t.model,function(o){return s(St,{key:o.name},[s(dt,{attrs:{small:"",color:t.chipColor(o.pk)}},[t._v(" "+t._s(o.name)+" ")])],1)})],2):t._e()},Ht=[],Kt=y(qt,Gt,Ht,!1,null,"88426e68",null,null);const b=Kt.exports;var F={exports:{}};(function(e,t){(function(){var s=this,o=s.humanize,n={};e.exports&&(t=e.exports=n),t.humanize=n,n.noConflict=function(){return s.humanize=o,this},n.pad=function(a,r,i,c){if(a+="",i?i.length>1&&(i=i.charAt(0)):i=" ",c=c===void 0?"left":"right",c==="right")for(;a.length<r;)a=a+i;else for(;a.length<r;)a=i+a;return a},n.time=function(){return new Date().getTime()/1e3};var m=[0,0,31,59,90,120,151,181,212,243,273,304,334],p=[0,0,31,60,91,121,152,182,213,244,274,305,335];n.date=function(a,r){var i=r===void 0?new Date:r instanceof Date?new Date(r):new Date(r*1e3),c=/\\?([a-z])/gi,h=function(d,v){return l[d]?l[d]():v},f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_=["January","February","March","April","May","June","July","August","September","October","November","December"],l={d:function(){return n.pad(l.j(),2,"0")},D:function(){return l.l().slice(0,3)},j:function(){return i.getDate()},l:function(){return f[l.w()]},N:function(){return l.w()||7},S:function(){var d=l.j();return d>4&&d<21?"th":{1:"st",2:"nd",3:"rd"}[d%10]||"th"},w:function(){return i.getDay()},z:function(){return(l.L()?p[l.n()]:m[l.n()])+l.j()-1},W:function(){var d=l.z()-l.N()+1.5;return n.pad(1+Math.floor(Math.abs(d)/7)+(d%7>3.5?1:0),2,"0")},F:function(){return _[i.getMonth()]},m:function(){return n.pad(l.n(),2,"0")},M:function(){return l.F().slice(0,3)},n:function(){return i.getMonth()+1},t:function(){return new Date(l.Y(),l.n(),0).getDate()},L:function(){return new Date(l.Y(),1,29).getMonth()===1?1:0},o:function(){var d=l.n(),v=l.W();return l.Y()+(d===12&&v<9?-1:d===1&&v>9)},Y:function(){return i.getFullYear()},y:function(){return String(l.Y()).slice(-2)},a:function(){return i.getHours()>11?"pm":"am"},A:function(){return l.a().toUpperCase()},B:function(){var d=i.getTime()/1e3,v=d%86400+3600;v<0&&(v+=86400);var g=v/86.4%1e3;return d<0?Math.ceil(g):Math.floor(g)},g:function(){return l.G()%12||12},G:function(){return i.getHours()},h:function(){return n.pad(l.g(),2,"0")},H:function(){return n.pad(l.G(),2,"0")},i:function(){return n.pad(i.getMinutes(),2,"0")},s:function(){return n.pad(i.getSeconds(),2,"0")},u:function(){return n.pad(i.getMilliseconds()*1e3,6,"0")},O:function(){var d=i.getTimezoneOffset(),v=Math.abs(d);return(d>0?"-":"+")+n.pad(Math.floor(v/60)*100+v%60,4,"0")},P:function(){var d=l.O();return d.substr(0,3)+":"+d.substr(3,2)},Z:function(){return-i.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(c,h)},r:function(){return"D, d M Y H:i:s O".replace(c,h)},U:function(){return i.getTime()/1e3||0}};return a.replace(c,h)},n.numberFormat=function(a,r,i,c){r=isNaN(r)?2:Math.abs(r),i=i===void 0?".":i,c=c===void 0?",":c;var h=a<0?"-":"";a=Math.abs(+a||0);var f=parseInt(a.toFixed(r),10)+"",_=f.length>3?f.length%3:0;return h+(_?f.substr(0,_)+c:"")+f.substr(_).replace(/(\d{3})(?=\d)/g,"$1"+c)+(r?i+Math.abs(a-f).toFixed(r).slice(2):"")},n.naturalDay=function(a,r){a=a===void 0?n.time():a,r=r===void 0?"Y-m-d":r;var i=86400,c=new Date,h=new Date(c.getFullYear(),c.getMonth(),c.getDate()).getTime()/1e3;return a<h&&a>=h-i?"yesterday":a>=h&&a<h+i?"today":a>=h+i&&a<h+2*i?"tomorrow":n.date(r,a)},n.relativeTime=function(a){a=a===void 0?n.time():a;var r=n.time(),i=r-a;if(i<2&&i>-2)return(i>=0?"just ":"")+"now";if(i<60&&i>-60)return i>=0?Math.floor(i)+" seconds ago":"in "+Math.floor(-i)+" seconds";if(i<120&&i>-120)return i>=0?"about a minute ago":"in about a minute";if(i<3600&&i>-3600)return i>=0?Math.floor(i/60)+" minutes ago":"in "+Math.floor(-i/60)+" minutes";if(i<7200&&i>-7200)return i>=0?"about an hour ago":"in about an hour";if(i<86400&&i>-86400)return i>=0?Math.floor(i/3600)+" hours ago":"in "+Math.floor(-i/3600)+" hours";var c=2*86400;if(i<c&&i>-c)return i>=0?"1 day ago":"in 1 day";var h=29*86400;if(i<h&&i>-h)return i>=0?Math.floor(i/86400)+" days ago":"in "+Math.floor(-i/86400)+" days";var f=60*86400;if(i<f&&i>-f)return i>=0?"about a month ago":"in about a month";var _=parseInt(n.date("Y",r),10),l=parseInt(n.date("Y",a),10),d=_*12+parseInt(n.date("n",r),10),v=l*12+parseInt(n.date("n",a),10),g=d-v;if(g<12&&g>-12)return g>=0?g+" months ago":"in "+-g+" months";var C=_-l;return C<2&&C>-2?C>=0?"a year ago":"in a year":C>=0?C+" years ago":"in "+-C+" years"},n.ordinal=function(a){a=parseInt(a,10),a=isNaN(a)?0:a;var r=a<0?"-":"";a=Math.abs(a);var i=a%100;return r+a+(i>4&&i<21?"th":{1:"st",2:"nd",3:"rd"}[a%10]||"th")},n.filesize=function(a,r,i,c,h,f){return r=r===void 0?1024:r,a<=0?"0 bytes":(a<r&&i===void 0&&(i=0),f===void 0&&(f=" "),n.intword(a,["bytes","KB","MB","GB","TB","PB"],r,i,c,h,f))},n.intword=function(a,r,i,c,h,f,_){var l,d;r=r||["","K","M","B","T"],d=r.length-1,i=i||1e3,c=isNaN(c)?2:Math.abs(c),h=h||".",f=f||",",_=_||"";for(var v=0;v<r.length;v++)if(a<Math.pow(i,v+1)){d=v;break}l=a/Math.pow(i,d);var g=r[d]?_+r[d]:"";return n.numberFormat(l,c,h,f)+g},n.linebreaks=function(a){return a=a.replace(/^([\n|\r]*)/,""),a=a.replace(/([\n|\r]*)$/,""),a=a.replace(/(\r\n|\n|\r)/g,`
`),a=a.replace(/(\n{2,})/g,"</p><p>"),a=a.replace(/\n/g,"<br />"),"<p>"+a+"</p>"},n.nl2br=function(a){return a.replace(/(\r\n|\n|\r)/g,"<br />")},n.truncatechars=function(a,r){return a.length<=r?a:a.substr(0,r)+"\u2026"},n.truncatewords=function(a,r){var i=a.split(" ");return i.length<r?a:i.slice(0,r).join(" ")+"\u2026"}}).call(H)})(F,F.exports);const x=F.exports;const Xt={name:"MetadataCreditsTable",props:{value:{type:Array,default:void 0}},data(){return{}},computed:{sortedCredits:function(){return[...this.value].sort(this.creditsCompare)}},methods:{roleName:function(e){return e==="CoverArtist"?"Cover Artist":e},creditSortable:function(e){const t=e.person.name.split(" ");let s=[];return t&&(s.push(t.slice(-1)),t.length>1&&s.push(t.slice(0,-1))),s.push(e.role.name),s.join(" ")},creditsCompare:function(e,t){const s=this.creditSortable(e),o=this.creditSortable(t);return s<o?-1:s>o?1:0}}};var Jt=function(){var t=this,s=t._self._c;return t.sortedCredits&&t.sortedCredits.length>0?s(ht,{attrs:{id:"creditsTable"},scopedSlots:t._u([{key:"default",fn:function(){return[s("h2",[t._v("Credits")]),s("table",{staticClass:"highlight-table"},[s("thead",[s("tr",[s("th",{staticClass:"text-left"},[t._v("Role")]),s("th",{staticClass:"text-left"},[t._v("Creator")])])]),s("tbody",t._l(t.sortedCredits,function(o){return s("tr",{key:o.pk},[s("td",[t._v(" "+t._s(t.roleName(o.role.name))+" ")]),s("td",[t._v(" "+t._s(o.person.name)+" ")])])}),0)])]},proxy:!0}],null,!1,3250430039)}):t._e()},Qt=[],Zt=y(Xt,Jt,Qt,!1,null,"e63eaf22",null,null);const te=Zt.exports,ee=({pk:e,page:t,readLtr:s,pageCount:o})=>{if(!!o){if(t)t=Number(t);else if(s)t=0;else{const n=Number(o)-1;t=Math.max(n,0)}return{name:"reader",params:{pk:e,page:t}}}},B=K("metadata",{state:()=>({md:void 0}),actions:{setMetadata(e){e&&(e.pk=e.id),this.md=e},async loadMetadata({group:e,pk:t}){const s=T();await X.getMetadata({group:e,pk:t},s.settings).then(o=>(this.setMetadata(o.data),!0)).catch(o=>{console.error(o),this.clearMetadata()})},clearMetadata(){this.md=void 0}}});const se=1160,ae=.05,ie=250,ne={comic:"Comic Archive",pdf:"PDF"},re={name:"MetadataButton",components:{BookCover:P,CloseButton:w,MetadataCreditsTable:te,MetadataTags:b,MetadataText:u},props:{group:{type:String,required:!0},pk:{type:Number,required:!0},children:{type:Number,default:1}},data(){return{mdiDownload:mt,mdiTagOutline:ft,dialog:!1,progress:0}},computed:{...J(Q,["isUserAdmin"]),...$(B,{md:e=>e.md,downloadFileName:e=>{let t;return t=e.md.path?e.md.path.split("/").at(-1):Z({seriesName:e.md.series.name,volumeName:e.md.volume.name,issue:e.md.issue,issueSuffix:e.md.issueSuffix})+".cbz",t}}),...$(T,{q:e=>e.settings.q}),downloadURL:function(){return tt(this.pk)},isReadButtonShown:function(){return this.group==="c"&&this.$route.name!="reader"},isReadButtonEnabled:function(){return this.$route.name==="browser"&&Boolean(this.readerRoute)},readButtonIcon:function(){return this.isReadButtonEnabled?pt:vt},readerRoute:function(){return ee(this.md)},formattedIssue:function(){if(!((this.issue===null||this.issue===void 0)&&!this.issueSuffix))return et({issue:this.md.issue,issueSuffix:this.md.issueSuffix})},ltrText:function(){return this.md.readLtr?"Left to Right":"Right to Left"},pages:function(){let e="";return this.md.page&&(e+=`Read ${x.numberFormat(this.md.page,0)} of `),e+=`${x.numberFormat(this.md.pageCount,0)} pages`,this.md.progress>0&&(e+=` (${Math.round(this.md.progress)}%)`),e},size:function(){return x.filesize(this.md.size)},fileFormat:function(){return ne[this.md.fileFormat]||this.md.fileFormat}},watch:{dialog:function(e){e?this.dialogOpened():this.clearMetadata()}},methods:{...V(B,["clearMetadata","loadMetadata"]),...V(_t,["downloadIOSPWAFix"]),dialogOpened:function(){this.loadMetadata({group:this.group,pk:this.pk}),this.startProgress()},startProgress:function(){this.startTime=Date.now(),this.estimatedMS=Math.max(ae,this.children/se)*1e3,this.updateProgress()},updateProgress:function(){const e=Date.now()-this.startTime;this.progress=e/this.estimatedMS*100,!(this.progress>=100||this.md)&&setTimeout(()=>{this.updateProgress()},ie)},formatDateTime:function(e){const t=new Date(e);return gt.format(t).replace(",","")},download(){this.downloadIOSPWAFix(this.downloadURL,this.downloadFileName)}}};var oe=function(){var t=this,s=t._self._c;return s(bt,{attrs:{fullscreen:"",transition:"dialog-bottom-transition","content-class":"metadataDialog"},scopedSlots:t._u([{key:"activator",fn:function({on:o}){return[s(S,t._g({staticClass:"tagButton",attrs:{"aria-label":"tags",icon:"",title:"Tags"},on:{click:function(n){n.preventDefault()}}},o),[s(k,[t._v(" "+t._s(t.mdiTagOutline)+" ")])],1)]}}]),model:{value:t.dialog,callback:function(o){t.dialog=o},expression:"dialog"}},[t.md?s("div",{attrs:{id:"metadataContainer"}},[s("header",{attrs:{id:"metadataHeader"}},[s(w,{staticClass:"closeButton",attrs:{title:"Close Metadata (esc)","x-large":""},on:{click:function(o){t.dialog=!1}}}),t.q?s(u,{attrs:{id:"search",value:t.q,label:"Search Query",highlight:!0}}):t._e(),s("div",{attrs:{id:"metadataBookCoverWrapper"}},[s(P,{attrs:{id:"bookCover","cover-pk":t.md.coverPk,group:t.group,"child-count":t.md.childCount,finished:t.md.finished}}),s(yt,{staticClass:"bookCoverProgress",attrs:{value:t.md.progress,rounded:"","background-color":"inherit",height:"2","aria-label":"% read"}})],1),s("div",{staticClass:"headerHalfRow"},[s(u,{attrs:{id:"publisher",value:t.md.publisher,label:"Publisher",highlight:t.md.group==="p"}}),s(u,{attrs:{id:"imprint",value:t.md.imprint,label:"Imprint",highlight:t.md.group==="i"}})],1),s(u,{attrs:{id:"series",value:t.md.series,label:"Series",highlight:t.md.group==="s"}}),s("div",{staticClass:"headerQuarterRow"},[s(u,{attrs:{id:"volume",value:t.md.volume,label:"Volume",highlight:t.md.group==="v"}}),s(u,{attrs:{value:t.md.volumeCount,label:"Volume Count"}}),s(u,{attrs:{id:"issue",value:t.formattedIssue,label:"Issue",highlight:t.md.group==="c"}}),s(u,{attrs:{value:t.md.issueCount,label:"Issue Count"}})],1),s("section",{staticClass:"mdSection"},[s(u,{attrs:{value:t.md.name,label:"Title"}}),t.md.year||t.md.month||t.md.day?s("div",{staticClass:"inlineRow"},[s(u,{staticClass:"datePicker",attrs:{value:t.md.year,label:"Year",type:"number"}}),s(u,{staticClass:"datePicker",attrs:{value:t.md.month,label:"Month"}}),s(u,{staticClass:"datePicker",attrs:{value:t.md.day,label:"Day"}})],1):t._e(),s(u,{attrs:{value:t.md.format,label:"Format"}})],1)],1),s("div",{attrs:{id:"metadataBody"}},[s("section",{staticClass:"mdSection"},[s("div",{staticClass:"thirdRow"},[s(u,{attrs:{value:t.pages,label:"Pages"}}),s(u,{attrs:{value:t.md.finished,label:"Finished"}}),s(u,{attrs:{value:t.ltrText,label:"Reading Direction"}})],1)]),s("section",{staticClass:"mdSection"},[s("div",{staticClass:"quarterRow"},[t.md.createdAt?s(u,{staticClass:"mtime",attrs:{value:t.formatDateTime(t.md.createdAt),label:"Created at"}}):t._e(),t.md.updatedAt?s(u,{staticClass:"mtime",attrs:{value:t.formatDateTime(t.md.updatedAt),label:"Updated at"}}):t._e(),s(u,{attrs:{value:t.size,label:"Size"}}),s(u,{attrs:{value:t.fileFormat,label:"File Type"}})],1),s("div",{staticClass:"lastSmallRow"},[s(u,{attrs:{value:t.md.path,label:"Path"}})],1)]),s("section",{staticClass:"halfRow mdSection"},[s(u,{attrs:{value:t.md.country,label:"Country"}}),s(u,{attrs:{value:t.md.language,label:"Language"}})],1),s("section",{staticClass:"mdSection"},[s(u,{attrs:{value:t.md.communityRating,label:"Community Rating"}}),s(u,{attrs:{value:t.md.criticalRating,label:"Critical Rating"}}),s(u,{attrs:{value:t.md.ageRating,label:"Age Rating"}})],1),s("section",{staticClass:"mdSection"},[s(b,{attrs:{values:t.md.genres,label:"Genres"}}),s(b,{attrs:{values:t.md.tags,label:"Tags"}}),s(b,{attrs:{values:t.md.teams,label:"Teams"}}),s(b,{attrs:{values:t.md.characters,label:"Characters"}}),s(b,{attrs:{values:t.md.locations,label:"Locations"}}),s(b,{attrs:{values:t.md.storyArcs,label:"Story Arcs"}}),s(b,{attrs:{values:t.md.seriesGroups,label:"Series Groups"}})],1),s("section",{staticClass:"mdSection"},[s(u,{attrs:{value:t.md.web,label:"Web Link",link:!0}}),s(u,{attrs:{value:t.md.summary,label:"Summary"}}),s(u,{attrs:{value:t.md.comments,label:"Comments"}}),s(u,{attrs:{value:t.md.notes,label:"Notes"}}),s(u,{attrs:{value:t.md.scanInfo,label:"Scan"}})],1),s("section",{staticClass:"mdSection"},[s("MetadataCreditsTable",{attrs:{value:t.md.credits}})],1)]),s("footer",{attrs:{id:"footerLinks"}},[t.group==="c"?s(S,{attrs:{id:"downloadButton",title:"Download Comic Archive"},on:{click:t.download}},[t.group==="c"?s(k,[t._v(" "+t._s(t.mdiDownload)+" ")]):t._e(),t._v(" Download ")],1):t._e(),t.isReadButtonShown?s(S,{attrs:{to:t.readerRoute,title:"Read Comic",disabled:!t.isReadButtonEnabled}},[s(k,[t._v(t._s(t.readButtonIcon))]),t._v(" Read ")],1):t._e(),s("span",{attrs:{id:"bottomRightButtons"}},[s(w,{staticClass:"closeButton",attrs:{title:"Close Metadata (esc)","x-large":""},on:{click:function(o){t.dialog=!1}}})],1)],1)]):s("div",{attrs:{id:"placeholderContainer"}},[s(w,{staticClass:"closeButton",attrs:{title:"Close Metadata (esc)"},on:{click:function(o){t.dialog=!1}}}),s("div",{attrs:{id:"placeholderTitle"}},[t._v("Tags Loading")]),s(A,{staticClass:"placeholder",attrs:{value:t.progress,indeterminate:t.progress>=100,size:"256",color:"#cc7b19","aria-label":"tags loading"}})],1)])},le=[],ue=y(re,oe,le,!1,null,"384a0ab7",null,null);const me=ue.exports;export{w as _,he as a,me as b,P as c,ee as g,x as h,At as t};
